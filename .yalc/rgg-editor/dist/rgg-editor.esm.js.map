{"version":3,"file":"rgg-editor.esm.js","sources":["../src/editor/ui/sitches.config.ts","../src/editor/componentEditor/inputs/TextInput.tsx","../src/utils/math.ts","../src/editor/componentEditor/inputs/NumberInput.tsx","../src/editor/componentEditor/inputs/UnknownInput.tsx","../src/editor/componentEditor/inputs/MultiNumberInput.tsx","../src/editor/state/main/store.ts","../src/utils/ids.ts","../src/editor/state/editor.ts","../src/editor/state/main/getters.ts","../src/editor/state/history/store.ts","../src/editor/state/history/actions.ts","../src/editor/state/main/actions.ts","../src/editor/state/main/hooks.ts","../src/editor/state/components/store.ts","../src/editor/state/components/hooks.ts","../src/editor/hotkeys.ts","../src/editor/state/props.ts","../src/scene/EditableModules.tsx","../src/custom/TransformControls.js","../src/custom/hooks.ts","../src/scene/useDraggableMesh.ts","../src/scene/InteractiveMesh.tsx","../src/scene/Editable.tsx","../src/scene/useEditableProp.ts","../src/scene/TemporaryComponents.tsx","../src/scene/EditableChildren.tsx","../src/scene/defaultComponents/EmptyObject.tsx","../src/scene/addables.ts","../src/editor/state/ui.ts","../src/editor/shortcuts.ts","../src/editor/SelectedComponentListeners.tsx","../src/editor/SceneList.tsx","../src/editor/ManagerSidebar.tsx","../src/editor/componentEditor/inputs/SelectInput.tsx","../src/editor/componentEditor/inputs/Options.tsx","../src/editor/componentEditor/ComponentModules.tsx","../src/editor/ui/generics.ts","../src/editor/componentEditor/inputs/RigidBody3DInput.tsx","../src/editor/componentEditor/config.ts","../src/editor/componentEditor/ComponentState.tsx","../src/editor/StateSidebar.tsx","../src/editor/AddingComponentMenu.tsx","../src/editor/ContextMenu.tsx","../src/editor/GlobalHotkeysListener.tsx","../src/editor/Editor.tsx","../src/scene/EditFloor.tsx","../src/scene/EditCamera.tsx","../src/editor/AddingComponentPlane.tsx","../src/scene/EditCanvas.tsx"],"sourcesContent":["import {createStyled} from \"@stitches/react\";\n\nexport const { css, styled } = createStyled({\n    tokens: {\n        colors: {\n            $darkGrey: '#0c0c0c',\n            $darkGreyLighter: '#161617',\n            $white: 'white',\n            $lightPurple: '#9494b7',\n            $faint: '#22222b',\n            $purple: '#3e3ca2',\n            $faintPurple: '#56566f',\n            $midPurple: '#636380',\n            $darkPurple: '#212052',\n            $pink: '#d72859',\n        },\n        sizes: {\n            $sidebar: '220px',\n            $sidebarPlus: '260px',\n            $headerHeight: '42px',\n        },\n        space: {\n            $0b: '2px',\n            $1: '4px',\n            $1b: '6px',\n            $2: '8px',\n            $2b: '12px',\n            $3: '16px',\n        },\n        fonts: {\n            $main: 'Roboto, sans-serif',\n        },\n        fontSizes: {\n          $1: '10px',\n          $1b: '12px',\n          $2: '14px',\n          $3: '18px',\n          $4: '22px',\n        },\n        fontWeights: {\n            $regular: '400',\n            $semi: '500',\n            $medium: '600',\n            $bold: '700',\n        },\n        radii: {\n            $1: '3px',\n            $2: '6px',\n        },\n        zIndices: {\n            $high: '9999999',\n            $max: '99999999999',\n        }\n    }\n});\n\ncss.global({\n    [`*, *:before, *:after`]: {\n        margin: 0,\n        padding: 0,\n        boxSizing: 'border-box',\n        maxWidth: '100%',\n    }\n})","import React, {useEffect, useMemo, useState} from \"react\"\nimport { styled } from \"../../ui/sitches.config\"\n\nexport interface InputProps {\n    inputId: string,\n    value: any,\n    onChange: (value: any) => void,\n}\n\nconst StyledContainer = styled('div', {})\n\nexport const StyledInput = styled('input', {\n    appearance: 'none',\n    backgroundColor: '$darkGreyLighter',\n    border: '1px solid $faintPurple',\n    color: '$lightPurple',\n    width: '100%',\n    padding: '$1b',\n    fontSize: '$1b',\n    ':focus': {\n        backgroundColor: '$darkGrey',\n        color: '$white',\n    }\n})\n\nexport const TextInput: React.FC<InputProps> = ({inputId, value, onChange: passedOnChange}) => {\n\n    const [inputValue, setInputValue] = useState(value ?? '')\n\n    useEffect(() => {\n        setInputValue(value ?? '')\n    }, [value])\n\n    const {\n        onChange,\n    } = useMemo(() => ({\n        onChange: (event: any) => {\n            const newValue = event.target.value\n            setInputValue(newValue)\n            passedOnChange(newValue)\n        },\n    }), [passedOnChange])\n\n    return (\n        <StyledContainer>\n            <StyledInput id={inputId} type=\"text\" value={inputValue} onChange={onChange}/>\n        </StyledContainer>\n    )\n}","export const parseNumber = (v: number | string) => {\n    if (typeof v === 'number') return v\n    try {\n        const _v = evaluate(v)\n        if (!isNaN(_v)) return _v\n    } catch {}\n    return parseFloat(v)\n}\n\nconst parens = /\\(([0-9+\\-*/^ .]+)\\)/ // Regex for identifying parenthetical expressions\nconst exp = /(\\d+(?:\\.\\d+)?) ?\\^ ?(\\d+(?:\\.\\d+)?)/ // Regex for identifying exponentials (x ^ y)\nconst mul = /(\\d+(?:\\.\\d+)?) ?\\* ?(\\d+(?:\\.\\d+)?)/ // Regex for identifying multiplication (x * y)\nconst div = /(\\d+(?:\\.\\d+)?) ?\\/ ?(\\d+(?:\\.\\d+)?)/ // Regex for identifying division (x / y)\nconst add = /(\\d+(?:\\.\\d+)?) ?\\+ ?(\\d+(?:\\.\\d+)?)/ // Regex for identifying addition (x + y)\nconst sub = /(\\d+(?:\\.\\d+)?) ?- ?(\\d+(?:\\.\\d+)?)/ // Regex for identifying subtraction (x - y)\n\n/**\n * Copyright: copied from here: https://stackoverflow.com/a/63105543\n * by @aanrudolph2 https://github.com/aanrudolph2\n *\n * Evaluates a numerical expression as a string and returns a Number\n * Follows standard PEMDAS operation ordering\n * @param {String} expr Numerical expression input\n * @returns {Number} Result of expression\n */\nfunction evaluate(expr: string): number {\n    if (isNaN(Number(expr))) {\n        if (parens.test(expr)) {\n            const newExpr = expr.replace(parens, (_match, subExpr) => String(evaluate(subExpr)))\n            return evaluate(newExpr)\n        } else if (exp.test(expr)) {\n            const newExpr = expr.replace(exp, (_match, base, pow) => String(Math.pow(Number(base), Number(pow))))\n            return evaluate(newExpr)\n        } else if (mul.test(expr)) {\n            const newExpr = expr.replace(mul, (_match, a, b) => String(Number(a) * Number(b)))\n            return evaluate(newExpr)\n        } else if (div.test(expr)) {\n            const newExpr = expr.replace(div, (_match, a, b) => {\n                // b can equal either 0 or \"0\" this is on purpose\n                // eslint-disable-next-line eqeqeq\n                if (b != 0) return String(Number(a) / Number(b))\n                else throw new Error('Division by zero')\n            })\n            return evaluate(newExpr)\n        } else if (add.test(expr)) {\n            const newExpr = expr.replace(add, (_match, a: string, b: string) => String(Number(a) + Number(b)))\n            return evaluate(newExpr)\n        } else if (sub.test(expr)) {\n            const newExpr = expr.replace(sub, (_match, a, b) => String(Number(a) - Number(b)))\n            return evaluate(newExpr)\n        } else {\n            return Number(expr)\n        }\n    }\n    return Number(expr)\n}","import React, {useEffect, useMemo, useState} from \"react\"\nimport {styled} from \"../../ui/sitches.config\";\nimport {InputProps, StyledInput} from \"./TextInput\";\nimport {parseNumber} from \"../../../utils/math\";\n\nconst StyledContainer = styled('div', {})\n\nexport const NumberInput: React.FC<InputProps> = ({inputId, value, onChange: passedOnChange}) => {\n\n    const [inputValue, setInputValue] = useState(value ?? 0)\n\n    useEffect(() => {\n        setInputValue(value ?? 0)\n    }, [value])\n\n    const {\n        onChange,\n    } = useMemo(() => ({\n        onChange: (event: any) => {\n            const newValue = parseNumber(event.target.value)\n            setInputValue(newValue)\n            passedOnChange(newValue)\n        },\n    }), [passedOnChange])\n\n    return (\n        <StyledContainer>\n            <StyledInput id={inputId} type=\"number\" value={inputValue} onChange={onChange}/>\n        </StyledContainer>\n    )\n}","import React, {useState} from \"react\"\nimport {InputProps, TextInput} from \"./TextInput\";\nimport {NumberInput} from \"./NumberInput\";\n\nconst inputComponents = {\n    text: {\n        input: TextInput,\n    },\n    number: {\n        input: NumberInput,\n    }\n}\n\nconst UnknownInput: React.FC<InputProps> = (props) => {\n    const [InputComponent] = useState(() => {\n        const {value} = props\n        if (typeof value === 'number') {\n            return inputComponents.number.input\n        }\n        return inputComponents.text.input\n    })\n    return <InputComponent {...props}/>\n}\n\nexport default UnknownInput","import React from \"react\"\nimport { styled } from \"../../ui/sitches.config\";\nimport {InputProps} from \"./TextInput\";\nimport UnknownInput from \"./UnknownInput\";\n\nconst StyledContainer = styled('div', {\n    display: 'grid',\n    gridTemplateColumns: 'minmax(0, 1fr) minmax(0, 1fr) minmax(0, 1fr)',\n    columnGap: '$2b',\n})\n\nconst StyledItem = styled('div', {\n    display: 'grid',\n    alignItems: 'center',\n    columnGap: '$1b',\n    gridTemplateColumns: 'auto minmax(0, 1fr)'\n})\n\nconst StyledLabel = styled('label', {\n    fontSize: '$1b',\n})\n\nexport const MultiNumberInput: React.FC<InputProps> = ({inputId, value, onChange: passedOnChange}) => {\n    return (\n        <StyledContainer>\n            {\n                Object.entries(value).map(([entryKey, entryValue], index) => {\n                    const id = index === 0 ? inputId : `${inputId}/${entryKey}`\n                    return (\n                        <StyledItem key={entryKey}>\n                            <StyledLabel htmlFor={id}>{entryKey}</StyledLabel>\n                            <UnknownInput inputId={id} value={entryValue} onChange={(newValue: any) => {\n                                passedOnChange({\n                                    ...value,\n                                    [entryKey]: newValue,\n                                })\n                            }}/>\n                        </StyledItem>\n                    )\n                })\n            }\n        </StyledContainer>\n    )\n}","import create from \"zustand\";\nimport {persist} from \"zustand/middleware\";\nimport {MainStateStore} from \"./types\";\n\nexport const initialStoreState: MainStateStore = {\n    componentNames: {},\n    components: {},\n    sharedComponents: {},\n    selectedComponents: {},\n    componentsTree: {},\n    unsavedComponents: {},\n    deactivatedComponents: {},\n    groups: {},\n    groupedComponents: {},\n}\n\nexport let revertState: MainStateStore = initialStoreState\n\nexport const useMainStateStore = create<MainStateStore>(persist(() => (initialStoreState), {\n    name: 'mainStateStore',\n    // @ts-ignore\n    onRehydrateStorage: () => {\n        return (state: MainStateStore) => {\n            revertState = state\n        }\n    },\n    version: 5,\n    blacklist: []\n}))\n\nconst {\n    setState: setMainStateStoreState,\n    getState: getMainStateStoreState,\n} = useMainStateStore\n\nexport {\n    setMainStateStoreState,\n    getMainStateStoreState,\n}","let incrementor = 0\n\nexport const generateUid = () => {\n    incrementor += 1\n    return (Date.now() + incrementor).toString()\n}\n\nexport const getCombinedId = (ids: string[]) => {\n    return ids.join('/')\n}","import {proxy, ref, useProxy} from \"valtio\";\nimport {OrthographicCamera, PerspectiveCamera} from \"three\";\n\nexport enum EditorTransformMode {\n    translate = 'translate',\n    rotate = 'rotate',\n    scale = 'scale',\n}\n\nexport const editorStateProxy = proxy<{\n    editMode: boolean,\n    transformMode: EditorTransformMode,\n    groupPortalRef: any,\n    orbitRef: any,\n    selectedRef: any,\n    cameraCanvasRef: any,\n    mainCamera: null | PerspectiveCamera | OrthographicCamera,\n    transformActive: boolean,\n    addComponentKey: string,\n    movingComponents: string[],\n    addComponentPosition: {\n        x: number,\n        y: number,\n        z: number,\n    },\n}>({\n    editMode: false, // todo - set back to true\n    transformMode: EditorTransformMode.translate,\n    groupPortalRef: null,\n    orbitRef: null,\n    selectedRef: null,\n    cameraCanvasRef: null,\n    mainCamera: null,\n    transformActive: false,\n    addComponentKey: '',\n    movingComponents: [],\n    addComponentPosition: {\n        x: 0,\n        y: 0,\n        z: 0,\n    }\n})\n\nexport const useIsEditMode = () => {\n    return useProxy(editorStateProxy).editMode\n}\n\nexport const setEditMode = (editMode: boolean) => {\n    editorStateProxy.editMode = editMode\n}\n\nexport const useGroupPortalRef = () => {\n    return useProxy(editorStateProxy).groupPortalRef\n}\n\nexport const useTransformMode = () => {\n    return useProxy(editorStateProxy).transformMode\n}\n\nexport const setTransformMode = (mode: EditorTransformMode) => {\n    editorStateProxy.transformMode = mode\n}\n\nexport enum PendingPasteType {\n    COMPONENTS = 'COMPONENTS'\n}\n\nexport type PendingPaste = {\n    type: PendingPasteType,\n    data: any,\n}\n\nexport const clipboardProxy = proxy<{\n    pendingPaste: PendingPaste | null\n}>({\n    pendingPaste: null,\n})\n\nexport const addToClipboard = (pendingPaste: PendingPaste) => {\n    clipboardProxy.pendingPaste = ref(pendingPaste)\n}\n\nexport const clearClipboard = () => {\n    clipboardProxy.pendingPaste = null\n}","import {getMainStateStoreState} from \"./store\";\n\nexport const getSelectedComponents = () => {\n    return getMainStateStoreState().selectedComponents\n}\n\nexport const getUnsavedComponent = (id: string) => {\n    return getMainStateStoreState().unsavedComponents[id]\n}","// @ts-ignore\nimport create from \"zustand\";\nimport {persist} from \"zustand/middleware\";\nimport {HistoryStore} from \"./types\";\n\n// @ts-ignore\nexport const useHistoryStore = create<HistoryStore>(persist(() => ({\n    pastSnapshots: [],\n    futureSnapshots: [],\n}), {\n    name: 'historyStore',\n    version: 1,\n}))","import {useHistoryStore} from \"./store\";\nimport {useMainStateStore} from \"../main/store\";\n\nexport const storeSnapshot = () => {\n    useHistoryStore.setState(state => {\n        const pastSnapshots = state.pastSnapshots.concat([useMainStateStore.getState()])\n        if (pastSnapshots.length > 20) {\n            pastSnapshots.shift()\n        }\n        return {\n            pastSnapshots,\n            futureSnapshots: [],\n        }\n    })\n}\n\nexport const undoState = () => {\n    const pastSnapshots = useHistoryStore.getState().pastSnapshots\n    const newSnapshot = pastSnapshots[pastSnapshots.length - 1]\n    if (!newSnapshot) return\n    const currentSnapshot = useMainStateStore.getState()\n    useMainStateStore.setState(newSnapshot)\n    useHistoryStore.setState(state => {\n        return {\n            pastSnapshots: pastSnapshots.slice(0, pastSnapshots.length - 1),\n            futureSnapshots: state.futureSnapshots.concat([currentSnapshot])\n        }\n    })\n}\n\nexport const redoState = () => {\n    const futureSnapshots = useHistoryStore.getState().futureSnapshots\n    const newSnapshot = futureSnapshots[futureSnapshots.length - 1]\n    if (!newSnapshot) return\n    const currentSnapshot = useMainStateStore.getState()\n    useMainStateStore.setState(newSnapshot)\n    useHistoryStore.setState(state => {\n        return {\n            futureSnapshots: futureSnapshots.slice(0, futureSnapshots.length - 1),\n            pastSnapshots: state.pastSnapshots.concat([currentSnapshot])\n        }\n    })\n}","import {getMainStateStoreState, setMainStateStoreState} from \"./store\";\nimport {TreeData} from \"@atlaskit/tree\";\nimport {MainStateStore, StoredComponentState} from \"./types\";\nimport {Addable} from \"../../../scene/addables\";\nimport {generateUid, getCombinedId} from \"../../../utils/ids\";\nimport {predefinedPropKeys} from \"../../componentEditor/config\";\nimport {ROOT_ID} from \"../../SceneList\";\nimport {addToClipboard, clearClipboard, clipboardProxy, PendingPasteType} from \"../editor\";\nimport {getSelectedComponents} from \"./getters\";\nimport {storeSnapshot} from \"../history/actions\";\n\nexport const resetComponentProp = (componentId: string, propKey: string) => {\n    setMainStateStoreState(state => {\n        let component = state.components[componentId] ?? {}\n        component = {\n            ...component,\n            overriddenState: {\n                ...(component.overriddenState ?? {}),\n                [propKey]: true,\n            }\n        }\n        return {\n            components: {\n                ...state.components,\n                [componentId]: component,\n            }\n        }\n    })\n}\n\nexport const setSharedComponentPropValue = (componentTypeId: string, propKey: string, propValue: any) => {\n    setMainStateStoreState(state => {\n        let component = state.sharedComponents[componentTypeId] ?? {}\n        component = {\n            ...component,\n            appliedState: {\n                ...(component.appliedState ?? {}),\n                [propKey]: {\n                    value: propValue,\n                }\n            }\n        }\n        return {\n            sharedComponents: {\n                ...state.sharedComponents,\n                [componentTypeId]: component,\n            }\n        }\n    })\n}\n\nexport const setComponentPropValue = (componentId: string, propKey: string, propValue: any) => {\n    setMainStateStoreState(state => {\n        let component = state.components[componentId] ?? {}\n        let updatedValue = propValue\n        if (typeof propValue === 'function') {\n            const {modifiedState = {}} = component\n            const { [propKey]: originalProp = {\n                value: undefined,\n            } } = modifiedState\n            const {\n                value\n            } = originalProp\n            updatedValue = propValue(value)\n        }\n        component = {\n            ...component,\n            modifiedState: {\n                ...(component.modifiedState ?? {}),\n                [propKey]: {\n                    value: updatedValue,\n                }\n            }\n        }\n        if (component.overriddenState && component.overriddenState[propKey]) {\n            delete component.overriddenState[propKey]\n        }\n        return {\n            components: {\n                ...state.components,\n                [componentId]: component,\n            }\n        }\n    })\n}\n\nexport const updateSelectedComponents = (updateFn: (state: any) => any) => {\n    setMainStateStoreState(state => ({\n        selectedComponents: updateFn(state.selectedComponents),\n    }))\n}\n\nexport const setSelectedComponents = (selected: {\n    [id: string]: true,\n}, replace: boolean = true) => {\n    setMainStateStoreState(state => ({\n        selectedComponents: replace ? selected : {\n            ...state.selectedComponents,\n            ...selected,\n        }\n    }))\n}\n\nexport const setComponentsTree = (tree: TreeData) => {\n    const componentsTree: MainStateStore['componentsTree'] = {}\n    Object.values(tree.items).forEach(({id, children, isExpanded}) => {\n        componentsTree[id] = {\n            children: children as string[],\n            isExpanded,\n        }\n    })\n    setMainStateStoreState({\n        componentsTree,\n    })\n}\n\nexport const setComponentTreeItemExpanded = (id: string, isExpanded: boolean) => {\n    setMainStateStoreState(state => {\n        return {\n            componentsTree: {\n                ...state.componentsTree,\n                [id]: {\n                    ...(state.componentsTree[id] ?? {\n                        children: [],\n                    }),\n                    isExpanded,\n                }\n            }\n        }\n    })\n}\n\nexport const addUnsavedComponent = (addable: Addable, parent: string, initialProps?: any) => {\n    const id = generateUid()\n    setMainStateStoreState(state => {\n        return {\n            unsavedComponents: {\n                ...state.unsavedComponents,\n                [id]: {\n                    uid: id,\n                    name: addable.name,\n                    componentId: addable.id,\n                    children: [],\n                    isRoot: !parent,\n                    initialProps: {\n                        ...(addable.props ?? {}),\n                        ...(initialProps ?? {})\n                    },\n                }\n            }\n        }\n    })\n    if (parent) {\n        setComponentPropValue(parent, predefinedPropKeys.children, (state: string[]) => {\n            state = state ? state : []\n            return state.concat([id])\n        })\n    }\n    return getCombinedId([parent, id])\n}\n\nconst getGroupChildren = (groupId: string) => {\n    const state = getMainStateStoreState()\n    const groupChildren: string[] = []\n    Object.entries(state.groupedComponents).forEach(([componentId, componentIdGroup]) => {\n        if (componentIdGroup === groupId) {\n            groupChildren.push(componentId)\n        }\n    })\n    return groupChildren\n}\n\nexport const deleteGroup = (id: string) => {\n    const children = getGroupChildren(id)\n    children.forEach(childId => {\n        deleteComponent(childId)\n    })\n    setMainStateStoreState(state => {\n        const updatedGroups = {\n            ...state.groups,\n        }\n        delete updatedGroups[id]\n        return {\n            groups: updatedGroups\n        }\n    })\n}\n\nexport const deleteComponent = (id: string) => {\n    const state = getMainStateStoreState()\n    if (state.groups[id]) {\n        deleteGroup(id)\n    } else if (state.unsavedComponents[id]) {\n        deleteUnsavedComponent(id)\n    } else {\n        addDeactivatedComponent(id)\n    }\n    // todo - deselect deleted components\n}\n\n\nexport const deleteSelectedComponents = () => {\n    storeSnapshot()\n    const selectedComponents = getMainStateStoreState().selectedComponents\n    Object.keys(selectedComponents).forEach((component) => {\n        deleteComponent(component)\n    })\n}\n\nexport const deleteUnsavedComponent = (id: string) => {\n    setMainStateStoreState(state => {\n        const updated = {\n            ...state.unsavedComponents,\n        }\n        delete updated[id]\n        return {\n            unsavedComponents: updated,\n        }\n    })\n}\n\nexport const addDeactivatedComponent = (id: string) => {\n    setMainStateStoreState(state => {\n        return {\n            deactivatedComponents: {\n                ...state.deactivatedComponents,\n                [id]: true,\n            }\n        }\n    })\n}\n\nexport const removeDeactivatedComponents = (ids: string[]) => {\n    setMainStateStoreState(state => {\n        const updated = {\n            ...state.deactivatedComponents,\n        }\n        ids.forEach((id) => {\n            delete updated[id]\n        })\n        return {\n            deactivatedComponents: updated,\n        }\n    })\n}\n\nexport const groupComponents = (ids: string[], groupId?: string) => {\n    let sameParent = true\n    let currentParent = ''\n    const groupedComponents = getMainStateStoreState().groupedComponents\n    ids.forEach((id) => {\n        const parentId = groupedComponents[id]\n        if (parentId) {\n            if (currentParent && currentParent !== parentId) {\n                sameParent = false\n            } else {\n                currentParent = parentId\n            }\n        }\n    })\n    // @ts-ignore\n    setMainStateStoreState(state => {\n        const update: Partial<MainStateStore> = {\n            groupedComponents: {\n                ...(state.groupedComponents ?? {}),\n            }\n        }\n        if (!groupId) {\n            groupId = generateUid()\n            update.groups = {\n                ...(state.groups ?? {}),\n                [groupId]: {\n                    name: 'Group',\n                    isExpanded: true,\n                },\n            }\n        }\n        if (sameParent) {\n            // @ts-ignore\n            update.groupedComponents[groupId] = currentParent\n        }\n        ids.forEach(id => {\n            // @ts-ignore\n            update.groupedComponents[id] = groupId\n        })\n        return update\n    })\n}\n\nexport const updateComponentLocation = (id: string, newDestination: string) => {\n    if (newDestination === ROOT_ID) {\n        setMainStateStoreState(state => {\n            const update = {\n                ...state.groupedComponents,\n            }\n            delete update[id]\n            return {\n                groupedComponents: update\n            }\n        })\n    } else {\n        const groups = getMainStateStoreState().groups\n        if (groups[newDestination]) {\n            groupComponents([id], newDestination)\n        }\n    }\n}\n\nexport const setComponentName = (id: string, name: string) => {\n    setMainStateStoreState(state => {\n        return {\n            componentNames: {\n                ...state.componentNames,\n                [id]: {\n                    name,\n                },\n            }\n        }\n    })\n}\n\nexport const setGroupName = (id: string, name: string) => {\n    setMainStateStoreState(state => {\n        return {\n            groups: {\n                ...state.groups,\n                [id]: {\n                    ...(state.groups[id] ?? {}),\n                    name,\n                }\n            }\n        }\n    })\n}\n\nexport const copySelectedComponents = () => {\n    addToClipboard({\n        type: PendingPasteType.COMPONENTS,\n        data: getSelectedComponents(),\n    })\n}\n\nconst getComponentPropValue = (component: StoredComponentState, propKey: string) => {\n    const {modifiedState = {}} = component\n    return modifiedState[propKey]\n}\n\nconst cloneComponentWithinState = (state: MainStateStore, componentId: string, componentIdWithParentId: string, parentId?: string) => {\n    console.log('looking for', componentId)\n    const rawId = generateUid()\n    const newId = parentId ? getCombinedId([parentId, rawId]) : rawId\n    const unsavedComponent = state.unsavedComponents[componentId]\n    if (unsavedComponent) {\n        state.unsavedComponents = {\n            ...state.unsavedComponents,\n            [rawId]: {\n                ...unsavedComponent,\n                uid: rawId,\n                children: [],\n            },\n        }\n    }\n    const component = state.components[componentIdWithParentId]\n    if (component) {\n        state.components = {\n            ...state.components,\n            [newId]: component,\n        }\n        const childrenProp = getComponentPropValue(component, predefinedPropKeys.children)\n        if (childrenProp) {\n            const {value: children = []} = childrenProp as {\n                value: string[],\n            }\n            const newChildren: string[] = []\n            children.forEach(childId => {\n                newChildren.push(cloneComponentWithinState(state, childId, getCombinedId([componentId, childId]), newId))\n            })\n            state.components[newId] = {\n                ...component,\n                modifiedState: {\n                    ...(component.modifiedState ?? {}),\n                    [predefinedPropKeys.children]: {\n                        value: newChildren,\n                    }\n                }\n\n            }\n        }\n    }\n    if (state.groupedComponents[componentId]) {\n        state.groupedComponents = {\n            ...state.groupedComponents,\n            [newId]: state.groupedComponents[componentId],\n        }\n    }\n    console.log('newId', newId, rawId)\n    return rawId\n}\n\nexport const cloneComponents = (components: string[]) => {\n    const newIds: string[] = []\n    setMainStateStoreState(state => {\n        const updatedState: any = {\n            ...state,\n        }\n        components.forEach(componentId => {\n            const id = cloneComponentWithinState(updatedState, componentId, componentId)\n            newIds.push(id)\n        })\n        return updatedState\n    })\n    return newIds\n}\n\nconst handlePasteComponents = (components: string[]) => {\n    storeSnapshot()\n    const addedComponents: {\n        [key: string]: true\n    } = {}\n    const newIds = cloneComponents(components)\n    newIds.forEach(componentId => {\n        addedComponents[componentId] = true\n    })\n    setSelectedComponents(addedComponents)\n}\n\nexport const handlePaste = () => {\n    if (clipboardProxy.pendingPaste) {\n        switch (clipboardProxy.pendingPaste.type) {\n            case PendingPasteType.COMPONENTS:\n                handlePasteComponents(Object.keys(clipboardProxy.pendingPaste.data))\n                break;\n            default:\n                break;\n        }\n    }\n    clearClipboard()\n}","import {useMainStateStore} from \"./store\";\n\nexport const useSelectedComponents = () => {\n    return useMainStateStore(state => state.selectedComponents)\n}\n\nexport const useSoleSelectedComponent = () => {\n    const selectedComponents = Object.keys(useSelectedComponents())\n    return selectedComponents.length === 1 ? selectedComponents[0] : ''\n}\n\nexport const useComponentState = (id: string) => {\n    return useMainStateStore(state => state.components[id]) ?? {}\n}\n\nexport const useComponentModifiedState = (id: string) => {\n    return useMainStateStore(state => state.components[id]?.modifiedState) ?? {}\n}\n\nexport const useSharedComponent = (id: string) => {\n    return useMainStateStore(state => state.sharedComponents[id]) ?? {}\n}\n\nexport const useUnsavedComponents = () => {\n    return useMainStateStore(state => state.unsavedComponents) ?? {}\n}\n\nexport const useUnsavedComponent = (id: string) => {\n    return useMainStateStore(state => state.unsavedComponents[id])\n}\n\nexport const useIsDeactivated = (id: string) => {\n    return useMainStateStore(state => state.deactivatedComponents[id]) ?? false\n}\n\nexport const useComponentName = (id: string) => {\n    return useMainStateStore(state => state.componentNames[id]?.name) ?? ''\n}","import {AnyProps, ComponentState} from \"./types\";\nimport create from \"zustand\";\n\nexport type ComponentsStore = {\n    components: {\n        [key: string]: ComponentState,\n    },\n    deactivatedComponents: {\n        [key: string]: ComponentState,\n    },\n    componentsThatCanHaveChildren: {\n        [key: string]: boolean,\n    },\n}\n\nexport const useComponentsStore = create<ComponentsStore>(() => ({\n    components: {},\n    deactivatedComponents: {},\n    componentsThatCanHaveChildren: {},\n}))\n\nexport const setComponentInitialProps = (uid: string, initialProps: AnyProps) => {\n    // @ts-ignore\n    useComponentsStore.setState(state => {\n        if (!state.components[uid]) return {}\n        return {\n            components: {\n                ...state.components,\n                [uid]: {\n                    ...(state.components[uid] ?? {}),\n                    initialProps,\n                }\n            }\n        }\n    })\n}\n\nexport const setComponentCanHaveChildren = (id: string) => {\n    useComponentsStore.setState(state => {\n        return {\n            componentsThatCanHaveChildren: {\n                ...state.componentsThatCanHaveChildren,\n                [id]: true,\n            }\n        }\n    })\n    return () => {\n        useComponentsStore.setState(state => {\n            const updated = {\n                ...state.componentsThatCanHaveChildren,\n            }\n            delete updated[id]\n            return {\n                componentsThatCanHaveChildren: updated,\n            }\n        })\n    }\n}\n\nexport const setComponentChildren = (uid: string, children: string[]) => {\n    // @ts-ignore\n    useComponentsStore.setState(state => {\n        if (!state.components[uid]) return {}\n        return {\n            components: {\n                ...state.components,\n                [uid]: {\n                    ...(state.components[uid] ?? {}),\n                    children,\n                }\n            }\n        }\n    })\n}\n\nexport const addComponent = (uid: string,\n                             name: string,\n                             children: string[],\n                             isRoot: boolean,\n                             unsaved: boolean,\n                             initialProps: AnyProps = {},\n                             componentId: string,\n                             parentId: string,\n                             rootParentId: string,\n                             ) => {\n    useComponentsStore.setState(state => {\n        return {\n            components: {\n                ...state.components,\n                [uid]: {\n                    uid,\n                    name,\n                    children,\n                    isRoot,\n                    unsaved,\n                    initialProps,\n                    componentId,\n                    parentId,\n                    rootParentId,\n                }\n            }\n        }\n    })\n}\n\nexport const removeComponent = (uid: string) => {\n    useComponentsStore.setState(state => {\n        const components = {\n            ...state.components,\n        }\n        delete components[uid]\n        return {\n            components,\n        }\n    })\n}\n\nexport const addDeactivatedComponent = (uid: string,\n                                        name: string,\n                                        children: string[],\n                                        isRoot: boolean,\n                                        unsaved: boolean,\n                                        parentId: string,\n                                        rootParentId: string,\n) => {\n    useComponentsStore.setState(state => {\n        return {\n            deactivatedComponents: {\n                ...state.deactivatedComponents,\n                [uid]: {\n                    uid,\n                    name,\n                    children,\n                    isRoot,\n                    unsaved,\n                    parentId,\n                    rootParentId,\n                }\n            }\n        }\n    })\n}\n\nexport const removeDeactivatedComponent = (uid: string) => {\n    useComponentsStore.setState(state => {\n        const components = {\n            ...state.deactivatedComponents,\n        }\n        delete components[uid]\n        return {\n            deactivatedComponents: components,\n        }\n    })\n}","import {AnyProps, ComponentState} from \"./types\";\nimport {useComponentsStore} from \"./store\";\n\nexport const useComponent = (id: string): ComponentState | undefined => {\n    return useComponentsStore(state => state.components[id])\n}\n\nexport const useComponentInitialProps = (id: string): AnyProps => {\n    const component = useComponent(id)\n    return component?.initialProps ?? {}\n}\n\nexport const useComponentCanHaveChildren = (id: string) => {\n    return useComponentsStore(state => state.componentsThatCanHaveChildren[id]) ?? false\n}","import {useEffect} from \"react\";\nimport hotkeys from \"hotkeys-js\";\n\nexport const KEYS = {\n    Delete: 8,\n    Space: 32,\n}\n\nexport const useHotkeysListener = () => {\n    useEffect(() => {\n        hotkeys('*', () => {})\n    }, [])\n}\n\nexport const isCommandPressed = () => {\n    return (hotkeys.command || hotkeys.cmd || hotkeys.control) ?? false\n}\n\nexport const isShiftPressed = () => {\n    return hotkeys.shift ?? false\n}\n\nexport const isDeletePressed = () => {\n    return hotkeys.isPressed(KEYS.Delete)\n}\n\nexport const isSpacePressed = () => {\n    return hotkeys.isPressed(KEYS.Space)\n}","import create from \"zustand\";\n\n\n\nexport enum PropOrigin {\n    modified = 'modified',\n    initial = 'initial',\n    applied = 'applied',\n    default = 'default',\n}\n\nexport type Prop = {\n    hidden: boolean,\n    value: any,\n    type: PropOrigin,\n}\n\ntype PropsStore = {\n    components: {\n        [key: string]: {\n            [key: string]: Prop,\n        }\n    }\n}\n\nexport const usePropsStore = create<PropsStore>(() => ({\n    components: {},\n}))\n\nexport const setComponentProps = (id: string, updateFn: (state: any) => any) => {\n    usePropsStore.setState(state => ({\n        components: {\n            ...state.components,\n            [id]: updateFn(state.components[id] ?? {}),\n        }\n    }))\n}\n\nexport const useComponentProps = (id: string) => {\n    return usePropsStore(state => state.components[id]) ?? {}\n}","import React, {MutableRefObject, useEffect} from \"react\"\nimport {BodyStatus} from \"@dimforge/rapier3d-compat\";\nimport {useEditableProp} from \"./useEditableProp\";\nimport {modulesProp, predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {useEditableContext, useEditableId, useEditableSharedProp} from \"./Editable\";\nimport {\n    ColliderValue,\n    RigidBody3dPropValue,\n    RigidBodyColliderShape,\n    RigidBodyType\n} from \"../editor/componentEditor/inputs/RigidBody3DInput\";\nimport {Euler, Object3D, Quaternion} from \"three\";\nimport {AddBodyDef, ColliderDef } from \"rgg-engine/dist/physics/helpers/rapier3d/types\";\nimport {useBodyApi, useRapier3DBody} from \"rgg-engine\";\nimport {useIsEditMode} from \"../editor/state/editor\";\nimport {Box, Sphere } from \"@react-three/drei\";\n\ninterface Props {\n    value: RigidBody3dPropValue,\n}\n\nconst getBodyType = (bodyType?: RigidBodyType): BodyStatus => {\n    switch (bodyType) {\n        case RigidBodyType.STATIC:\n            return BodyStatus.Static;\n        case RigidBodyType.KINEMATIC:\n            return BodyStatus.Kinematic;\n        default:\n            return BodyStatus.Dynamic;\n    }\n}\n\nconst generateRigidBodyCollider = (collider: ColliderValue): ColliderDef => {\n    switch (collider.colliderType) {\n        case RigidBodyColliderShape.BALL:\n            const {radius = 1} = collider\n            return {\n                type: 'Ball',\n                args: [radius],\n            }\n        default:\n            const {hx = 0.5, hy = 0.5, hz = 0.5} = collider\n            return {\n                type: 'Cubiod',\n                args: [hx, hy, hz],\n            }\n    }\n}\n\nconst generateRigidBodyColliders = (colliders: RigidBody3dPropValue['colliders'] = []): ColliderDef[] => {\n    const defs: ColliderDef[] = []\n    colliders.forEach((collider) => {\n        defs.push(generateRigidBodyCollider(collider))\n    })\n    return defs\n}\n\nconst generateRigidBodySpec = (config: RigidBody3dPropValue, position: [number, number, number], rotation: [number, number, number] = [0, 0, 0]): AddBodyDef => {\n\n    const colliders = generateRigidBodyColliders(config.colliders)\n\n    const mass = config.mass ?? 1\n\n    const quaternion = getQuaternionFromEuler(rotation[0], rotation[1], rotation[2])\n\n    const customBody = config.customBodyDef?.customBody ?? ''\n\n    return {\n        body: {\n            type: getBodyType(config.bodyType),\n            position: position,\n            quaternion: [quaternion.x, quaternion.y, quaternion.z, quaternion.w],\n            mass,\n        },\n        colliders,\n        customBody,\n    }\n}\n\nconst getQuaternionFromEuler = (x: number, y: number, z: number) => {\n    const euler = new Euler(x, y, z)\n    const quaternion = new Quaternion()\n    quaternion.setFromEuler(euler)\n    return quaternion\n}\n\nconst RigidBody3DModule: React.FC<Props & {\n    meshRef: MutableRefObject<Object3D>\n}> = ({value, meshRef}) => {\n\n    const id = useEditableId()\n    const {setSharedProp} = useEditableContext()\n\n    const {\n        x: rX,\n        y: rY,\n        z: rZ,\n    } = useEditableProp(predefinedPropKeys.rotation) ?? {\n        x: 0,\n        y: 0,\n        z: 0,\n    }\n\n    useRapier3DBody(() => {\n        const position = meshRef.current.position\n        return generateRigidBodySpec(value, [position.x, position.y, position.z], [rX, rY, rZ])\n    }, {\n        ref: meshRef,\n        id,\n    })\n\n    const api = useBodyApi(id)\n\n    useEffect(() => {\n        setSharedProp('rigidBody3dApi', api)\n    }, [api])\n\n    return null\n}\n\nconst ColliderVisualiser: React.FC<{\n    collider: ColliderValue,\n}> = ({collider}) => {\n    if (collider.colliderType === RigidBodyColliderShape.BALL) {\n        const {radius = 1} = collider\n        return (\n            <Sphere args={[radius + 0.001]} layers={[31]}>\n                <meshPhongMaterial color=\"red\" wireframe />\n            </Sphere>\n        )\n    } else if (collider.colliderType === RigidBodyColliderShape.CUBIOD) {\n        const {hx = 0.5, hy = 0.5, hz = 0.5} = collider\n        return (\n            <Box args={[hx * 2, hy * 2, hz * 2]} layers={[31]}>\n                <meshPhongMaterial color=\"red\" wireframe />\n            </Box>\n        )\n    }\n    return null\n}\n\nconst RigidBody3DModuleVisualizer: React.FC<Props & {\n    visible: boolean,\n}> = ({value, visible}) => {\n\n    const {colliders = []} = value\n    const scale = useEditableProp(predefinedPropKeys.scale) ?? {\n        x: 1,\n        y: 1,\n        z: 1,\n    }\n\n    return (\n        <group visible={visible} scale={[1 / scale.x, 1 / scale.y, 1 / scale.z]}>\n            {colliders.map((collider) => (\n                <ColliderVisualiser collider={collider} key={collider.key}/>\n            ))}\n        </group>\n    )\n}\n\nconst RigidBody3DModuleWrapper: React.FC<Props> = ({value}) => {\n\n    const meshRef = useEditableSharedProp('meshRef')\n    const isEditMode = useIsEditMode()\n\n    if (!meshRef) return null\n\n    if (!value.enabled) return null\n\n    return (\n        <>\n            {\n                !isEditMode && (\n                    <RigidBody3DModule meshRef={meshRef} value={value}/>\n                )\n            }\n            <RigidBody3DModuleVisualizer value={value} visible={isEditMode}/>\n        </>\n    )\n}\n\nexport const EditableModules: React.FC = ({children}) => {\n\n    useEditableProp(modulesProp.key)\n    const rigidBody3d = useEditableProp(predefinedPropKeys.rigidBody3d)\n\n    return (\n        <>\n            {children}\n            {\n                rigidBody3d && (\n                    <RigidBody3DModuleWrapper value={rigidBody3d}/>\n                )\n            }\n        </>\n    )\n}","import {\n    BoxGeometry,\n    BufferGeometry,\n    Color,\n    CylinderGeometry,\n    DoubleSide,\n    Euler,\n    Float32BufferAttribute,\n    Line,\n    LineBasicMaterial,\n    Matrix4,\n    Mesh,\n    MeshBasicMaterial,\n    Object3D,\n    OctahedronGeometry,\n    PlaneGeometry,\n    Quaternion,\n    Raycaster,\n    SphereGeometry,\n    TorusGeometry,\n    Vector3\n} from 'three';\n\nvar TransformControls = function ( camera, domElement ) {\n\n    if ( domElement === undefined ) {\n\n        console.warn( 'THREE.TransformControls: The second parameter \"domElement\" is now mandatory.' );\n        domElement = document;\n\n    }\n\n    Object3D.call( this );\n\n    this.visible = false;\n    this.domElement = domElement;\n\n    var _gizmo = new TransformControlsGizmo();\n    this.add( _gizmo );\n\n    var _plane = new TransformControlsPlane();\n    this.add( _plane );\n\n    var scope = this;\n\n    // Define properties with getters/setter\n    // Setting the defined property will automatically trigger change event\n    // Defined properties are passed down to gizmo and plane\n\n    defineProperty( 'camera', camera );\n    defineProperty( 'object', undefined );\n    defineProperty( 'enabled', true );\n    defineProperty( 'axis', null );\n    defineProperty( 'mode', 'translate' );\n    defineProperty( 'translationSnap', null );\n    defineProperty( 'rotationSnap', null );\n    defineProperty( 'scaleSnap', null );\n    defineProperty( 'space', 'world' );\n    defineProperty( 'size', 1 );\n    defineProperty( 'dragging', false );\n    defineProperty( 'showX', true );\n    defineProperty( 'showY', true );\n    defineProperty( 'showZ', true );\n\n    var changeEvent = { type: 'change' };\n    var mouseDownEvent = { type: 'mouseDown' };\n    var mouseUpEvent = { type: 'mouseUp', mode: scope.mode };\n    var objectChangeEvent = { type: 'objectChange' };\n\n    // Reusable utility variables\n\n    var raycaster = new Raycaster();\n    this.raycaster = raycaster\n\n    function intersectObjectWithRay( object, raycaster, includeInvisible ) {\n\n        var allIntersections = raycaster.intersectObject( object, true );\n\n        for ( var i = 0; i < allIntersections.length; i ++ ) {\n\n            if ( allIntersections[ i ].object.visible || includeInvisible ) {\n\n                return allIntersections[ i ];\n\n            }\n\n        }\n\n        return false;\n\n    }\n\n    var _tempVector = new Vector3();\n    var _tempVector2 = new Vector3();\n    var _tempQuaternion = new Quaternion();\n    var _unit = {\n        X: new Vector3( 1, 0, 0 ),\n        Y: new Vector3( 0, 1, 0 ),\n        Z: new Vector3( 0, 0, 1 )\n    };\n\n    var pointStart = new Vector3();\n    var pointEnd = new Vector3();\n    var offset = new Vector3();\n    var rotationAxis = new Vector3();\n    var startNorm = new Vector3();\n    var endNorm = new Vector3();\n    var rotationAngle = 0;\n\n    var cameraPosition = new Vector3();\n    var cameraQuaternion = new Quaternion();\n    var cameraScale = new Vector3();\n\n    var parentPosition = new Vector3();\n    var parentQuaternion = new Quaternion();\n    var parentQuaternionInv = new Quaternion();\n    var parentScale = new Vector3();\n\n    var worldPositionStart = new Vector3();\n    var worldQuaternionStart = new Quaternion();\n    var worldScaleStart = new Vector3();\n\n    var worldPosition = new Vector3();\n    var worldQuaternion = new Quaternion();\n    var worldQuaternionInv = new Quaternion();\n    var worldScale = new Vector3();\n\n    var eye = new Vector3();\n\n    var positionStart = new Vector3();\n    var quaternionStart = new Quaternion();\n    var scaleStart = new Vector3();\n\n    // TODO: remove properties unused in plane and gizmo\n\n    defineProperty( 'worldPosition', worldPosition );\n    defineProperty( 'worldPositionStart', worldPositionStart );\n    defineProperty( 'worldQuaternion', worldQuaternion );\n    defineProperty( 'worldQuaternionStart', worldQuaternionStart );\n    defineProperty( 'cameraPosition', cameraPosition );\n    defineProperty( 'cameraQuaternion', cameraQuaternion );\n    defineProperty( 'pointStart', pointStart );\n    defineProperty( 'pointEnd', pointEnd );\n    defineProperty( 'rotationAxis', rotationAxis );\n    defineProperty( 'rotationAngle', rotationAngle );\n    defineProperty( 'eye', eye );\n\n    {\n\n        domElement.addEventListener( 'pointerdown', onPointerDown );\n        domElement.addEventListener( 'pointermove', onPointerHover );\n        scope.domElement.ownerDocument.addEventListener( 'pointerup', onPointerUp );\n\n    }\n\n    this.dispose = function () {\n\n        domElement.removeEventListener( 'pointerdown', onPointerDown );\n        domElement.removeEventListener( 'pointermove', onPointerHover );\n        scope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n        scope.domElement.ownerDocument.removeEventListener( 'pointerup', onPointerUp );\n\n        this.traverse( function ( child ) {\n\n            if ( child.geometry ) child.geometry.dispose();\n            if ( child.material ) child.material.dispose();\n\n        } );\n\n    };\n\n    // Set current object\n    this.attach = function ( object ) {\n\n        this.object = object;\n        this.visible = true;\n\n        return this;\n\n    };\n\n    // Detatch from object\n    this.detach = function () {\n\n        this.object = undefined;\n        this.visible = false;\n        this.axis = null;\n\n        return this;\n\n    };\n\n    // Defined getter, setter and store for a property\n    function defineProperty( propName, defaultValue ) {\n\n        var propValue = defaultValue;\n\n        Object.defineProperty( scope, propName, {\n\n            get: function () {\n\n                return propValue !== undefined ? propValue : defaultValue;\n\n            },\n\n            set: function ( value ) {\n\n                if ( propValue !== value ) {\n\n                    propValue = value;\n                    _plane[ propName ] = value;\n                    _gizmo[ propName ] = value;\n\n                    scope.dispatchEvent( { type: propName + '-changed', value: value } );\n                    scope.dispatchEvent( changeEvent );\n\n                }\n\n            }\n\n        } );\n\n        scope[ propName ] = defaultValue;\n        _plane[ propName ] = defaultValue;\n        _gizmo[ propName ] = defaultValue;\n\n    }\n\n    // updateMatrixWorld  updates key transformation variables\n    this.updateMatrixWorld = function () {\n\n        if ( this.object !== undefined ) {\n\n            this.object.updateMatrixWorld();\n\n            if ( this.object.parent === null ) {\n\n                console.error( 'TransformControls: The attached 3D object must be a part of the scene graph.' );\n\n            } else {\n\n                this.object.parent.matrixWorld.decompose( parentPosition, parentQuaternion, parentScale );\n\n            }\n\n            this.object.matrixWorld.decompose( worldPosition, worldQuaternion, worldScale );\n\n            parentQuaternionInv.copy( parentQuaternion ).invert();\n            worldQuaternionInv.copy( worldQuaternion ).invert();\n\n        }\n\n        this.camera.updateMatrixWorld();\n        this.camera.matrixWorld.decompose( cameraPosition, cameraQuaternion, cameraScale );\n\n        eye.copy( cameraPosition ).sub( worldPosition ).normalize();\n\n        Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n    this.pointerHover = function ( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true ) return;\n\n        raycaster.setFromCamera( pointer, this.camera );\n\n        var intersect = intersectObjectWithRay( _gizmo.picker[ this.mode ], raycaster );\n\n        if ( intersect ) {\n\n            this.axis = intersect.object.name;\n\n        } else {\n\n            this.axis = null;\n\n        }\n\n    };\n\n    this.pointerDown = function ( pointer ) {\n\n        if ( this.object === undefined || this.dragging === true || pointer.button !== 0 ) return;\n\n        if ( this.axis !== null ) {\n\n            raycaster.setFromCamera( pointer, this.camera );\n\n            var planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n            if ( planeIntersect ) {\n\n                var space = this.space;\n\n                if ( this.mode === 'scale' ) {\n\n                    space = 'local';\n\n                } else if ( this.axis === 'E' || this.axis === 'XYZE' || this.axis === 'XYZ' ) {\n\n                    space = 'world';\n\n                }\n\n                if ( space === 'local' && this.mode === 'rotate' ) {\n\n                    var snap = this.rotationSnap;\n\n                    if ( this.axis === 'X' && snap ) this.object.rotation.x = Math.round( this.object.rotation.x / snap ) * snap;\n                    if ( this.axis === 'Y' && snap ) this.object.rotation.y = Math.round( this.object.rotation.y / snap ) * snap;\n                    if ( this.axis === 'Z' && snap ) this.object.rotation.z = Math.round( this.object.rotation.z / snap ) * snap;\n\n                }\n\n                this.object.updateMatrixWorld();\n                this.object.parent.updateMatrixWorld();\n\n                positionStart.copy( this.object.position );\n                quaternionStart.copy( this.object.quaternion );\n                scaleStart.copy( this.object.scale );\n\n                this.object.matrixWorld.decompose( worldPositionStart, worldQuaternionStart, worldScaleStart );\n\n                pointStart.copy( planeIntersect.point ).sub( worldPositionStart );\n\n            }\n\n            this.dragging = true;\n            mouseDownEvent.mode = this.mode;\n            this.dispatchEvent( mouseDownEvent );\n\n        }\n\n    };\n\n    this.pointerMove = function ( pointer ) {\n\n        var axis = this.axis;\n        var mode = this.mode;\n        var object = this.object;\n        var space = this.space;\n\n        if ( mode === 'scale' ) {\n\n            space = 'local';\n\n        } else if ( axis === 'E' || axis === 'XYZE' || axis === 'XYZ' ) {\n\n            space = 'world';\n\n        }\n\n        if ( object === undefined || axis === null || this.dragging === false || pointer.button !== - 1 ) return;\n\n        raycaster.setFromCamera( pointer, this.camera );\n\n        var planeIntersect = intersectObjectWithRay( _plane, raycaster, true );\n\n        if ( ! planeIntersect ) return;\n\n        pointEnd.copy( planeIntersect.point ).sub( worldPositionStart );\n\n        if ( mode === 'translate' ) {\n\n            // Apply translate\n\n            offset.copy( pointEnd ).sub( pointStart );\n\n            if ( space === 'local' && axis !== 'XYZ' ) {\n\n                offset.applyQuaternion( worldQuaternionInv );\n\n            }\n\n            if ( axis.indexOf( 'X' ) === - 1 ) offset.x = 0;\n            if ( axis.indexOf( 'Y' ) === - 1 ) offset.y = 0;\n            if ( axis.indexOf( 'Z' ) === - 1 ) offset.z = 0;\n\n            if ( space === 'local' && axis !== 'XYZ' ) {\n\n                offset.applyQuaternion( quaternionStart ).divide( parentScale );\n\n            } else {\n\n                offset.applyQuaternion( parentQuaternionInv ).divide( parentScale );\n\n            }\n\n            object.position.copy( offset ).add( positionStart );\n\n            // Apply translation snap\n\n            if ( this.translationSnap ) {\n\n                if ( space === 'local' ) {\n\n                    object.position.applyQuaternion( _tempQuaternion.copy( quaternionStart ).invert() );\n\n                    if ( axis.search( 'X' ) !== - 1 ) {\n\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    if ( axis.search( 'Y' ) !== - 1 ) {\n\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    if ( axis.search( 'Z' ) !== - 1 ) {\n\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    object.position.applyQuaternion( quaternionStart );\n\n                }\n\n                if ( space === 'world' ) {\n\n                    if ( object.parent ) {\n\n                        object.position.add( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n                    }\n\n                    if ( axis.search( 'X' ) !== - 1 ) {\n\n                        object.position.x = Math.round( object.position.x / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    if ( axis.search( 'Y' ) !== - 1 ) {\n\n                        object.position.y = Math.round( object.position.y / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    if ( axis.search( 'Z' ) !== - 1 ) {\n\n                        object.position.z = Math.round( object.position.z / this.translationSnap ) * this.translationSnap;\n\n                    }\n\n                    if ( object.parent ) {\n\n                        object.position.sub( _tempVector.setFromMatrixPosition( object.parent.matrixWorld ) );\n\n                    }\n\n                }\n\n            }\n\n        } else if ( mode === 'scale' ) {\n\n            if ( axis.search( 'XYZ' ) !== - 1 ) {\n\n                var d = pointEnd.length() / pointStart.length();\n\n                if ( pointEnd.dot( pointStart ) < 0 ) d *= - 1;\n\n                _tempVector2.set( d, d, d );\n\n            } else {\n\n                _tempVector.copy( pointStart );\n                _tempVector2.copy( pointEnd );\n\n                _tempVector.applyQuaternion( worldQuaternionInv );\n                _tempVector2.applyQuaternion( worldQuaternionInv );\n\n                _tempVector2.divide( _tempVector );\n\n                if ( axis.search( 'X' ) === - 1 ) {\n\n                    _tempVector2.x = 1;\n\n                }\n\n                if ( axis.search( 'Y' ) === - 1 ) {\n\n                    _tempVector2.y = 1;\n\n                }\n\n                if ( axis.search( 'Z' ) === - 1 ) {\n\n                    _tempVector2.z = 1;\n\n                }\n\n            }\n\n            // Apply scale\n\n            object.scale.copy( scaleStart ).multiply( _tempVector2 );\n\n            if ( this.scaleSnap ) {\n\n                if ( axis.search( 'X' ) !== - 1 ) {\n\n                    object.scale.x = Math.round( object.scale.x / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n                }\n\n                if ( axis.search( 'Y' ) !== - 1 ) {\n\n                    object.scale.y = Math.round( object.scale.y / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n                }\n\n                if ( axis.search( 'Z' ) !== - 1 ) {\n\n                    object.scale.z = Math.round( object.scale.z / this.scaleSnap ) * this.scaleSnap || this.scaleSnap;\n\n                }\n\n            }\n\n        } else if ( mode === 'rotate' ) {\n\n            offset.copy( pointEnd ).sub( pointStart );\n\n            var ROTATION_SPEED = 20 / worldPosition.distanceTo( _tempVector.setFromMatrixPosition( this.camera.matrixWorld ) );\n\n            if ( axis === 'E' ) {\n\n                rotationAxis.copy( eye );\n                rotationAngle = pointEnd.angleTo( pointStart );\n\n                startNorm.copy( pointStart ).normalize();\n                endNorm.copy( pointEnd ).normalize();\n\n                rotationAngle *= ( endNorm.cross( startNorm ).dot( eye ) < 0 ? 1 : - 1 );\n\n            } else if ( axis === 'XYZE' ) {\n\n                rotationAxis.copy( offset ).cross( eye ).normalize();\n                rotationAngle = offset.dot( _tempVector.copy( rotationAxis ).cross( this.eye ) ) * ROTATION_SPEED;\n\n            } else if ( axis === 'X' || axis === 'Y' || axis === 'Z' ) {\n\n                rotationAxis.copy( _unit[ axis ] );\n\n                _tempVector.copy( _unit[ axis ] );\n\n                if ( space === 'local' ) {\n\n                    _tempVector.applyQuaternion( worldQuaternion );\n\n                }\n\n                rotationAngle = offset.dot( _tempVector.cross( eye ).normalize() ) * ROTATION_SPEED;\n\n            }\n\n            // Apply rotation snap\n\n            if ( this.rotationSnap ) rotationAngle = Math.round( rotationAngle / this.rotationSnap ) * this.rotationSnap;\n\n            this.rotationAngle = rotationAngle;\n\n            // Apply rotate\n            if ( space === 'local' && axis !== 'E' && axis !== 'XYZE' ) {\n\n                object.quaternion.copy( quaternionStart );\n                object.quaternion.multiply( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) ).normalize();\n\n            } else {\n\n                rotationAxis.applyQuaternion( parentQuaternionInv );\n                object.quaternion.copy( _tempQuaternion.setFromAxisAngle( rotationAxis, rotationAngle ) );\n                object.quaternion.multiply( quaternionStart ).normalize();\n\n            }\n\n        }\n\n        this.dispatchEvent( changeEvent );\n        this.dispatchEvent( objectChangeEvent );\n\n    };\n\n    this.pointerUp = function ( pointer ) {\n\n        if ( pointer.button !== 0 ) return;\n\n        if ( this.dragging && ( this.axis !== null ) ) {\n\n            mouseUpEvent.mode = this.mode;\n            this.dispatchEvent( mouseUpEvent );\n\n        }\n\n        this.dragging = false;\n        this.axis = null;\n\n    };\n\n    // normalize mouse / touch pointer and remap {x,y} to view space.\n\n    function getPointer( event ) {\n\n        if ( scope.domElement.ownerDocument.pointerLockElement ) {\n\n            return {\n                x: 0,\n                y: 0,\n                button: event.button\n            };\n\n        } else {\n\n            var pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\n\n            var rect = domElement.getBoundingClientRect();\n\n            return {\n                x: ( pointer.clientX - rect.left ) / rect.width * 2 - 1,\n                y: - ( pointer.clientY - rect.top ) / rect.height * 2 + 1,\n                button: event.button\n            };\n\n        }\n\n    }\n\n    // mouse / touch event handlers\n\n    function onPointerHover( event ) {\n\n        if ( ! scope.enabled ) return;\n\n        switch ( event.pointerType ) {\n\n            case 'mouse':\n            case 'pen':\n                scope.pointerHover( getPointer( event ) );\n                break;\n\n        }\n\n    }\n\n    function onPointerDown( event ) {\n\n        if ( ! scope.enabled ) return;\n\n        scope.domElement.style.touchAction = 'none'; // disable touch scroll\n        scope.domElement.ownerDocument.addEventListener( 'pointermove', onPointerMove );\n\n        scope.pointerHover( getPointer( event ) );\n        scope.pointerDown( getPointer( event ) );\n\n    }\n\n    function onPointerMove( event ) {\n\n        if ( ! scope.enabled ) return;\n\n        scope.pointerMove( getPointer( event ) );\n\n    }\n\n    function onPointerUp( event ) {\n\n        if ( ! scope.enabled ) return;\n\n        scope.domElement.style.touchAction = '';\n        scope.domElement.ownerDocument.removeEventListener( 'pointermove', onPointerMove );\n\n        scope.pointerUp( getPointer( event ) );\n\n    }\n\n    // TODO: deprecate\n\n    this.getMode = function () {\n\n        return scope.mode;\n\n    };\n\n    this.setMode = function ( mode ) {\n\n        scope.mode = mode;\n\n    };\n\n    this.setTranslationSnap = function ( translationSnap ) {\n\n        scope.translationSnap = translationSnap;\n\n    };\n\n    this.setRotationSnap = function ( rotationSnap ) {\n\n        scope.rotationSnap = rotationSnap;\n\n    };\n\n    this.setScaleSnap = function ( scaleSnap ) {\n\n        scope.scaleSnap = scaleSnap;\n\n    };\n\n    this.setSize = function ( size ) {\n\n        scope.size = size;\n\n    };\n\n    this.setSpace = function ( space ) {\n\n        scope.space = space;\n\n    };\n\n    this.update = function () {\n\n        console.warn( 'THREE.TransformControls: update function has no more functionality and therefore has been deprecated.' );\n\n    };\n\n};\n\nTransformControls.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n    constructor: TransformControls,\n\n    isTransformControls: true\n\n} );\n\n\nvar TransformControlsGizmo = function () {\n\n    'use strict';\n\n    Object3D.call( this );\n\n    this.type = 'TransformControlsGizmo';\n\n    // shared materials\n\n    var gizmoMaterial = new MeshBasicMaterial( {\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        side: DoubleSide,\n        fog: false,\n        toneMapped: false\n    } );\n\n    var gizmoLineMaterial = new LineBasicMaterial( {\n        depthTest: false,\n        depthWrite: false,\n        transparent: true,\n        linewidth: 1,\n        fog: false,\n        toneMapped: false\n    } );\n\n    // Make unique material for each axis/color\n\n    var matInvisible = gizmoMaterial.clone();\n    matInvisible.opacity = 0.15;\n\n    var matHelper = gizmoMaterial.clone();\n    matHelper.opacity = 0.33;\n\n    var matRed = gizmoMaterial.clone();\n    matRed.color.set( 0xff0000 );\n\n    var matGreen = gizmoMaterial.clone();\n    matGreen.color.set( 0x00ff00 );\n\n    var matBlue = gizmoMaterial.clone();\n    matBlue.color.set( 0x0000ff );\n\n    var matWhiteTransparent = gizmoMaterial.clone();\n    matWhiteTransparent.opacity = 0.25;\n\n    var matYellowTransparent = matWhiteTransparent.clone();\n    matYellowTransparent.color.set( 0xffff00 );\n\n    var matCyanTransparent = matWhiteTransparent.clone();\n    matCyanTransparent.color.set( 0x00ffff );\n\n    var matMagentaTransparent = matWhiteTransparent.clone();\n    matMagentaTransparent.color.set( 0xff00ff );\n\n    var matYellow = gizmoMaterial.clone();\n    matYellow.color.set( 0xffff00 );\n\n    var matLineRed = gizmoLineMaterial.clone();\n    matLineRed.color.set( 0xff0000 );\n\n    var matLineGreen = gizmoLineMaterial.clone();\n    matLineGreen.color.set( 0x00ff00 );\n\n    var matLineBlue = gizmoLineMaterial.clone();\n    matLineBlue.color.set( 0x0000ff );\n\n    var matLineCyan = gizmoLineMaterial.clone();\n    matLineCyan.color.set( 0x00ffff );\n\n    var matLineMagenta = gizmoLineMaterial.clone();\n    matLineMagenta.color.set( 0xff00ff );\n\n    var matLineYellow = gizmoLineMaterial.clone();\n    matLineYellow.color.set( 0xffff00 );\n\n    var matLineGray = gizmoLineMaterial.clone();\n    matLineGray.color.set( 0x787878 );\n\n    var matLineYellowTransparent = matLineYellow.clone();\n    matLineYellowTransparent.opacity = 0.25;\n\n    // reusable geometry\n\n    var arrowGeometry = new CylinderGeometry( 0, 0.05, 0.2, 12, 1, false );\n\n    var scaleHandleGeometry = new BoxGeometry( 0.125, 0.125, 0.125 );\n\n    var lineGeometry = new BufferGeometry();\n    lineGeometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0,\t1, 0, 0 ], 3 ) );\n\n    var CircleGeometry = function ( radius, arc ) {\n\n        var geometry = new BufferGeometry( );\n        var vertices = [];\n\n        for ( var i = 0; i <= 64 * arc; ++ i ) {\n\n            vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\n\n        }\n\n        geometry.setAttribute( 'position', new Float32BufferAttribute( vertices, 3 ) );\n\n        return geometry;\n\n    };\n\n    // Special geometry for transform helper. If scaled with position vector it spans from [0,0,0] to position\n\n    var TranslateHelperGeometry = function () {\n\n        var geometry = new BufferGeometry();\n\n        geometry.setAttribute( 'position', new Float32BufferAttribute( [ 0, 0, 0, 1, 1, 1 ], 3 ) );\n\n        return geometry;\n\n    };\n\n    // Gizmo definitions - custom hierarchy definitions for setupGizmo() function\n\n    var gizmoTranslate = {\n        X: [\n            [ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, - Math.PI / 2 ], null, 'fwd' ],\n            [ new Mesh( arrowGeometry, matRed ), [ 1, 0, 0 ], [ 0, 0, Math.PI / 2 ], null, 'bwd' ],\n            [ new Line( lineGeometry, matLineRed ) ]\n        ],\n        Y: [\n            [ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], null, null, 'fwd' ],\n            [ new Mesh( arrowGeometry, matGreen ), [ 0, 1, 0 ], [ Math.PI, 0, 0 ], null, 'bwd' ],\n            [ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ]]\n        ],\n        Z: [\n            [ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ Math.PI / 2, 0, 0 ], null, 'fwd' ],\n            [ new Mesh( arrowGeometry, matBlue ), [ 0, 0, 1 ], [ - Math.PI / 2, 0, 0 ], null, 'bwd' ],\n            [ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ]]\n        ],\n        XYZ: [\n            [ new Mesh( new OctahedronGeometry( 0.1, 0 ), matWhiteTransparent.clone() ), [ 0, 0, 0 ], [ 0, 0, 0 ]]\n        ],\n        XY: [\n            [ new Mesh( new PlaneGeometry( 0.295, 0.295 ), matYellowTransparent.clone() ), [ 0.15, 0.15, 0 ]],\n            [ new Line( lineGeometry, matLineYellow ), [ 0.18, 0.3, 0 ], null, [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineYellow ), [ 0.3, 0.18, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n        ],\n        YZ: [\n            [ new Mesh( new PlaneGeometry( 0.295, 0.295 ), matCyanTransparent.clone() ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ]],\n            [ new Line( lineGeometry, matLineCyan ), [ 0, 0.18, 0.3 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineCyan ), [ 0, 0.3, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n        ],\n        XZ: [\n            [ new Mesh( new PlaneGeometry( 0.295, 0.295 ), matMagentaTransparent.clone() ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ]],\n            [ new Line( lineGeometry, matLineMagenta ), [ 0.18, 0, 0.3 ], null, [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineMagenta ), [ 0.3, 0, 0.18 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n        ]\n    };\n\n    var pickerTranslate = {\n        X: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n        ],\n        Y: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0.6, 0 ]]\n        ],\n        Z: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 1, 4, 1, false ), matInvisible ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ]]\n        ],\n        XYZ: [\n            [ new Mesh( new OctahedronGeometry( 0.2, 0 ), matInvisible ) ]\n        ],\n        XY: [\n            [ new Mesh( new PlaneGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0.2, 0 ]]\n        ],\n        YZ: [\n            [ new Mesh( new PlaneGeometry( 0.4, 0.4 ), matInvisible ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ]]\n        ],\n        XZ: [\n            [ new Mesh( new PlaneGeometry( 0.4, 0.4 ), matInvisible ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ]]\n        ]\n    };\n\n    var helperTranslate = {\n        START: [\n            [ new Mesh( new OctahedronGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        END: [\n            [ new Mesh( new OctahedronGeometry( 0.01, 2 ), matHelper ), null, null, null, 'helper' ]\n        ],\n        DELTA: [\n            [ new Line( TranslateHelperGeometry(), matHelper ), null, null, null, 'helper' ]\n        ],\n        X: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var gizmoRotate = {\n        X: [\n            [ new Line( CircleGeometry( 1, 0.5 ), matLineRed ) ],\n            [ new Mesh( new OctahedronGeometry( 0.04, 0 ), matRed ), [ 0, 0, 0.99 ], null, [ 1, 3, 1 ]],\n        ],\n        Y: [\n            [ new Line( CircleGeometry( 1, 0.5 ), matLineGreen ), null, [ 0, 0, - Math.PI / 2 ]],\n            [ new Mesh( new OctahedronGeometry( 0.04, 0 ), matGreen ), [ 0, 0, 0.99 ], null, [ 3, 1, 1 ]],\n        ],\n        Z: [\n            [ new Line( CircleGeometry( 1, 0.5 ), matLineBlue ), null, [ 0, Math.PI / 2, 0 ]],\n            [ new Mesh( new OctahedronGeometry( 0.04, 0 ), matBlue ), [ 0.99, 0, 0 ], null, [ 1, 3, 1 ]],\n        ],\n        E: [\n            [ new Line( CircleGeometry( 1.25, 1 ), matLineYellowTransparent ), null, [ 0, Math.PI / 2, 0 ]],\n            [ new Mesh( new CylinderGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 1.17, 0, 0 ], [ 0, 0, - Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new Mesh( new CylinderGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ - 1.17, 0, 0 ], [ 0, 0, Math.PI / 2 ], [ 1, 1, 0.001 ]],\n            [ new Mesh( new CylinderGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, - 1.17, 0 ], [ Math.PI, 0, 0 ], [ 1, 1, 0.001 ]],\n            [ new Mesh( new CylinderGeometry( 0.03, 0, 0.15, 4, 1, false ), matLineYellowTransparent ), [ 0, 1.17, 0 ], [ 0, 0, 0 ], [ 1, 1, 0.001 ]],\n        ],\n        XYZE: [\n            [ new Line( CircleGeometry( 1, 1 ), matLineGray ), null, [ 0, Math.PI / 2, 0 ]]\n        ]\n    };\n\n    var helperRotate = {\n        AXIS: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    var pickerRotate = {\n        X: [\n            [ new Mesh( new TorusGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ]],\n        ],\n        Y: [\n            [ new Mesh( new TorusGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ]],\n        ],\n        Z: [\n            [ new Mesh( new TorusGeometry( 1, 0.1, 4, 24 ), matInvisible ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n        ],\n        E: [\n            [ new Mesh( new TorusGeometry( 1.25, 0.1, 2, 24 ), matInvisible ) ]\n        ],\n        XYZE: [\n            [ new Mesh( new SphereGeometry( 0.7, 10, 8 ), matInvisible ) ]\n        ]\n    };\n\n    var gizmoScale = {\n        X: [\n            [ new Mesh( scaleHandleGeometry, matRed ), [ 0.8, 0, 0 ], [ 0, 0, - Math.PI / 2 ]],\n            [ new Line( lineGeometry, matLineRed ), null, null, [ 0.8, 1, 1 ]]\n        ],\n        Y: [\n            [ new Mesh( scaleHandleGeometry, matGreen ), [ 0, 0.8, 0 ]],\n            [ new Line( lineGeometry, matLineGreen ), null, [ 0, 0, Math.PI / 2 ], [ 0.8, 1, 1 ]]\n        ],\n        Z: [\n            [ new Mesh( scaleHandleGeometry, matBlue ), [ 0, 0, 0.8 ], [ Math.PI / 2, 0, 0 ]],\n            [ new Line( lineGeometry, matLineBlue ), null, [ 0, - Math.PI / 2, 0 ], [ 0.8, 1, 1 ]]\n        ],\n        XY: [\n            [ new Mesh( scaleHandleGeometry, matYellowTransparent ), [ 0.85, 0.85, 0 ], null, [ 2, 2, 0.2 ]],\n            [ new Line( lineGeometry, matLineYellow ), [ 0.855, 0.98, 0 ], null, [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineYellow ), [ 0.98, 0.855, 0 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]]\n        ],\n        YZ: [\n            [ new Mesh( scaleHandleGeometry, matCyanTransparent ), [ 0, 0.85, 0.85 ], null, [ 0.2, 2, 2 ]],\n            [ new Line( lineGeometry, matLineCyan ), [ 0, 0.855, 0.98 ], [ 0, 0, Math.PI / 2 ], [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineCyan ), [ 0, 0.98, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n        ],\n        XZ: [\n            [ new Mesh( scaleHandleGeometry, matMagentaTransparent ), [ 0.85, 0, 0.85 ], null, [ 2, 0.2, 2 ]],\n            [ new Line( lineGeometry, matLineMagenta ), [ 0.855, 0, 0.98 ], null, [ 0.125, 1, 1 ]],\n            [ new Line( lineGeometry, matLineMagenta ), [ 0.98, 0, 0.855 ], [ 0, - Math.PI / 2, 0 ], [ 0.125, 1, 1 ]]\n        ],\n        XYZX: [\n            [ new Mesh( new BoxGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 1.1, 0, 0 ]],\n        ],\n        XYZY: [\n            [ new Mesh( new BoxGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 1.1, 0 ]],\n        ],\n        XYZZ: [\n            [ new Mesh( new BoxGeometry( 0.125, 0.125, 0.125 ), matWhiteTransparent.clone() ), [ 0, 0, 1.1 ]],\n        ]\n    };\n\n    var pickerScale = {\n        X: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ]]\n        ],\n        Y: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0.5, 0 ]]\n        ],\n        Z: [\n            [ new Mesh( new CylinderGeometry( 0.2, 0, 0.8, 4, 1, false ), matInvisible ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ]]\n        ],\n        XY: [\n            [ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0.85, 0 ], null, [ 3, 3, 0.2 ]],\n        ],\n        YZ: [\n            [ new Mesh( scaleHandleGeometry, matInvisible ), [ 0, 0.85, 0.85 ], null, [ 0.2, 3, 3 ]],\n        ],\n        XZ: [\n            [ new Mesh( scaleHandleGeometry, matInvisible ), [ 0.85, 0, 0.85 ], null, [ 3, 0.2, 3 ]],\n        ],\n        XYZX: [\n            [ new Mesh( new BoxGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 1.1, 0, 0 ]],\n        ],\n        XYZY: [\n            [ new Mesh( new BoxGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 1.1, 0 ]],\n        ],\n        XYZZ: [\n            [ new Mesh( new BoxGeometry( 0.2, 0.2, 0.2 ), matInvisible ), [ 0, 0, 1.1 ]],\n        ]\n    };\n\n    var helperScale = {\n        X: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ - 1e3, 0, 0 ], null, [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Y: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ 0, - 1e3, 0 ], [ 0, 0, Math.PI / 2 ], [ 1e6, 1, 1 ], 'helper' ]\n        ],\n        Z: [\n            [ new Line( lineGeometry, matHelper.clone() ), [ 0, 0, - 1e3 ], [ 0, - Math.PI / 2, 0 ], [ 1e6, 1, 1 ], 'helper' ]\n        ]\n    };\n\n    // Creates an Object3D with gizmos described in custom hierarchy definition.\n\n    var setupGizmo = function ( gizmoMap ) {\n\n        var gizmo = new Object3D();\n\n        for ( var name in gizmoMap ) {\n\n            for ( var i = gizmoMap[ name ].length; i --; ) {\n\n                var object = gizmoMap[ name ][ i ][ 0 ].clone();\n                var position = gizmoMap[ name ][ i ][ 1 ];\n                var rotation = gizmoMap[ name ][ i ][ 2 ];\n                var scale = gizmoMap[ name ][ i ][ 3 ];\n                var tag = gizmoMap[ name ][ i ][ 4 ];\n\n                // name and tag properties are essential for picking and updating logic.\n                object.name = name;\n                object.tag = tag;\n\n                if ( position ) {\n\n                    object.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\n\n                }\n\n                if ( rotation ) {\n\n                    object.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\n\n                }\n\n                if ( scale ) {\n\n                    object.scale.set( scale[ 0 ], scale[ 1 ], scale[ 2 ] );\n\n                }\n\n                object.updateMatrix();\n\n                var tempGeometry = object.geometry.clone();\n                tempGeometry.applyMatrix4( object.matrix );\n                object.geometry = tempGeometry;\n                object.renderOrder = Infinity;\n\n                object.position.set( 0, 0, 0 );\n                object.rotation.set( 0, 0, 0 );\n                object.scale.set( 1, 1, 1 );\n\n                gizmo.add( object );\n\n            }\n\n        }\n\n        return gizmo;\n\n    };\n\n    // Reusable utility variables\n\n    var tempVector = new Vector3( 0, 0, 0 );\n    var tempEuler = new Euler();\n    var alignVector = new Vector3( 0, 1, 0 );\n    var zeroVector = new Vector3( 0, 0, 0 );\n    var lookAtMatrix = new Matrix4();\n    var tempQuaternion = new Quaternion();\n    var tempQuaternion2 = new Quaternion();\n    var identityQuaternion = new Quaternion();\n\n    var unitX = new Vector3( 1, 0, 0 );\n    var unitY = new Vector3( 0, 1, 0 );\n    var unitZ = new Vector3( 0, 0, 1 );\n\n    // Gizmo creation\n\n    this.gizmo = {};\n    this.picker = {};\n    this.helper = {};\n\n    this.add( this.gizmo[ 'translate' ] = setupGizmo( gizmoTranslate ) );\n    this.add( this.gizmo[ 'rotate' ] = setupGizmo( gizmoRotate ) );\n    this.add( this.gizmo[ 'scale' ] = setupGizmo( gizmoScale ) );\n    this.add( this.picker[ 'translate' ] = setupGizmo( pickerTranslate ) );\n    this.add( this.picker[ 'rotate' ] = setupGizmo( pickerRotate ) );\n    this.add( this.picker[ 'scale' ] = setupGizmo( pickerScale ) );\n    this.add( this.helper[ 'translate' ] = setupGizmo( helperTranslate ) );\n    this.add( this.helper[ 'rotate' ] = setupGizmo( helperRotate ) );\n    this.add( this.helper[ 'scale' ] = setupGizmo( helperScale ) );\n\n    // Pickers should be hidden always\n\n    this.picker[ 'translate' ].visible = false;\n    this.picker[ 'rotate' ].visible = false;\n    this.picker[ 'scale' ].visible = false;\n\n    // updateMatrixWorld will update transformations and appearance of individual handles\n\n    this.updateMatrixWorld = function () {\n\n        var space = this.space;\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        var quaternion = space === 'local' ? this.worldQuaternion : identityQuaternion;\n\n        // Show only gizmos for current transform mode\n\n        this.gizmo[ 'translate' ].visible = this.mode === 'translate';\n        this.gizmo[ 'rotate' ].visible = this.mode === 'rotate';\n        this.gizmo[ 'scale' ].visible = this.mode === 'scale';\n\n        this.helper[ 'translate' ].visible = this.mode === 'translate';\n        this.helper[ 'rotate' ].visible = this.mode === 'rotate';\n        this.helper[ 'scale' ].visible = this.mode === 'scale';\n\n\n        var handles = [];\n        handles = handles.concat( this.picker[ this.mode ].children );\n        handles = handles.concat( this.gizmo[ this.mode ].children );\n        handles = handles.concat( this.helper[ this.mode ].children );\n\n        for ( var i = 0; i < handles.length; i ++ ) {\n\n            var handle = handles[ i ];\n\n            // hide aligned to camera\n\n            handle.visible = true;\n            handle.rotation.set( 0, 0, 0 );\n            handle.position.copy( this.worldPosition );\n\n            var factor;\n\n            if ( this.camera.isOrthographicCamera ) {\n\n                factor = ( this.camera.top - this.camera.bottom ) / this.camera.zoom;\n\n            } else {\n\n                factor = this.worldPosition.distanceTo( this.cameraPosition ) * Math.min( 1.9 * Math.tan( Math.PI * this.camera.fov / 360 ) / this.camera.zoom, 7 );\n\n            }\n\n            handle.scale.set( 1, 1, 1 ).multiplyScalar( factor * this.size / 7 );\n\n            // TODO: simplify helpers and consider decoupling from gizmo\n\n            if ( handle.tag === 'helper' ) {\n\n                handle.visible = false;\n\n                if ( handle.name === 'AXIS' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = !! this.axis;\n\n                    if ( this.axis === 'X' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n                            handle.visible = false;\n\n                        }\n\n                    }\n\n                    if ( this.axis === 'Y' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, 0, Math.PI / 2 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n                            handle.visible = false;\n\n                        }\n\n                    }\n\n                    if ( this.axis === 'Z' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        handle.quaternion.copy( quaternion ).multiply( tempQuaternion );\n\n                        if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > 0.9 ) {\n\n                            handle.visible = false;\n\n                        }\n\n                    }\n\n                    if ( this.axis === 'XYZE' ) {\n\n                        tempQuaternion.setFromEuler( tempEuler.set( 0, Math.PI / 2, 0 ) );\n                        alignVector.copy( this.rotationAxis );\n                        handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( zeroVector, alignVector, unitY ) );\n                        handle.quaternion.multiply( tempQuaternion );\n                        handle.visible = this.dragging;\n\n                    }\n\n                    if ( this.axis === 'E' ) {\n\n                        handle.visible = false;\n\n                    }\n\n\n                } else if ( handle.name === 'START' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'END' ) {\n\n                    handle.position.copy( this.worldPosition );\n                    handle.visible = this.dragging;\n\n                } else if ( handle.name === 'DELTA' ) {\n\n                    handle.position.copy( this.worldPositionStart );\n                    handle.quaternion.copy( this.worldQuaternionStart );\n                    tempVector.set( 1e-10, 1e-10, 1e-10 ).add( this.worldPositionStart ).sub( this.worldPosition ).multiplyScalar( - 1 );\n                    tempVector.applyQuaternion( this.worldQuaternionStart.clone().invert() );\n                    handle.scale.copy( tempVector );\n                    handle.visible = this.dragging;\n\n                } else {\n\n                    handle.quaternion.copy( quaternion );\n\n                    if ( this.dragging ) {\n\n                        handle.position.copy( this.worldPositionStart );\n\n                    } else {\n\n                        handle.position.copy( this.worldPosition );\n\n                    }\n\n                    if ( this.axis ) {\n\n                        handle.visible = this.axis.search( handle.name ) !== - 1;\n\n                    }\n\n                }\n\n                // If updating helper, skip rest of the loop\n                continue;\n\n            }\n\n            // Align handles to current local or world rotation\n\n            handle.quaternion.copy( quaternion );\n\n            if ( this.mode === 'translate' || this.mode === 'scale' ) {\n\n                // Hide translate and scale axis facing the camera\n\n                var AXIS_HIDE_TRESHOLD = 0.99;\n                var PLANE_HIDE_TRESHOLD = 0.2;\n                var AXIS_FLIP_TRESHOLD = 0.0;\n\n\n                if ( handle.name === 'X' || handle.name === 'XYZX' ) {\n\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name === 'Y' || handle.name === 'XYZY' ) {\n\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name === 'Z' || handle.name === 'XYZZ' ) {\n\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) > AXIS_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name === 'XY' ) {\n\n                    if ( Math.abs( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name === 'YZ' ) {\n\n                    if ( Math.abs( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name === 'XZ' ) {\n\n                    if ( Math.abs( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) ) < PLANE_HIDE_TRESHOLD ) {\n\n                        handle.scale.set( 1e-10, 1e-10, 1e-10 );\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                // Flip translate and scale axis ocluded behind another axis\n\n                if ( handle.name.search( 'X' ) !== - 1 ) {\n\n                    if ( alignVector.copy( unitX ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n                        if ( handle.tag === 'fwd' ) {\n\n                            handle.visible = false;\n\n                        } else {\n\n                            handle.scale.x *= - 1;\n\n                        }\n\n                    } else if ( handle.tag === 'bwd' ) {\n\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name.search( 'Y' ) !== - 1 ) {\n\n                    if ( alignVector.copy( unitY ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n                        if ( handle.tag === 'fwd' ) {\n\n                            handle.visible = false;\n\n                        } else {\n\n                            handle.scale.y *= - 1;\n\n                        }\n\n                    } else if ( handle.tag === 'bwd' ) {\n\n                        handle.visible = false;\n\n                    }\n\n                }\n\n                if ( handle.name.search( 'Z' ) !== - 1 ) {\n\n                    if ( alignVector.copy( unitZ ).applyQuaternion( quaternion ).dot( this.eye ) < AXIS_FLIP_TRESHOLD ) {\n\n                        if ( handle.tag === 'fwd' ) {\n\n                            handle.visible = false;\n\n                        } else {\n\n                            handle.scale.z *= - 1;\n\n                        }\n\n                    } else if ( handle.tag === 'bwd' ) {\n\n                        handle.visible = false;\n\n                    }\n\n                }\n\n            } else if ( this.mode === 'rotate' ) {\n\n                // Align handles to current local or world rotation\n\n                tempQuaternion2.copy( quaternion );\n                alignVector.copy( this.eye ).applyQuaternion( tempQuaternion.copy( quaternion ).invert() );\n\n                if ( handle.name.search( 'E' ) !== - 1 ) {\n\n                    handle.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( this.eye, zeroVector, unitY ) );\n\n                }\n\n                if ( handle.name === 'X' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitX, Math.atan2( - alignVector.y, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Y' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitY, Math.atan2( alignVector.x, alignVector.z ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n                if ( handle.name === 'Z' ) {\n\n                    tempQuaternion.setFromAxisAngle( unitZ, Math.atan2( alignVector.y, alignVector.x ) );\n                    tempQuaternion.multiplyQuaternions( tempQuaternion2, tempQuaternion );\n                    handle.quaternion.copy( tempQuaternion );\n\n                }\n\n            }\n\n            // Hide disabled axes\n            handle.visible = handle.visible && ( handle.name.indexOf( 'X' ) === - 1 || this.showX );\n            handle.visible = handle.visible && ( handle.name.indexOf( 'Y' ) === - 1 || this.showY );\n            handle.visible = handle.visible && ( handle.name.indexOf( 'Z' ) === - 1 || this.showZ );\n            handle.visible = handle.visible && ( handle.name.indexOf( 'E' ) === - 1 || ( this.showX && this.showY && this.showZ ) );\n\n            // highlight selected axis\n\n            handle.material._opacity = handle.material._opacity || handle.material.opacity;\n            handle.material._color = handle.material._color || handle.material.color.clone();\n\n            handle.material.color.copy( handle.material._color );\n            handle.material.opacity = handle.material._opacity;\n\n            if ( ! this.enabled ) {\n\n                handle.material.opacity *= 0.5;\n                handle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n            } else if ( this.axis ) {\n\n                if ( handle.name === this.axis ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n                } else if ( this.axis.split( '' ).some( function ( a ) {\n\n                    return handle.name === a;\n\n                } ) ) {\n\n                    handle.material.opacity = 1.0;\n                    handle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n                } else {\n\n                    handle.material.opacity *= 0.25;\n                    handle.material.color.lerp( new Color( 1, 1, 1 ), 0.5 );\n\n                }\n\n            }\n\n        }\n\n        Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsGizmo.prototype = Object.assign( Object.create( Object3D.prototype ), {\n\n    constructor: TransformControlsGizmo,\n\n    isTransformControlsGizmo: true\n\n} );\n\n\nvar TransformControlsPlane = function () {\n\n    'use strict';\n\n    Mesh.call( this,\n        new PlaneGeometry( 100000, 100000, 2, 2 ),\n        new MeshBasicMaterial( { visible: false, wireframe: true, side: DoubleSide, transparent: true, opacity: 0.1, toneMapped: false } )\n    );\n\n    this.type = 'TransformControlsPlane';\n\n    var unitX = new Vector3( 1, 0, 0 );\n    var unitY = new Vector3( 0, 1, 0 );\n    var unitZ = new Vector3( 0, 0, 1 );\n\n    var tempVector = new Vector3();\n    var dirVector = new Vector3();\n    var alignVector = new Vector3();\n    var tempMatrix = new Matrix4();\n    var identityQuaternion = new Quaternion();\n\n    this.updateMatrixWorld = function () {\n\n        var space = this.space;\n\n        this.position.copy( this.worldPosition );\n\n        if ( this.mode === 'scale' ) space = 'local'; // scale always oriented to local rotation\n\n        unitX.set( 1, 0, 0 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\n        unitY.set( 0, 1, 0 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\n        unitZ.set( 0, 0, 1 ).applyQuaternion( space === 'local' ? this.worldQuaternion : identityQuaternion );\n\n        // Align the plane for current transform mode, axis and space.\n\n        alignVector.copy( unitY );\n\n        switch ( this.mode ) {\n\n            case 'translate':\n            case 'scale':\n                switch ( this.axis ) {\n\n                    case 'X':\n                        alignVector.copy( this.eye ).cross( unitX );\n                        dirVector.copy( unitX ).cross( alignVector );\n                        break;\n                    case 'Y':\n                        alignVector.copy( this.eye ).cross( unitY );\n                        dirVector.copy( unitY ).cross( alignVector );\n                        break;\n                    case 'Z':\n                        alignVector.copy( this.eye ).cross( unitZ );\n                        dirVector.copy( unitZ ).cross( alignVector );\n                        break;\n                    case 'XY':\n                        dirVector.copy( unitZ );\n                        break;\n                    case 'YZ':\n                        dirVector.copy( unitX );\n                        break;\n                    case 'XZ':\n                        alignVector.copy( unitZ );\n                        dirVector.copy( unitY );\n                        break;\n                    case 'XYZ':\n                    case 'E':\n                        dirVector.set( 0, 0, 0 );\n                        break;\n\n                }\n\n                break;\n            case 'rotate':\n            default:\n                // special case for rotate\n                dirVector.set( 0, 0, 0 );\n\n        }\n\n        if ( dirVector.length() === 0 ) {\n\n            // If in rotate mode, make the plane parallel to camera\n            this.quaternion.copy( this.cameraQuaternion );\n\n        } else {\n\n            tempMatrix.lookAt( tempVector.set( 0, 0, 0 ), dirVector, alignVector );\n\n            this.quaternion.setFromRotationMatrix( tempMatrix );\n\n        }\n\n        Object3D.prototype.updateMatrixWorld.call( this );\n\n    };\n\n};\n\nTransformControlsPlane.prototype = Object.assign( Object.create( Mesh.prototype ), {\n\n    constructor: TransformControlsPlane,\n\n    isTransformControlsPlane: true\n\n} );\n\nexport { TransformControls, TransformControlsGizmo, TransformControlsPlane };\n","import {useCallback, useEffect, useRef} from \"react\";\nimport hotkeys from \"hotkeys-js\";\n\ntype Options = {\n    scope?: string,\n    element?: HTMLElement | null,\n    keyup?: boolean | null\n    keydown?: boolean | null\n    splitKey?: string;\n}\n\nexport const useHotkeys = (event: string, callback: any, options?: Options) => {\n\n    useEffect(() => {\n        if (options) {\n            hotkeys(event, options, callback)\n        } else {\n            hotkeys(event, callback)\n        }\n\n        return () => {\n            hotkeys.unbind(event, callback)\n        }\n    }, [])\n\n}\n\nexport const useCallbackRef = (cb: () => any, dependencies: any[]) => {\n\n    const callback = useCallback(cb, dependencies)\n    const callbackRef = useRef(callback)\n    useEffect(() => {\n        callbackRef.current = callback\n    }, [callback])\n    return callbackRef\n\n}","import {MutableRefObject, useCallback, useEffect, useRef, useState} from \"react\";\nimport {useThree} from \"react-three-fiber\";\nimport { TransformControls as OriginalTransformControls } from \"three/examples/jsm/controls/TransformControls\";\n// @ts-ignore\nimport { TransformControls as CustomTransformControls } from \"../custom/TransformControls\"\nimport {Object3D, Vector3} from \"three\";\nimport {useHotkeys} from \"../custom/hooks\";\nimport {setComponentPropValue} from \"../editor/state/main/actions\";\nimport {predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {useProxy} from \"valtio\";\nimport {editorStateProxy, EditorTransformMode, useIsEditMode, useTransformMode} from \"../editor/state/editor\";\nimport {EDITOR_LAYER} from \"./InteractiveMesh\";\nimport {isShiftPressed} from \"../editor/hotkeys\";\nimport {storeSnapshot} from \"../editor/state/history/actions\";\n\nconst TransformControls: any = CustomTransformControls\n\nconst recursiveSetLayer = (object: Object3D) => {\n    // if (object.children.length === 0) {\n        object.layers.set(EDITOR_LAYER)\n    // } else {\n        object.children.forEach((child) => recursiveSetLayer(child))\n    // }\n}\n\nexport const useIsCanvasInteractable = () => {\n    return true\n}\n\nexport const useDraggableMesh = (id: string, isSelected: boolean, options: {\n    translationSnap?: number,\n    passedRef?: MutableRefObject<Object3D>,\n    updateValue?: (key: string, value: any, startValue: any) => void,\n    onChange?: () => void,\n    onDraggingChanged?: (event: any) => void,\n} = {}) => {\n    const { camera, gl, scene } = useThree()\n    const isEditMode = useIsEditMode()\n    const localRef = useRef<Object3D>(null!)\n    const ref = options.passedRef ?? localRef\n    const orbitRef = useProxy(editorStateProxy).orbitRef\n    const [controls, setControls] = useState<OriginalTransformControls | null>(null)\n    const isCanvasEnabled = useIsCanvasInteractable()\n    const [shiftIsPressed, setShiftIsPressed] = useState<boolean>(isShiftPressed())\n    const {updateValue, onChange, onDraggingChanged: passedOnDraggingChanged} = options\n\n    useHotkeys('*', () => {\n        setShiftIsPressed(isShiftPressed())\n    }, {\n        keyup: true,\n        keydown: true,\n    })\n\n    useEffect(() => {\n        const callback = () => {\n            setShiftIsPressed(isShiftPressed())\n        }\n        document.addEventListener('keyup', callback)\n        return () => {\n            document.removeEventListener('keyup', callback)\n        }\n    }, [])\n\n    const active = isEditMode && isSelected && isCanvasEnabled\n\n    // @ts-ignore\n    useEffect(() => {\n        if (!controls) return\n        const currentTranslationSnap = controls.translationSnap\n        const currentRotationSnap = controls.rotationSnap\n        if (shiftIsPressed) {\n            controls.setTranslationSnap(1)\n            controls.setRotationSnap(1)\n            return () => {\n                controls.setTranslationSnap(currentTranslationSnap)\n                controls.setRotationSnap(currentRotationSnap)\n            }\n        }\n    }, [shiftIsPressed, controls])\n\n    const startPositionRef = useRef(new Vector3())\n\n    useEffect(() => {\n        if (!orbitRef || !controls) return\n        const onDraggingChanged = (event: any) => {\n            startPositionRef.current.copy(ref.current.position)\n            editorStateProxy.transformActive = event.value\n            if (orbitRef.current) {\n                orbitRef.current.enabled = !event.value\n            }\n            if (passedOnDraggingChanged) {\n                passedOnDraggingChanged(event)\n            }\n        }\n\n        controls.addEventListener('dragging-changed', onDraggingChanged)\n        if (onChange) {\n            controls.addEventListener('change', onChange)\n        }\n        return () => {\n            editorStateProxy.transformActive = false\n            if (orbitRef.current) {\n                orbitRef.current.enabled = true\n            }\n            if (onChange) {\n                controls.removeEventListener('change', onChange)\n            }\n            controls.removeEventListener('dragging-changed', onDraggingChanged)\n        }\n    }, [orbitRef, controls])\n\n    const transformMode = useTransformMode()\n\n    const onMouseUp = useCallback(() => {\n        if (!ref.current) return\n        storeSnapshot()\n        console.log('MOUSE UP!')\n\n        if (transformMode === EditorTransformMode.translate) {\n            const {x, y, z} = ref.current.position\n            const update = {\n                x,\n                y,\n                z\n            }\n            if (updateValue) {\n                updateValue(predefinedPropKeys.position, update, startPositionRef.current)\n            } else {\n                setComponentPropValue(id, predefinedPropKeys.position, {\n                    x,\n                    y,\n                    z,\n                })\n            }\n        } else if (transformMode === EditorTransformMode.rotate) {\n            const {x, y, z} = ref.current.rotation\n            const update = {\n                x,\n                y,\n                z\n            }\n            if (updateValue) {\n                updateValue(predefinedPropKeys.rotation, update, startPositionRef.current)\n            } else {\n                setComponentPropValue(id, predefinedPropKeys.rotation, {\n                    x,\n                    y,\n                    z,\n                })\n            }\n        } else if (transformMode === EditorTransformMode.scale) {\n            const {x, y, z} = ref.current.scale\n            const update = {\n                x,\n                y,\n                z\n            }\n            if (updateValue) {\n                updateValue(predefinedPropKeys.scale, update, startPositionRef.current)\n            } else {\n                setComponentPropValue(id, predefinedPropKeys.scale, {\n                    x,\n                    y,\n                    z,\n                })\n            }\n        }\n\n    }, [transformMode])\n\n    const onMouseUpRef = useRef(onMouseUp)\n\n    useEffect(() => {\n        onMouseUpRef.current = onMouseUp\n    }, [onMouseUp])\n\n    useEffect(() => {\n\n        if (!active) return\n        if (!ref.current) return\n        const controls = new TransformControls(camera, gl.domElement)\n        const {translationSnap} = options\n        if (translationSnap != undefined) {\n            controls.setTranslationSnap(translationSnap)\n        }\n        controls.raycaster.layers.enable(EDITOR_LAYER)\n        recursiveSetLayer(controls)\n        setControls(controls)\n        controls.attach(ref.current as Object3D)\n        controls.addEventListener('mouseUp', () => {\n\n            onMouseUpRef.current()\n\n        })\n        scene.add(controls)\n\n        return () => {\n            controls.detach()\n            scene.remove(controls)\n            setControls(null)\n        }\n\n    }, [active])\n\n    useEffect(() => {\n        controls?.setMode(transformMode)\n    }, [controls, transformMode])\n\n    return [ref]\n}","import React, {MutableRefObject, useEffect, useMemo, useRef, useState} from \"react\"\nimport {useEditableProp} from \"./useEditableProp\";\nimport {predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {setComponentHovered} from \"../editor/state/ui\";\nimport {useEditableContext, useEditableId, useEditableIsSoleSelected, useIsEditableSelected} from \"./Editable\";\nimport {setSelectedComponents} from \"../editor/state/main/actions\";\nimport {BoxHelper, Object3D} from \"three\";\nimport {useHelper} from \"@react-three/drei\";\nimport {isCommandPressed, isShiftPressed} from \"../editor/hotkeys\";\nimport {useDraggableMesh} from \"./useDraggableMesh\";\nimport {editorStateProxy, useGroupPortalRef, useIsEditMode} from \"../editor/state/editor\";\nimport {ref} from \"valtio\";\n\nexport const EDITOR_LAYER = 31\n\nexport const useMeshHelper = (ref: MutableRefObject<Object3D>, active: boolean) => {\n    const helperToUse = useMemo(() => {\n        if (active) {\n            return BoxHelper\n        }\n        return null\n    }, [active])\n\n\n    const helperRef = useHelper(ref, helperToUse)\n\n    useEffect(() => {\n        if (helperRef.current) {\n            helperRef.current?.layers.set(EDITOR_LAYER)\n        }\n    })\n}\n\nexport const InteractiveMesh: React.FC = ({children}) => {\n    const id = useEditableId()\n    const {parentPath} = useEditableContext()\n    const isSelected = useIsEditableSelected()\n    const isSoleSelected = useEditableIsSoleSelected()\n    const isMultipleSelected = isSelected && !isSoleSelected\n    const groupPortalRef = useGroupPortalRef()\n    const {setSharedProp} = useEditableContext()\n\n    useEffect(() => {\n        if (!isMultipleSelected || !groupPortalRef) return\n        const parent = groupRef.current.parent\n        parent?.remove(groupRef.current)\n        groupPortalRef.current.add(groupRef.current)\n        return () => {\n            groupPortalRef.current.remove(groupRef.current)\n            parent?.add(groupRef.current)\n        }\n    }, [isMultipleSelected, groupPortalRef])\n\n    const position = useEditableProp(predefinedPropKeys.position, {\n        defaultValue: {\n            x: 0,\n            y: 0,\n            z: 0,\n        }\n    })\n    const rotation = useEditableProp(predefinedPropKeys.rotation, {\n        defaultValue: {\n            x: 0,\n            y: 0,\n            z: 0,\n        }\n    })\n    const scale = useEditableProp(predefinedPropKeys.scale, {\n        defaultValue: {\n            x: 1,\n            y: 1,\n            z: 1,\n        }\n    })\n\n    const [pointerOver, setPointerOver] = useState(false)\n    const isEditMode = useIsEditMode()\n\n    useEffect(() => {\n        if (pointerOver) {\n            return setComponentHovered(id)\n        }\n        return\n    }, [pointerOver, id])\n\n    const {\n        onPointerUp,\n        onPointerOver,\n        onPointerOut,\n    } = useMemo(() => ({\n        onPointerUp: (event: any) => {\n            if (!isEditMode) return\n            let skip = false\n            event.intersections.forEach(({eventObject}: any) => {\n                const eventObjectId = eventObject.userData.id\n                if (eventObjectId !== id && parentPath.includes(eventObjectId)) {\n                    skip = true\n                }\n            })\n            if (skip) {\n                return\n            }\n            event.stopPropagation()\n            const add = isShiftPressed() || isCommandPressed()\n            if (editorStateProxy.transformActive) return\n            setSelectedComponents({\n                [id]: true,\n            }, !add)\n        },\n        onPointerOver: (event: any) => {\n            if (!isEditMode) return\n            event.stopPropagation()\n            if (editorStateProxy.transformActive) return\n            setPointerOver(true)\n        },\n        onPointerOut: (event: any) => {\n            if (!isEditMode) return\n            event.stopPropagation()\n            setPointerOver(false)\n        },\n    }), [isEditMode, parentPath])\n\n    const groupRef = useRef<Object3D>(null!)\n\n    useMeshHelper(groupRef, (isSelected || pointerOver) && isEditMode)\n    useDraggableMesh(id, isSoleSelected, {\n        passedRef: groupRef,\n    })\n\n    useEffect(() => {\n        if (isSoleSelected) {\n            const storedRef = ref(groupRef)\n            editorStateProxy.selectedRef = storedRef\n            return () =>{\n                if (editorStateProxy.selectedRef === storedRef) {\n                    editorStateProxy.selectedRef = null\n                }\n            }\n        }\n        return\n    }, [isSoleSelected])\n\n    useEffect(() => {\n        setSharedProp('meshRef', groupRef)\n    }, [setSharedProp, groupRef])\n\n    const firstCallRef = useRef(true)\n\n    useEffect(() => {\n        if (!isEditMode && !firstCallRef.current) return\n        firstCallRef.current = false\n        groupRef.current.position.set(position.x, position.y, position.z)\n        groupRef.current.rotation.set(rotation.x, rotation.y, rotation.z)\n        groupRef.current.scale.set(scale.x, scale.y, scale.z)\n    }, [isEditMode, position, rotation, scale])\n\n    const content = (\n        <group ref={groupRef}\n               onPointerUp={onPointerUp}\n               onPointerOver={onPointerOver}\n               onPointerOut={onPointerOut} userData={{\n                   id,\n                }}>\n            {children}\n        </group>\n    )\n\n    return content\n}","import React, {createContext, useCallback, useContext, useEffect, useLayoutEffect, useMemo, useState} from \"react\";\nimport {\n    addComponent,\n    addDeactivatedComponent, removeComponent,\n    removeDeactivatedComponent,\n    setComponentChildren, setComponentInitialProps\n} from \"../editor/state/components/store\";\nimport {useIsDeactivated, useSelectedComponents} from \"../editor/state/main/hooks\";\nimport {setComponentProps} from \"../editor/state/props\";\nimport {EditableModules} from \"./EditableModules\";\nimport {getCombinedId} from \"../utils/ids\";\nimport {InteractiveMesh} from \"./InteractiveMesh\";\n\ninterface Config {\n    name?: string,\n    _unsaved?: boolean,\n    type?: string,\n}\n\nconst getComponentId = (config: Config) => {\n    if (config.type) return config.type\n    return ''\n}\n\ninterface Props {\n    id: string,\n    _config?: Config,\n    [key: string]: any,\n}\n\ninterface ContextInterface {\n    id: string,\n    componentTypeId: string,\n    isRoot: boolean,\n    parentPath: string[],\n    parentId: string,\n    rootParentId: string,\n    registerWithParent: (id: string) => () => void,\n    isSelected: {\n        selected: boolean,\n        single?: boolean,\n    },\n    sharedProps: {\n        [key: string]: any,\n    },\n    setSharedProp: (key: string, value: any) => void,\n}\n\nconst Context = createContext<ContextInterface>({\n    id: '',\n    componentTypeId: '',\n    isRoot: true,\n    parentId: '',\n    rootParentId: '',\n    parentPath: [],\n    registerWithParent: () => () => {\n    },\n    isSelected: {\n        selected: false,\n    },\n    sharedProps: {},\n    setSharedProp: () => {},\n})\n\nexport const useEditableContext = () => {\n    return useContext(Context)\n}\n\nexport const useEditableSharedProp = (key: string) => {\n    const {sharedProps} = useEditableContext()\n    return sharedProps[key]\n}\n\nexport const useIsEditableSelected = () => {\n    const {isSelected} = useEditableContext()\n    return isSelected.selected\n}\n\nexport const useEditableIsSoleSelected = () => {\n    const {isSelected} = useEditableContext()\n    return (isSelected.selected && isSelected.single) ?? false\n}\n\nexport const useEditableId = () => {\n    const {id} = useEditableContext()\n    return id\n}\n\nconst useIsSelected = (id: string) => {\n    const selectedComponents = useSelectedComponents()\n    return useMemo(() => {\n        if (Object.keys(selectedComponents).includes(id)) {\n            const single = (Object.keys(selectedComponents).length === 1)\n            return {\n                selected: true,\n                single,\n            }\n        }\n        return {\n            selected: false,\n        }\n    }, [id, selectedComponents])\n}\n\nexport const Editable: React.FC<Props> = ({\n                                              children,\n                                              id,\n                                              _config: config = {},\n                                                ...props\n                                          }) => {\n\n    const {\n        isRoot,\n        parentPath,\n        registerWithParent,\n        parentId,\n        rootParentId\n    } = useEditableContext()\n\n    const [name] = useState(() => config?.name || (children ? (children as any).type.displayName || (children as any).type.name || id : id))\n    const [uid] = useState(() => {\n        return getCombinedId(parentPath.concat([id]))\n    })\n    const [componentId] = useState(() => getComponentId(config))\n\n    const isSelected = useIsSelected(uid)\n    const isSoleSelected = useMemo(() => {\n        return isSelected.selected && isSelected.single\n    }, [isSelected])\n\n    useEffect(() => {\n        if (!isSoleSelected) return\n        return () => {\n            setComponentProps(uid, () => ({}))\n        }\n    }, [isSoleSelected])\n\n    useLayoutEffect(() => {\n        registerWithParent(uid)\n    }, [])\n\n    useLayoutEffect(() => {\n        setComponentInitialProps(uid, props)\n    }, [props])\n\n    const [childEditables, setChildEditables] = useState<{\n        [id: string]: true,\n    }>({})\n\n    const {\n        registerChildren\n    } = useMemo(() => ({\n        registerChildren: (childId: string) => {\n            setChildEditables(state => ({\n                ...state,\n                [childId]: true,\n            }))\n            return () => {\n                setChildEditables(state => {\n                    const updated = {\n                        ...state,\n                    }\n                    delete updated[childId]\n                    return updated\n                })\n            }\n        },\n    }), [])\n\n    const isDeactivated = useIsDeactivated(uid)\n    const unsaved = config._unsaved ?? false\n\n    useEffect(() => {\n        if (isDeactivated) {\n            addDeactivatedComponent(uid, name, Object.keys(childEditables), isRoot, unsaved, parentId, rootParentId)\n            return () => {\n                removeDeactivatedComponent(uid)\n            }\n        } else {\n            addComponent(uid, name, Object.keys(childEditables), isRoot, unsaved, props, componentId, parentId, rootParentId)\n            return () => {\n                removeComponent(uid)\n            }\n        }\n    }, [isDeactivated])\n\n    useEffect(() => {\n        if (!isDeactivated) {\n            setComponentChildren(uid, Object.keys(childEditables))\n        }\n    }, [childEditables, isDeactivated])\n\n    const updatedParentPath = useMemo(() => {\n        return parentPath.concat(id)\n    }, [parentPath])\n\n    const [sharedProps, setSharedProps] = useState<{\n        [key: string]: any,\n    }>({})\n\n    const setSharedProp = useCallback((key: string, value: any) => {\n        setSharedProps(state => ({\n            ...state,\n            [key]: value,\n        }))\n    }, [setSharedProps])\n\n    if (isDeactivated) return null\n\n    return (\n        <Context.Provider value={{\n            id: uid,\n            componentTypeId: componentId,\n            isRoot: false,\n            parentId: uid,\n            rootParentId: isRoot ? uid : rootParentId,\n            parentPath: updatedParentPath,\n            registerWithParent: registerChildren,\n            isSelected,\n            sharedProps,\n            setSharedProp,\n        }}>\n            <InteractiveMesh>\n                <EditableModules>\n                    {children}\n                </EditableModules>\n            </InteractiveMesh>\n        </Context.Provider>\n    );\n};","import {useEditableContext, useEditableIsSoleSelected, useEditableSharedProp} from \"./Editable\";\nimport {useLayoutEffect, useMemo, useState} from \"react\";\nimport {useComponentInitialProps} from \"../editor/state/components/hooks\";\nimport {Prop, PropOrigin, setComponentProps} from \"../editor/state/props\";\nimport {useComponentState, useSharedComponent} from \"../editor/state/main/hooks\";\nimport {predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {setComponentCanHaveChildren} from \"../editor/state/components/store\";\n\ninterface Config {\n    id?: string,\n    defaultValue?: any,\n    hidden?: boolean,\n    sync?: boolean,\n}\n\nconst useProp = (key: string, componentId: string, componentTypeId: string, defaultValue: any, hidden: boolean): Prop => {\n    const initialProps = useComponentInitialProps(componentId)\n    const {modifiedState = {}, overriddenState = {}} = useComponentState(componentId)\n    const {appliedState = {}} = useSharedComponent(componentTypeId)\n\n    return useMemo(() => {\n        const applied = appliedState[key]\n        const appliedValue = applied?.value\n\n        const defaultResult = {\n            hidden,\n        }\n\n        const appliedResult = {\n            ...defaultResult,\n            value: appliedValue,\n            type: PropOrigin.applied,\n        }\n\n        if (modifiedState[key] && !overriddenState[key]) {\n            const modifiedValue = modifiedState[key].value\n            if (modifiedValue !== appliedValue) {\n                return {\n                    ...defaultResult,\n                    value: modifiedValue,\n                    type: PropOrigin.modified,\n                }\n            } else {\n                return appliedResult\n            }\n        }\n        if (initialProps[key] && !overriddenState[key]) {\n            const initialValue = initialProps[key]\n            if (initialValue !== appliedValue) {\n                return {\n                    ...defaultResult,\n                    value: initialProps[key],\n                    type: PropOrigin.initial,\n                }\n            } else {\n                return appliedResult\n            }\n        }\n        if (applied) {\n            return appliedResult\n        }\n        return {\n            ...defaultResult,\n            value: defaultValue,\n            type: PropOrigin.default,\n        }\n    }, [initialProps, modifiedState, overriddenState, appliedState, defaultValue])\n}\n\nexport const useEditableProp = (key: string, config: Config = {}) => {\n    const {\n        id: editableId,\n        componentTypeId,\n        setSharedProp\n    } = useEditableContext()\n    const {hidden = false} = config\n    const isSelected = useEditableIsSoleSelected()\n    const [id] = useState(() => config.id ? config.id : editableId)\n    const {sync = false} = config\n\n    const sharedProp = useEditableSharedProp(key)\n\n    const prop = useProp(key, id, componentTypeId, config.defaultValue, hidden)\n\n    useLayoutEffect(() => {\n        if (key === predefinedPropKeys.children) {\n            return setComponentCanHaveChildren(id)\n        }\n        return\n    }, [])\n\n    useLayoutEffect(() => {\n        if (!isSelected) return\n        setComponentProps(editableId, (state) => {\n            return {\n                ...state,\n                [key]: prop,\n            }\n        })\n    }, [isSelected, prop])\n\n    const {value} = prop\n\n    useLayoutEffect(() => {\n        if (!sync) return\n        setSharedProp(key, value)\n    }, [sync])\n\n    return (!sync && sharedProp) ? sharedProp : prop.value\n}","import React, {useMemo} from \"react\"\nimport {useUnsavedComponent, useUnsavedComponents} from \"../editor/state/main/hooks\";\nimport {ComponentState} from \"../editor/state/components/types\";\nimport {Editable} from \"./Editable\";\nimport {useAddable} from \"./addables\";\n\nconst UnsavedComponent: React.FC<{\n    component: ComponentState\n}> = ({component}) => {\n    const addable = useAddable(component.componentId ?? '')\n    const Component = useMemo(() => {\n        return addable?.component\n    }, [addable])\n    if (!addable) return null\n    const props = component.initialProps ?? {}\n    return (\n        <Editable id={component.uid} _config={{\n            name: component.name,\n            type: addable.sharedType ? component.componentId : '',\n            _unsaved: true,\n        }} {...props}>\n            {Component && <Component/>}\n        </Editable>\n    )\n}\n\nconst TemporaryComponent: React.FC<{\n    id: string,\n}> = ({id}) => {\n    const component = useUnsavedComponent(id)\n    if (!component) return null\n    return <UnsavedComponent component={component}/>\n}\n\nexport const TemporaryComponentsList: React.FC<{\n    ids: string[],\n}> = ({ids}) => {\n    return (\n        <>\n            {\n                ids.map((id) => (\n                    <TemporaryComponent id={id} key={id}/>\n                ))\n            }\n        </>\n    )\n}\n\nexport const TemporaryComponents: React.FC = () => {\n    const unsavedComponents = useUnsavedComponents()\n    return (\n        <>\n            {\n                Object.entries(unsavedComponents).map(([key, component]) => {\n                    if (!component.isRoot) return null\n                    return (\n                        <UnsavedComponent key={key} component={component}/>\n                    )\n                })\n            }\n        </>\n    )\n}","import React from \"react\"\nimport {useEditableProp} from \"./useEditableProp\";\nimport {predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {TemporaryComponentsList} from \"./TemporaryComponents\";\n\nexport const EditableChildren: React.FC = ({children}) => {\n\n    const storedChildren = useEditableProp(predefinedPropKeys.children, {\n        defaultValue: [],\n        hidden: true,\n    }) ?? []\n\n    return (\n        <>\n            {children}\n            {\n                storedChildren && (\n                    <TemporaryComponentsList ids={storedChildren}/>\n                )\n            }\n        </>\n    )\n}","import React from \"react\"\nimport {EditableChildren} from \"../EditableChildren\";\n\nexport const EmptyObject: React.FC = () => {\n\n    return (\n        <EditableChildren/>\n    )\n}","import create from \"zustand\";\nimport {EmptyObject} from \"./defaultComponents/EmptyObject\";\n\nexport interface Addable {\n    id: string,\n    name: string,\n    props: {\n        [key: string]: any,\n    },\n    component: any,\n    sharedType: boolean,\n}\n\nexport const useAddableStore = create<{\n    addables: {\n        [key: string]: Addable,\n    }\n}>(() => ({\n    addables: {},\n}))\n\nexport const useAddable = (id: string) => {\n    return useAddableStore(state => state.addables[id])\n}\n\nexport const getAddable = (id: string) => {\n    return useAddableStore.getState().addables[id]\n}\n\nexport const registerAddable = (id: string, component: any, {\n    name,\n    sharedType = true,\n    props = {},\n}: {\n    name: string,\n    sharedType?: boolean,\n    props?: {\n        [key: string]: any,\n    }\n}) => {\n    const preppedId = `_addable/${id}`\n    useAddableStore.setState(state => ({\n        addables: {\n            ...state.addables,\n            [preppedId]: {\n                id: preppedId,\n                name,\n                props,\n                component,\n                sharedType,\n            }\n        }\n    }))\n}\n\nregisterAddable('_emptyObject', EmptyObject, {\n    name: 'Empty Object',\n    sharedType: false,\n    props: {}\n})","import {proxy, useProxy} from \"valtio\";\nimport {getAddable} from \"../../scene/addables\";\nimport {addUnsavedComponent, setSelectedComponents} from \"./main/actions\";\nimport {predefinedPropKeys} from \"../componentEditor/config\";\n\nexport const uiProxy = proxy<{\n    displayAddingComponent: boolean,\n    displayAddingComponentParent: string,\n    addingComponent: string,\n    addingComponentParent: string,\n    componentContextMenu: {\n        visible: boolean,\n        components?: string[],\n        position?: [number, number],\n    },\n    hoveredComponents: {\n        [key: string]: true,\n    }\n}>({\n    displayAddingComponent: false,\n    displayAddingComponentParent: '',\n    addingComponent: '',\n    addingComponentParent: '',\n    componentContextMenu: {\n        visible: false,\n        components: [],\n    },\n    hoveredComponents: {}\n})\n\nexport const useAddingComponent = () => {\n    return useProxy(uiProxy).addingComponent\n}\n\nexport const addComponent = (addableId: string, parent: string, position?: {x: number, y: number, z: number}) => {\n    console.log('position', position)\n    const addable = getAddable(addableId)\n    const id = addUnsavedComponent(addable, parent, {\n        [predefinedPropKeys.position]: position,\n    })\n    setSelectedComponents({\n        [id]: true,\n    })\n}\n\nexport const addStoredComponent = (position: {x: number, y: number, z: number}) => {\n    addComponent(uiProxy.addingComponent, uiProxy.addingComponentParent, position)\n    uiProxy.addingComponent = ''\n    uiProxy.addingComponentParent = ''\n}\n\nexport const setComponentHovered = (id: string) => {\n    uiProxy.hoveredComponents = {\n        ...uiProxy.hoveredComponents,\n        [id]: true,\n    }\n    return () => {\n        const update = {\n            ...uiProxy.hoveredComponents,\n        }\n        delete update[id]\n        uiProxy.hoveredComponents = update\n    }\n}\n\nexport const useIsComponentHovered = (id: string) => {\n    const hoveredComponents = useProxy(uiProxy).hoveredComponents\n    return hoveredComponents[id] ?? false\n}\n\nexport const displayComponentContextMenu = (components: string[], position: [number, number]) => {\n    uiProxy.componentContextMenu = {\n        visible: true,\n        components,\n        position,\n    }\n}\n\nexport const setDisplayAddingComponentParent = (id: string) => {\n    uiProxy.displayAddingComponentParent = id\n}\n\nexport const setAddingComponent = (id: string) => {\n    uiProxy.addingComponent = id\n    uiProxy.addingComponentParent = uiProxy.displayAddingComponentParent\n}\n\nexport const setDisplayAddingComponent = (adding: boolean, parent: string = '') => {\n    if (adding) {\n        setDisplayAddingComponentParent(parent)\n    }\n    uiProxy.displayAddingComponent = adding\n    if (!adding) {\n        addingComponentClosed = Date.now()\n    }\n}\n\nexport let addingComponentClosed = 0","import {Shortcuts} from 'shortcuts';\nimport {ShortcutDescriptor} from \"shortcuts/src/types\";\nimport {useEffect} from \"react\";\n\nconst shortcutsManager = new Shortcuts()\n\nexport const registerShortcut = (shortcuts: ShortcutDescriptor | ShortcutDescriptor[], manager?: Shortcuts) => {\n    if (!manager) {\n        manager = shortcutsManager\n    }\n\n    manager.add(shortcuts)\n\n    return () => {\n        manager?.remove(shortcuts)\n    }\n}\n\nexport const useShortcut = (shortcuts: ShortcutDescriptor | ShortcutDescriptor[], manager?: Shortcuts) => {\n\n    useEffect(() => {\n        return registerShortcut(shortcuts, manager)\n    }, [])\n\n}","import React from \"react\"\nimport {useShortcut} from \"./shortcuts\";\nimport {copySelectedComponents, deleteSelectedComponents} from \"./state/main/actions\";\n\nexport const SelectedComponentListeners: React.FC = () => {\n\n    useShortcut([\n        {\n            shortcut: 'Backspace',\n            handler: () => {\n                deleteSelectedComponents()\n            }\n        },\n        {\n            shortcut: 'Delete',\n            handler: () => {\n                deleteSelectedComponents()\n            }\n        }, {\n            shortcut: 'CmdOrCtrl+C',\n            handler: () => {\n                copySelectedComponents()\n            }\n        }])\n\n    return null\n}","// @ts-nocheck\nimport React, {useCallback, useEffect, useMemo, useRef, useState} from \"react\"\nimport Tree, {\n    ItemId,\n    moveItemOnTree,\n    mutateTree,\n    RenderItemParams,\n    TreeData,\n    TreeDestinationPosition,\n    TreeSourcePosition,\n} from '@atlaskit/tree';\nimport {styled} from \"./ui/sitches.config\"\nimport {FaCaretDown, FaCaretUp, FaCube, FaFolder, FaFolderOpen, FaPlus} from \"react-icons/fa\";\nimport {\n    deleteComponent, setComponentName,\n    setComponentsTree, setComponentTreeItemExpanded, setGroupName,\n    setSelectedComponents, updateComponentLocation,\n    updateSelectedComponents\n} from \"./state/main/actions\";\nimport {useComponentName, useSelectedComponents} from \"./state/main/hooks\";\nimport {useComponentsStore} from \"./state/components/store\";\nimport {ComponentState} from \"./state/components/types\";\nimport {getMainStateStoreState, useMainStateStore} from \"./state/main/store\";\nimport {sortBy} from \"lodash-es\";\nimport {useComponent, useComponentCanHaveChildren} from \"./state/components/hooks\";\nimport {isCommandPressed, isShiftPressed} from \"./hotkeys\";\nimport {getSelectedComponents} from \"./state/main/getters\";\nimport {TreeItem} from \"@atlaskit/tree/types\";\nimport hotkeys from \"hotkeys-js\";\nimport {displayComponentContextMenu, setDisplayAddingComponent, useIsComponentHovered} from \"./state/ui\";\nimport {VIEWS} from \"./ManagerSidebar\";\nimport {MainStateStore} from \"./state/main/types\";\nimport {SelectedComponentListeners} from \"./SelectedComponentListeners\";\n\nexport const useIsItemSelected = (id: string) => {\n    const selectedComponents = Object.keys(useSelectedComponents())\n    return selectedComponents.includes(id)\n}\n\nenum TreeItemType {\n    group = 'group',\n    component = 'component',\n}\n\nexport enum SceneItemIcon {\n    group = 'group',\n    groupClosed = 'groupClosed',\n    component = 'component'\n}\n\nexport const ROOT_ID = '__root'\n\nconst generateTree = (components: {\n    [key: string]: ComponentState,\n}, groups: MainStateStore['groups'], groupedComponents: MainStateStore['groupedComponents'], showActive: boolean): TreeData => {\n    const items = {}\n    const rootChildren: string[] = []\n    const groupsChildren: {\n        [key: string]: string[]\n    } = {}\n    Object.entries(groups).forEach(([groupId, group]) => {\n        items[groupId] = {\n            id: groupId,\n            children: [],\n            data: {\n                children: [],\n                title: group.name,\n                type: TreeItemType.group,\n            }\n        }\n        if (groupedComponents[groupId]) {\n            const parentGroupId = groupedComponents[groupId]\n            if (groupsChildren[parentGroupId]) {\n                groupsChildren[parentGroupId].push(groupId)\n            } else {\n                groupsChildren[parentGroupId] = [groupId]\n            }\n        } else {\n            rootChildren.push(groupId)\n        }\n    })\n    Object.entries(groupsChildren).forEach(([groupId, children]) => {\n        if (items[groupId]) {\n            items[groupId].children = items[groupId].children.concat(children)\n            items[groupId].data.children = items[groupId].children\n        }\n    })\n    Object.entries(components).forEach(([id, component]) => {\n        items[id] = {\n            id,\n            children: [],\n            data: {\n                children: component.children,\n                title: component.name,\n                type: TreeItemType.component,\n            }\n        }\n        if (component.isRoot) {\n            if (groupedComponents[id]) {\n                const groupId = groupedComponents[id]\n                if (items[groupId]) {\n                    items[groupId].children.push(id)\n                    items[groupId].data.children = items[groupId].children\n                }\n            } else {\n                rootChildren.push(id)\n            }\n        }\n    })\n    items[ROOT_ID] = {\n        id: ROOT_ID,\n        children: rootChildren,\n    }\n    const componentsTree = showActive ? getMainStateStoreState().componentsTree : {}\n    Object.values(items).forEach((item) => {\n        if (componentsTree[item.id]) {\n            const treeItem = componentsTree[item.id]\n            const last = item.children.length;\n            const sortedChildren = sortBy(item.children, (child) => {\n                return treeItem.children.indexOf(child) !== -1 ? treeItem.children.indexOf(child) : last;\n            })\n            item.children = sortedChildren\n            item.isExpanded = treeItem.isExpanded\n        }\n    })\n    return {\n        rootId: ROOT_ID,\n        items: items,\n    }\n}\n\nconst useSceneTree = (showActive: boolean): TreeData => {\n\n    const activeComponents = useComponentsStore(state => state.components)\n    const deactivatedComponents = useComponentsStore(state => state.deactivatedComponents)\n    const groups = useMainStateStore(state => state.groups)\n    const groupedComponents = useMainStateStore(state => state.groupedComponents)\n\n    const components = showActive ? activeComponents : deactivatedComponents\n\n    const [tree, setTree] = useState<TreeData>(() => generateTree(components, groups, groupedComponents, showActive))\n\n    useEffect(() => {\n        setTree(generateTree(components, groups, groupedComponents, showActive))\n    }, [components, groups, groupedComponents])\n\n    return [tree, setTree]\n}\n\nexport const ItemIcon: React.FC<{\n    iconType: SceneItemIcon\n}> = ({iconType}) => {\n    if (iconType === SceneItemIcon.group) {\n        return <FaFolderOpen size={11}/>\n    } else if (iconType === SceneItemIcon.groupClosed) {\n        return <FaFolder size={11}/>\n    }\n    return <FaCube size={11}/>\n}\n\nconst sidePadding = 12\n\nconst StyledChildrenContainer = styled('div', {\n    paddingLeft: `${sidePadding}px`,\n})\n\nconst useItemData = (id: string) => {\n    const component = useComponent(id)\n    return component\n}\n\nconst SceneChild: React.FC<{\n    id: string,\n}> = ({id}) => {\n    const data = useItemData(id)\n    if (!data) return null\n    return (\n        <SceneItem id={id} icon={<ItemIcon iconType={SceneItemIcon.component}/>} draggable={false} name={data.name}/>\n    )\n}\n\nconst useChildren = (id: string) => {\n\n    const component = useComponent(id)\n\n    return component?.children ?? []\n\n}\n\nconst SceneChildren: React.FC<{\n    id: string,\n}> = ({id}) => {\n    const children = useChildren(id)\n    return (\n        <StyledChildrenContainer>\n            {\n                children.map((childId) => (\n                    <SceneChild id={childId} key={childId}/>\n                ))\n            }\n        </StyledChildrenContainer>\n    )\n}\n\nconst StyledDraggableContainer = styled('div', {\n    padding: '1px $1b',\n})\n\nconst StyledWrapper = styled('div', {\n    position: 'relative',\n})\n\nconst StyledInputWrapper = styled('div', {\n    position: 'absolute',\n    top: '0',\n    left: '30px',\n    right: '40px',\n    bottom: '0',\n    display: 'flex',\n    alignItems: 'center',\n})\n\nexport const StyledButton = styled('button', {\n    padding: 0,\n    margin: 0,\n    border: 0,\n    font: 'inherit',\n    color: 'inherit',\n    backgroundColor: 'transparent',\n})\n\nexport const StyledClickable = styled(StyledButton, {\n    display: 'grid',\n    alignItems: 'center',\n    width: '100%',\n    gridTemplateColumns: 'auto 1fr auto',\n    columnGap: '$1b',\n    padding: '$1b',\n    borderRadius: '$2',\n    cursor: 'pointer',\n    textAlign: 'left',\n    transition: 'background 250ms ease, border 250ms ease, color 250ms ease',\n    '&:hover': {\n        backgroundColor: 'rgba(0,0,0,0.25)'\n    },\n    '&:focus': {\n        outline: 'none',\n        boxShadow: '0 0 0 2px $pink',\n    },\n    variants: {\n        appearance: {\n            hovered: {\n                backgroundColor: 'rgba(0,0,0,0.25)'\n            },\n            selected: {\n                color: '$white',\n                backgroundColor: '$purple',\n                '&:hover': {\n                    backgroundColor: '$purple',\n                }\n            }\n        }\n    }\n})\n\nconst StyledRound = styled('div', {\n    width: '22px',\n    height: '22px',\n    borderRadius: '50%',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    transition: 'all 250ms ease',\n})\n\nexport const StyledIcon: any = styled(StyledRound, {\n    border: '2px solid transparent',\n\n    variants: {\n        appearance: {\n            clickable: {\n                '&:hover': {\n                    borderColor: '$purple',\n                    backgroundColor: '$purple',\n                    color: '$white',\n                },\n            }\n        },\n        style: {\n            interactive: {\n                [`${StyledClickable}:hover &`]: {\n                    borderColor: '$darkPurple',\n                },\n                '&:hover': {\n                    borderColor: '$purple',\n                    color: '$white',\n                },\n            }\n        }\n    }\n})\n\nconst StyledTrash = styled(StyledIcon, {\n    opacity: 0,\n    [`${StyledClickable}:hover &`]: {\n        opacity: 1,\n    },\n    [`&:hover`]: {\n        opacity: 1,\n    },\n    variants: {\n        style: {\n            interactive: {\n                [`${StyledClickable}:hover &`]: {\n                    borderColor: '$darkPurple',\n                },\n                [`&:hover`]: {\n                    borderColor: '$purple',\n                    backgroundColor: '$purple',\n                    color: '$white',\n                },\n            }\n        }\n    }\n})\n\nconst StyledToggleIcon = styled('span', {\n    display: 'inline-flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    padding: '2px',\n    marginLeft: '2px',\n    '&:hover': {\n        color: '$white',\n    }\n})\n\nconst StyledOptions = styled('div', {\n    display: 'flex',\n    alignItems: 'center',\n})\n\nlet lastSelectedItem: string = ''\n\nconst setLastSelectedItem = (id: string) => {\n    lastSelectedItem = id\n}\n\nconst selectItem = (id: string) => {\n    setSelectedComponents({\n        [id]: true,\n    })\n}\n\nconst addChildrenToRange = (item: TreeItem, range: string[], tree: TreeData) => {\n    item.children.forEach((childId) => {\n        range.push(childId)\n        const childItem = tree.items[childId]\n        if (childItem) {\n            addChildrenToRange(childItem, range, tree)\n        }\n    })\n    if (item.data.children) {\n        item.data.children.forEach((childId) => {\n            range.push(childId)\n            const childItem = tree.items[childId]\n            if (childItem) {\n                addChildrenToRange(childItem, range, tree)\n            }\n        })\n    }\n}\n\nconst getOrderedRange = () => {\n    const {components} = useComponentsStore.getState()\n    const {groups, groupedComponents} = getMainStateStoreState()\n    const tree = generateTree(components, groups, groupedComponents, true)\n    const root = tree.items[tree.rootId]\n    const range: string[] = []\n    root.children.forEach((id) => {\n        range.push(id)\n        const item = tree.items[id]\n        if (!item) return\n        addChildrenToRange(item, range, tree)\n    })\n    return range\n}\n\nconst selectRange = (id: string) => {\n    const orderedRange = getOrderedRange()\n    if (!lastSelectedItem) {\n        const selectedComponents = Object.keys(getSelectedComponents())\n        const last = selectedComponents.length;\n        const sorted = sortBy(selectedComponents, (child) => {\n            return orderedRange.indexOf(child) !== -1 ? orderedRange.indexOf(child) : last;\n        })\n        lastSelectedItem = sorted[0]\n    }\n    const fromIndex = orderedRange.indexOf(lastSelectedItem)\n    const toIndex = orderedRange.indexOf(id)\n    const reverse = toIndex < fromIndex\n    const lowest = reverse ? toIndex : fromIndex\n    const highest = reverse ? fromIndex : toIndex\n    const selected = orderedRange.slice(lowest, highest + 1)\n    const selectedComponents: {\n        [key: string]: true,\n    } = {}\n    selected.forEach((componentId) => {\n        selectedComponents[componentId] = true\n    })\n    setSelectedComponents(selectedComponents)\n}\n\nconst EditName: React.FC<{\n    name: string,\n    onChange: (name: string) => void,\n}> = ({name, onChange}) => {\n    const [editName, setEditName] = useState(name)\n    const inputRef = useRef()\n    useEffect(() => {\n        inputRef.current?.focus()\n    }, [])\n    return (\n        <StyledInputWrapper as=\"form\" onSubmit={event => {\n            event.preventDefault()\n            onChange(editName)\n        }}>\n            <input ref={inputRef} type=\"text\" value={editName} onChange={event => setEditName(event.target.value)} onClick={event => event.stopPropagation()} onBlur={() => onChange('')}/>\n        </StyledInputWrapper>\n    )\n}\n\nconst SceneItem: React.FC<{\n    id: string,\n    iconProps?: any,\n    icon?: any,\n    draggable?: boolean,\n    isGroup?: boolean,\n    isExpanded?: boolean,\n    onClick?: () => void,\n    name: string,\n}> = ({\n                           name: passedName,\n          iconProps = {},\n          icon,\n          id,\n          isGroup,\n          draggable = true,\n          isExpanded = false,\n          onClick: passedOnClick\n      }) => {\n\n    const isSelected = useIsItemSelected(id)\n    const [focused, setFocused] = useState(false)\n    const buttonRef = useRef()\n    const canHaveChildren = useComponentCanHaveChildren(id)\n    const customName = useComponentName(id)\n    const [editingName, setEditingName] = useState(false)\n    const isHovered = useIsComponentHovered(id)\n\n    const name = customName || passedName\n\n    useEffect(() => {\n        if (isSelected) {\n            buttonRef.current.focus()\n        }\n    }, [isSelected])\n\n    useEffect(() => {\n        if (isSelected && focused) {\n            return () => {\n                buttonRef.current?.blur()\n            }\n        }\n    }, [isSelected, focused])\n\n    useEffect(() => {\n        if (focused && isSelected) {\n\n            const callback = () => {\n                if (hotkeys.isPressed(27)) {\n                    setSelectedComponents({})\n                }\n            }\n\n            hotkeys('*', callback)\n\n            return () => {\n                hotkeys.unbind('*', callback)\n            }\n\n        }\n    }, [focused, isSelected])\n\n    const updateName = useCallback((updatedName: string) => {\n        setEditingName(false)\n        if (!updatedName) return\n        if (isGroup) {\n            setGroupName(id, updatedName)\n        } else {\n            setComponentName(id, updatedName)\n        }\n    }, [isGroup])\n\n    const {\n        onClick, onFocus,\n        onBlur, onDelete,\n        onAddChild,\n        onContextMenu,\n        onNameClicked,\n    } = useMemo(() => ({\n        onNameClicked: () => {\n          if (isSelected) {\n              setEditingName(true)\n          }\n        },\n        onContextMenu: (event: any) => {\n            event.preventDefault()\n            console.log('event', event)\n            displayComponentContextMenu(Object.keys(getMainStateStoreState().selectedComponents), [event.clientX, event.clientY])\n        },\n        onAddChild: (event: any) => {\n            event.stopPropagation()\n            setDisplayAddingComponent(true, id)\n        },\n        onDelete: (event: any) => {\n            event.stopPropagation()\n            deleteComponent(id)\n        },\n        onFocus: () => {\n            setFocused(true)\n        },\n        onBlur: () => {\n            setFocused(false)\n        },\n        onClick: (event: any) => {\n            event.stopPropagation()\n            buttonRef.current?.focus()\n            if (isCommandPressed()) {\n                if (isSelected) {\n                    updateSelectedComponents(state => {\n                        const updatedState = {\n                            ...state,\n                        }\n                        delete updatedState[id]\n                        return updatedState\n                    })\n                } else {\n                    updateSelectedComponents(state => ({\n                        ...state,\n                        [id]: true,\n                    }))\n                }\n                setLastSelectedItem(id)\n            } else if (isShiftPressed()) {\n                selectRange(id)\n            } else {\n                selectItem(id)\n                setLastSelectedItem(id)\n            }\n        }\n    }), [isSelected])\n\n    return (\n        <>\n            {\n                focused && <SelectedComponentListeners/>\n            }\n            <StyledDraggableContainer>\n                <StyledWrapper>\n                    <StyledClickable ref={buttonRef} onClick={onClick} onFocus={onFocus} onBlur={onBlur}\n                                     onContextMenu={onContextMenu}\n                                     appearance={isSelected ? 'selected' : isHovered ? 'hovered' : ''}>\n                        <StyledIcon {...iconProps} style={draggable ? 'interactive' : ''}>\n                            {icon}\n                        </StyledIcon>\n                        <div>\n                            <span onClick={onNameClicked}>\n                                {name}\n                            </span>\n                            {\n                                isGroup && (\n                                    <StyledToggleIcon onClick={(event) => {\n                                        event.preventDefault()\n                                        event.stopPropagation()\n                                        passedOnClick()\n                                    }}>\n                                        {\n                                            isExpanded ? (\n                                                <FaCaretUp size={11}/>\n                                            ) : (\n                                                <FaCaretDown size={11}/>\n                                            )\n                                        }\n                                    </StyledToggleIcon>\n                                )\n                            }\n                        </div>\n                        <StyledOptions>\n                            {\n                                canHaveChildren && (\n                                    <StyledTrash style=\"interactive\" onClick={onAddChild}>\n                                        <FaPlus size={10}/>\n                                    </StyledTrash>\n                                )\n                            }\n                        </StyledOptions>\n                    </StyledClickable>\n                    {\n                        editingName && (\n                            <EditName name={name} onChange={updateName}/>\n                        )\n                    }\n                </StyledWrapper>\n            </StyledDraggableContainer>\n            {\n                !isGroup && (\n                    <SceneChildren id={id}/>\n                )\n            }\n        </>\n    )\n}\n\nconst Draggable: React.FC<RenderItemParams> = ({item, onExpand, onCollapse, provided, snapshot}) => {\n\n    const isGroup = item.data.type === TreeItemType.group\n    const cantDrag = item.children.length > 0 && item.isExpanded\n    const {isExpanded = false} = item\n\n    const {\n        onBlur,\n        onDragStart,\n        onFocus,\n        onKeyDown,\n        onMouseDown,\n        onTouchStart,\n        ...otherProps\n    } = provided?.dragHandleProps ?? {}\n\n    const dragHandleProps = cantDrag ? {\n        ...otherProps\n    } : {\n        onBlur,\n        onDragStart,\n        onFocus,\n        onKeyDown,\n        onMouseDown,\n        onTouchStart,\n        ...otherProps,\n    }\n\n    const onHandleClicked = () => {\n        if (isExpanded) {\n            onCollapse(item.id)\n        } else {\n            onExpand(item.id)\n        }\n    }\n\n    const iconType = isGroup ? isExpanded ? SceneItemIcon.group : SceneItemIcon.groupClosed : SceneItemIcon.component\n\n    return (\n        <div\n            ref={provided.innerRef}\n            {...provided.draggableProps}>\n            <SceneItem\n                id={item.id}\n                itemChildren={item.data.children ?? []}\n                iconProps={dragHandleProps}\n                onClick={isGroup ? onHandleClicked : undefined}\n                icon={<ItemIcon iconType={iconType}/>} isGroup={isGroup} draggable={!cantDrag}\n                isExpanded={isExpanded} name={item.data ? item.data.title : ''}/>\n        </div>\n    );\n}\n\nconst StyledContainer = styled('div', {\n    overflowY: 'auto',\n    padding: `6px 0`,\n})\n\nexport const SceneList: React.FC<{\n    view: VIEWS,\n}> = ({view}) => {\n\n    const showActive = view === VIEWS.active\n\n    const [tree, setState] = useSceneTree(showActive)\n\n    const {\n        onExpand,\n        onCollapse,\n        onDragEnd,\n    } = useMemo(() => ({\n        onExpand: (itemId: ItemId) => {\n            setState(mutateTree(tree, itemId, {isExpanded: true}));\n            setComponentTreeItemExpanded(itemId, true)\n        },\n        onCollapse: (itemId: ItemId) => {\n            setState(mutateTree(tree, itemId, {isExpanded: false}));\n            setComponentTreeItemExpanded(itemId, false)\n        },\n        onDragEnd: (\n            source: TreeSourcePosition,\n            destination?: TreeDestinationPosition,\n        ) => {\n            if (!destination) {\n                return;\n            }\n            const destinationItem = tree.items[destination.parentId]\n            if (destination.parentId !== ROOT_ID && (!destinationItem || destinationItem.data.type !== TreeItemType.group)) return\n            const updatedTree = moveItemOnTree(tree, source, destination)\n            if (source.parentId !== destination.parentId) {\n                const id = tree.items[source.parentId].children[source.index]\n                if (!id) {\n                    throw new Error(`Id not found ${id}`)\n                }\n                updateComponentLocation(id, destination.parentId)\n            }\n            setComponentsTree(updatedTree)\n            setState(updatedTree);\n        },\n    }), [tree])\n\n\n    return (\n        <StyledContainer>\n            <Tree\n                tree={tree}\n                renderItem={Draggable}\n                onExpand={onExpand}\n                onCollapse={onCollapse}\n                onDragEnd={onDragEnd}\n                isDragEnabled={showActive}\n                isNestingEnabled={showActive}\n                offsetPerLevel={sidePadding}\n                key={showActive ? 'active' : 'deactivated'}\n            />\n        </StyledContainer>\n    );\n}","import React, {useState} from \"react\"\nimport {SceneList, StyledButton} from \"./SceneList\";\nimport { styled } from \"./ui/sitches.config\";\nimport {setSelectedComponents} from \"./state/main/actions\";\nimport {addingComponentClosed, setDisplayAddingComponent, uiProxy} from \"./state/ui\";\n\nconst StyledContainer = styled('div', {\n    display: 'grid',\n    height: '100%',\n    gridTemplateRows: 'auto minmax(0, 1fr) auto',\n})\n\nexport const StyledTextButton = styled(StyledButton, {\n    cursor: 'pointer',\n    color: '$midPurple',\n    '&:hover': {\n        color: '$lightPurple',\n        textDecoration: 'underline',\n    }\n})\n\nexport const StyledPlainButton: any = styled(StyledButton, {\n    fontSize: '$1b',\n    fontWeight: '$medium',\n    border: '2px solid $purple',\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    borderRadius: '9999999px',\n    padding: '$2',\n    transition: '200ms ease all',\n    '&:not(:disabled)': {\n        cursor: 'pointer',\n    },\n    '&:hover:not(:disabled)': {\n        borderColor: '$purple',\n        backgroundColor: '$purple',\n        color: '$white',\n    },\n    '&:disabled': {\n      borderColor: 'transparent',\n        opacity: 0.6,\n    },\n    variants: {\n        appearance: {\n          faint: {\n              borderColor: '$darkPurple',\n          }\n        },\n        shape: {\n            tiny: {\n              padding: '0 $1b',\n              fontSize: '$1',\n            },\n            full: {\n                width: '100%',\n            },\n            thinner: {\n                padding: '0 $2b',\n                height: '25px',\n            },\n            thinnerWide: {\n                padding: '0 $2b',\n                height: '25px',\n                width: '100%',\n            },\n            round: {\n                padding: '0',\n                width: '25px',\n                height: '25px',\n            }\n        }\n    }\n})\n\nexport const StyledHeading = styled('h3', {\n    fontSize: '$1b'\n})\n\nconst StyledBox = styled('div', {\n    maxHeight: '100%',\n})\n\nexport const StyledPaddedBox = styled('div', {\n    padding: '$2b $3',\n    variants: {\n        visual: {\n            top: {\n                borderBottom: '1px solid $faint',\n            },\n            bottom: {\n                borderTop: '1px solid $faint',\n            },\n        }\n    }\n})\n\nconst StyledHeader = styled(StyledPaddedBox, {\n    display: 'grid',\n    alignItems: 'center',\n    gridTemplateColumns: '1fr auto',\n    columnGap: '$2',\n})\n\nexport enum VIEWS {\n    active = 'active',\n    deactivated = 'deactivated',\n}\n\nexport const ManagerSidebar: React.FC = () => {\n\n    const [selectedView, setSelectedView] = useState(VIEWS.active)\n\n    return (\n        <StyledContainer>\n            <StyledHeader visual=\"top\">\n                <StyledHeading>\n                    Scene\n                </StyledHeading>\n                <div>\n                    <select value={selectedView} onChange={event => setSelectedView(event.target.value as VIEWS)}>\n                        <option value={VIEWS.active}>Active</option>\n                        <option value={VIEWS.deactivated}>Deactivated</option>\n                    </select>\n                </div>\n            </StyledHeader>\n            <StyledBox onClick={() => {\n                if (!uiProxy.displayAddingComponent && addingComponentClosed < Date.now() - 50) {\n                    setSelectedComponents({})\n                }\n            }}>\n                <SceneList view={selectedView}/>\n            </StyledBox>\n            <StyledPaddedBox visual=\"bottom\">\n                <StyledPlainButton shape=\"full\" onClick={() => {\n                    setDisplayAddingComponent(true)\n                }}>\n                    Add Component\n                </StyledPlainButton>\n            </StyledPaddedBox>\n        </StyledContainer>\n    )\n}","import React, {useEffect, useMemo, useState} from \"react\"\nimport {InputProps} from \"./TextInput\";\n\nexport const SelectInput: React.FC<InputProps & {\n    options: {\n        value: string,\n        label?: string,\n    }[]\n}> = ({inputId, value, onChange: passedOnChange, options}) => {\n    const [inputValue, setInputValue] = useState(value ?? '')\n\n    useEffect(() => {\n        setInputValue(value ?? '')\n    }, [value])\n\n    const {\n        onChange,\n    } = useMemo(() => ({\n        onChange: (event: any) => {\n            const newValue = event.target.value\n            setInputValue(newValue)\n            passedOnChange(newValue)\n        },\n    }), [passedOnChange])\n\n    return (\n        <select id={inputId} value={inputValue} onChange={onChange}>\n            {\n                options.map((option) => (\n                    <option key={option.value} value={option.value}>\n                        {option.label ?? option.value}\n                    </option>\n                ))\n            }\n        </select>\n    )\n}","import React, {useCallback, useMemo} from \"react\";\nimport {PropOrigin} from \"../../state/props\";\nimport {resetComponentProp, setSharedComponentPropValue} from \"../../state/main/actions\";\nimport {StyledTextButton} from \"../../ManagerSidebar\";\nimport {styled} from \"../../ui/sitches.config\";\n\nconst StyledHeaderOptions = styled('div', {\n    display: 'flex',\n    alignItems: 'center',\n    '> button': {\n        marginLeft: '$1',\n    }\n})\n\nexport const PropInputOptions: React.FC<{\n    inputValue: any,\n    propType: PropOrigin,\n    propKey: string,\n    componentId: string,\n    componentTypeId: string,\n}> = ({inputValue, propType, componentId, propKey, componentTypeId}) => {\n\n    const applyValue = useCallback(() => {\n        setSharedComponentPropValue(componentTypeId, propKey, inputValue)\n    }, [inputValue])\n\n    const {\n        onReset,\n    } = useMemo(() => ({\n        onReset: () => {\n            resetComponentProp(componentId, propKey)\n        },\n    }), [])\n\n    return (\n        <StyledHeaderOptions>\n            {\n                (propType === PropOrigin.modified || propType === PropOrigin.initial) && (\n                    <>\n                        <StyledTextButton onClick={onReset}>\n                            reset\n                        </StyledTextButton>\n                        {\n                            !!componentTypeId && (\n                                <StyledTextButton onClick={applyValue}>\n                                    apply\n                                </StyledTextButton>\n                            )\n                        }\n                    </>\n                )\n            }\n        </StyledHeaderOptions>\n    )\n}","import React, {createContext, useCallback, useContext, useEffect, useMemo, useState} from \"react\"\nimport {Prop} from \"../state/props\";\nimport {predefinedProps} from \"./config\";\nimport {setComponentPropValue} from \"../state/main/actions\";\nimport UnknownInput from \"./inputs/UnknownInput\";\nimport {storeSnapshot} from \"../state/history/actions\";\n\nconst Context = createContext<{\n    propType: string,\n    propKey: string,\n    componentId: string,\n    componentTypeId: string,\n}>({\n    propType: '',\n    propKey: '',\n    componentId: '',\n    componentTypeId: '',\n})\n\nexport const usePropContext = () => useContext(Context)\n\nexport const Module: React.FC<{\n    componentId: string,\n    componentTypeId: string,\n    value: any,\n    propKey: string,\n    propType: string,\n    onChange?: (value: any) => void,\n}> = ({componentId, componentTypeId, value, propKey, propType, onChange: passedOnChange}) => {\n\n    const [inputValue, setInputValue] = useState(value)\n\n    const updateValue = useCallback((newValue: any) => {\n        storeSnapshot()\n        setComponentPropValue(componentId, propKey, newValue)\n        if (passedOnChange) {\n            passedOnChange(newValue)\n        }\n    }, [componentId])\n\n    const {\n        onChange,\n    } = useMemo(() => ({\n        onChange: (newValue: any) => {\n            setInputValue(newValue)\n            updateValue(newValue)\n        },\n    }), [updateValue])\n\n    useEffect(() => {\n        setInputValue(value)\n    }, [value])\n\n    const propConfig = useMemo(() => {\n        return predefinedProps[propKey]\n    }, [propKey])\n\n    const InputComponent = useMemo(() => {\n        return propConfig?.input ?? UnknownInput\n    }, [propConfig])\n\n    const defaultValue = propConfig?.defaultValue ?? ''\n    const inputId = `input-${propKey}`\n\n    return (\n        <Context.Provider value={{\n            propType,\n            propKey,\n            componentId,\n            componentTypeId,\n        }}>\n            <div>\n                {InputComponent && <InputComponent inputId={inputId} value={inputValue ?? defaultValue} onChange={onChange}/>}\n            </div>\n        </Context.Provider>\n    )\n}\n\nexport const ComponentModules: React.FC<{\n    componentId: string,\n    componentTypeId: string,\n    props: {\n        [key: string]: Prop,\n    }\n}> = ({componentId, componentTypeId, props}) => {\n    return (\n        <div>\n            {\n                Object.entries(props).map(([propKey, prop]) => {\n                    if (prop.value === undefined) return null\n                    return (\n                        <Module key={propKey} propKey={propKey} propType={prop.type} value={prop.value} componentId={componentId} componentTypeId={componentTypeId}/>\n                    )\n                })\n            }\n        </div>\n    )\n}","import { styled } from \"./sitches.config\";\n\nexport const StyledBox = styled('div', {})","import React, {useMemo, useState} from \"react\"\nimport {FaCaretDown, FaCaretUp, FaTimes} from \"react-icons/fa\";\nimport { styled } from \"../../ui/sitches.config\";\nimport {StyledPlainButton} from \"../../ManagerSidebar\";\nimport {NumberInput} from \"./NumberInput\";\nimport {SelectInput} from \"./SelectInput\";\nimport {InputProps} from \"./TextInput\";\nimport {PropOrigin} from \"../../state/props\";\nimport {PropInputOptions} from \"./Options\";\nimport {usePropContext} from \"../ComponentModules\";\nimport { StyledBox } from \"../../ui/generics\";\n\nconst StyledContainer = styled('div', {\n    padding: '$3',\n    borderTop: '1px solid $faint',\n})\n\nconst StyledHeader = styled('div', {\n    display: 'grid',\n    alignItems: 'center',\n    gridTemplateColumns: 'auto 1fr auto',\n    columnGap: '$2',\n})\n\nconst StyledLabel = styled('label', {\n    fontSize: '$1b',\n    fontWeight: '$semi',\n})\n\nconst StyledInputWrapper = styled('div', {\n    display: 'grid',\n    alignItems: 'center',\n    gridTemplateColumns: 'auto 1fr',\n    columnGap: '$2',\n    marginTop: '$2',\n})\n\nconst StyledInputLabel = styled('label', {\n    minWidth: '60px',\n    display: 'inline-grid',\n    fontSize: '$1b',\n})\n\nconst StyledBody = styled('div', {\n    marginTop: '$3',\n})\n\nconst StyledCollidersContainer = styled('div', {\n    border: '1px solid $faint',\n    marginLeft: '-$2',\n    marginRight: '-$2',\n    maxWidth: 'none',\n    marginTop: '$2',\n})\n\nconst StyledCollidersHeader = styled('header', {\n    padding: '$2',\n    display: 'grid',\n    gridTemplateColumns: 'auto 1fr',\n    columnGap: '$2',\n    alignItems: 'center',\n})\n\nexport enum RigidBodyColliderShape {\n    BALL = 'BALL',\n    CUBIOD = 'CUBIOD',\n}\n\nexport enum RigidBodyType {\n    DYNAMIC = 'DYNAMIC',\n    STATIC = 'STATIC',\n    KINEMATIC = 'KINEMATIC',\n}\n\nconst options = [\n    {\n        value: RigidBodyType.DYNAMIC,\n        label: 'Dynamic',\n    },\n    {\n        value: RigidBodyType.STATIC,\n        label: 'Static',\n    },\n    {\n        value: RigidBodyType.KINEMATIC,\n        label: 'Kinematic',\n    },\n]\n\nexport type ColliderValue = {\n    key: string,\n    colliderType: RigidBodyColliderShape,\n    hx?: number,\n    hy?: number,\n    hz?: number,\n    radius?: number,\n}\n\nexport type RigidBody3dPropValue = {\n    enabled?: boolean,\n    bodyType?: RigidBodyType,\n    mass?: number,\n    colliders?: ColliderValue[],\n    customBodyDef?: {\n        [key: string]: any,\n    }\n}\n\nconst StyledColliderContainer = styled('div', {\n    padding: '$2',\n    borderTop: '1px solid $faint',\n})\n\nconst RigidBody3DColliderInput: React.FC<{\n    collider: ColliderValue,\n    onChange: (newValue: any) => void,\n    onDelete: () => void,\n}> = ({collider, onChange, onDelete}) => {\n    const {colliderType, key, radius = 1, hx = 0.5, hy = 0.5, hz = 0.5} = collider\n    const {\n        updateValue,\n    } = useMemo(() => ({\n        updateValue: (newValue: any,) => {\n            const updatedCollider = {\n                ...collider,\n                ...newValue,\n            }\n            onChange(updatedCollider)\n        }\n    }), [onChange])\n    return (\n        <StyledColliderContainer>\n            <StyledInputWrapper css={{\n                gridTemplateColumns: 'auto 1fr auto',\n                marginTop: '0',\n            }}>\n                <StyledInputLabel htmlFor={`${key}-shape`}>\n                    Shape\n                </StyledInputLabel>\n                <div>\n                    <SelectInput inputId={`${key}-shape`} value={colliderType} onChange={(newValue: any) => {\n                        updateValue({\n                            colliderType: newValue,\n                        })\n                    }} options={[{\n                        value: RigidBodyColliderShape.BALL,\n                        label: 'Ball',\n                    }, {\n                        value: RigidBodyColliderShape.CUBIOD,\n                        label: 'Cubiod',\n                    }]}/>\n                </div>\n                <div>\n                    <button onClick={onDelete}>\n                        <FaTimes size={11}/>\n                    </button>\n                </div>\n            </StyledInputWrapper>\n            {\n                colliderType === RigidBodyColliderShape.BALL && (\n                    <>\n                        <StyledInputWrapper>\n                            <StyledInputLabel htmlFor={`${key}-radius`}>\n                                Radius\n                            </StyledInputLabel>\n                            <NumberInput inputId={`${key}-radius`} value={radius} onChange={(newValue: any) => {\n                                updateValue({\n                                    radius: newValue,\n                                })\n                            }}/>\n                        </StyledInputWrapper>\n                    </>\n                )\n            }\n            {\n                colliderType === RigidBodyColliderShape.CUBIOD && (\n                    <>\n                        <StyledInputWrapper>\n                            <StyledInputLabel htmlFor={`${key}-hx`}>\n                                hx\n                            </StyledInputLabel>\n                            <NumberInput inputId={`${key}-hx`} value={hx} onChange={(newValue: any) => {\n                                updateValue({\n                                    hx: newValue,\n                                })\n                            }}/>\n                        </StyledInputWrapper>\n                        <StyledInputWrapper>\n                            <StyledInputLabel htmlFor={`${key}-hy`}>\n                                hy\n                            </StyledInputLabel>\n                            <NumberInput inputId={`${key}-hy`} value={hy} onChange={(newValue: any) => {\n                                updateValue({\n                                    hy: newValue,\n                                })\n                            }}/>\n                        </StyledInputWrapper>\n                        <StyledInputWrapper>\n                            <StyledInputLabel htmlFor={`${key}-hz`}>\n                                hz\n                            </StyledInputLabel>\n                            <NumberInput inputId={`${key}-hz`} value={hz} onChange={(newValue: any) => {\n                                updateValue({\n                                    hz: newValue,\n                                })\n                            }}/>\n                        </StyledInputWrapper>\n                    </>\n                )\n            }\n        </StyledColliderContainer>\n    )\n}\n\nexport const RigidBody3DInput: React.FC<InputProps> = ({\n    value,\n    inputId,\n    onChange: passedOnChange,\n                                                       }) => {\n\n    const [isExpanded, setIsExpanded] = useState(true)\n\n    const {\n        enabled = true,\n        bodyType = RigidBodyType.DYNAMIC,\n        mass = 1,\n        colliders = [],\n    } = value as RigidBody3dPropValue\n\n    const {\n        addCollider,\n        updateCollider,\n        deleteCollider,\n    } = useMemo(() => ({\n        addCollider: () => {\n            const newCollider: ColliderValue = {\n                key: Date.now().toString(),\n                colliderType: RigidBodyColliderShape.BALL,\n            }\n            const updatedValue = {\n                ...value,\n                colliders: colliders.concat([newCollider])\n            }\n            passedOnChange(updatedValue)\n        },\n        updateCollider: (index: number, newValue: any) => {\n            const updatedColliders = colliders.slice()\n            updatedColliders[index] = newValue\n            const updatedValue = {\n                ...value,\n                colliders: updatedColliders,\n            }\n            passedOnChange(updatedValue)\n        },\n        deleteCollider: (index: number,) => {\n            const updatedColliders = colliders.slice()\n            updatedColliders.splice(index, 1)\n            const updatedValue = {\n                ...value,\n                colliders: updatedColliders,\n            }\n            passedOnChange(updatedValue)\n        }\n    }), [value, colliders])\n\n    const {\n        propKey,\n        propType,\n        componentTypeId,\n        componentId,\n    } = usePropContext()\n\n    return (\n        <StyledContainer>\n            <StyledHeader>\n                <div>\n                    <input id={inputId} type=\"checkbox\" checked={enabled} onChange={(event) => {\n                        const updatedValue = {\n                            ...value,\n                            enabled: event.target.checked,\n                        }\n                        passedOnChange(updatedValue)\n                    }}/>\n                </div>\n                <StyledBox css={{\n                    display: 'grid',\n                    alignItems: 'center',\n                    gridTemplateColumns: 'auto 1fr',\n                    columnGap: '$0b',\n                }}>\n                    <StyledLabel htmlFor={inputId}>RigidBody 3D</StyledLabel>\n                    <PropInputOptions propKey={propKey} propType={propType as PropOrigin} componentId={componentId} componentTypeId={componentTypeId} inputValue={value}/>\n                </StyledBox>\n                <div>\n                    <button onClick={() => {\n                        setIsExpanded(state => !state)\n                    }}>\n                        {\n                            isExpanded ? (\n                                <FaCaretUp/>\n                            ) : (\n                                <FaCaretDown/>\n                            )\n                        }\n                    </button>\n                </div>\n            </StyledHeader>\n            {\n                isExpanded && (\n                    <StyledBody>\n                        <StyledInputWrapper>\n                            <StyledInputLabel htmlFor=\"rigidBody3d-type\">\n                                Type\n                            </StyledInputLabel>\n                            <div>\n                                <SelectInput inputId=\"rigidBody3d-type\" value={bodyType} onChange={(newValue: any) => {\n                                    const updatedValue = {\n                                        ...value,\n                                        bodyType: newValue,\n                                    }\n                                    passedOnChange(updatedValue)\n                                }} options={options}/>\n                            </div>\n                        </StyledInputWrapper>\n                        {\n                            (bodyType === RigidBodyType.DYNAMIC) && (\n                                <StyledInputWrapper>\n                                    <StyledInputLabel htmlFor=\"rigidBody3d-mass\">\n                                        Mass\n                                    </StyledInputLabel>\n                                    <div>\n                                        <NumberInput inputId=\"rigidBody3d-mass\" value={mass} onChange={(newValue: any) => {\n                                            const updatedValue = {\n                                                ...value,\n                                                mass: newValue,\n                                            }\n                                            passedOnChange(updatedValue)\n                                        }}/>\n                                    </div>\n                                </StyledInputWrapper>\n                            )\n                        }\n                        <StyledCollidersContainer>\n                            <StyledCollidersHeader>\n                                <div>\n                                    <StyledInputLabel>\n                                        Colliders\n                                    </StyledInputLabel>\n                                </div>\n                                <StyledPlainButton shape=\"thinnerWide\" onClick={addCollider}>Add Collider</StyledPlainButton>\n                            </StyledCollidersHeader>\n                            {\n                                colliders.length > 0 && (\n                                    <div>\n                                        {\n                                            colliders.map((collider, index) => (\n                                                <div key={collider.key}>\n                                                    <RigidBody3DColliderInput collider={collider} onChange={(newValue: any) => {\n                                                        updateCollider(index, newValue)\n                                                    }} onDelete={() => {\n                                                        deleteCollider(index)\n                                                    }}/>\n                                                </div>\n                                            ))\n                                        }\n                                    </div>\n                                )\n                            }\n                        </StyledCollidersContainer>\n                    </StyledBody>\n                )\n            }\n        </StyledContainer>\n    )\n}","import {MultiNumberInput} from \"./inputs/MultiNumberInput\";\nimport {RigidBody3DInput} from \"./inputs/RigidBody3DInput\";\n\ninterface PredefinedProp {\n    key: string,\n    label: string,\n    input?: any,\n    defaultValue?: any,\n}\n\nexport const childrenProp: PredefinedProp = {\n    key: '__children',\n    label: 'Children',\n}\n\nexport const modulesProp: PredefinedProp = {\n    key: '__modules',\n    label: 'Modules',\n}\n\nexport const rigidBody3dModuleProp: PredefinedProp = {\n    key: '__rigidBody3dModule',\n    label: 'RigidBody 3D',\n    input: RigidBody3DInput,\n    defaultValue: undefined\n}\n\nexport const positionProp: PredefinedProp = {\n    key: '__position',\n    label: 'Position',\n    input: MultiNumberInput,\n    defaultValue: {x: 0, y: 0, z: 0,}\n}\n\nexport const rotationProp: PredefinedProp = {\n    key: '__rotation',\n    label: 'Rotation',\n    input: MultiNumberInput,\n    defaultValue: {x: 0, y: 0, z: 0,}\n}\n\nexport const scaleProp: PredefinedProp = {\n    key: '__scale',\n    label: 'Scale',\n    input: MultiNumberInput,\n    defaultValue: {x: 1, y: 1, z: 1,}\n}\n\nexport const predefinedProps = {\n    [positionProp.key]: positionProp,\n    [rotationProp.key]: rotationProp,\n    [scaleProp.key]: scaleProp,\n    [rigidBody3dModuleProp.key]: rigidBody3dModuleProp,\n}\n\nexport const predefinedBottomProps = {\n    [rigidBody3dModuleProp.key]: rigidBody3dModuleProp,\n}\n\nexport const predefinedPropKeys = {\n    position: positionProp.key,\n    rotation: rotationProp.key,\n    scale: scaleProp.key,\n    rigidBody3d: rigidBody3dModuleProp.key,\n    modules: modulesProp.key,\n    children: childrenProp.key,\n}","import React, {useEffect, useMemo, useState} from \"react\"\nimport {styled} from \"../ui/sitches.config\"\nimport {Prop, PropOrigin, useComponentProps} from \"../state/props\";\nimport {setComponentPropValue} from \"../state/main/actions\";\nimport {useComponent} from \"../state/components/hooks\";\nimport {\n    modulesProp,\n    positionProp,\n    predefinedBottomProps,\n    predefinedProps,\n    rigidBody3dModuleProp,\n    rotationProp,\n    scaleProp\n} from \"./config\";\nimport {ComponentModules, Module} from \"./ComponentModules\";\nimport {PropInputOptions} from \"./inputs/Options\";\nimport {StyledPaddedBox, StyledPlainButton} from \"../ManagerSidebar\";\n\nconst StyledContainer = styled('div', {\n    height: '100%',\n    display: 'grid',\n    gridTemplateRows: '1fr auto',\n})\n\nconst StyledProp = styled('div', {\n    marginTop: '$2',\n})\n\nconst StyledHeader = styled('header', {\n    display: 'flex',\n    alignItems: 'center',\n    padding: '0 $3',\n    marginBottom: '$1',\n    minHeight: '18px',\n})\n\nconst StyledHeaderLabel = styled('label', {\n    fontSize: '$1b',\n})\n\nconst StyledInputContainer = styled('div', {\n    padding: '0 $3',\n})\n\nconst PropInput: React.FC<{\n    componentId: string,\n    componentTypeId: string,\n    propKey: string,\n    value: any,\n    propType: string,\n}> = ({\n    componentId,\n    componentTypeId,\n    propKey,\n    value,\n    propType\n                       }) => {\n\n    const [inputValue, setInputValue] = useState(value)\n\n    useEffect(() => {\n        setInputValue(value)\n    }, [value])\n\n    const inputId = `input-${propKey}`\n\n    const propConfig = useMemo(() => {\n        return predefinedProps[propKey]\n    }, [propKey])\n\n    const label = propConfig?.label ?? propKey\n\n    return (\n        <StyledProp>\n            <StyledHeader>\n                <StyledHeaderLabel htmlFor={inputId}>{label || propKey}</StyledHeaderLabel>\n                <PropInputOptions propKey={propKey} propType={propType as PropOrigin} componentId={componentId} componentTypeId={componentTypeId} inputValue={inputValue}/>\n            </StyledHeader>\n            <StyledInputContainer>\n                <Module propType={propType} componentId={componentId} componentTypeId={componentTypeId} value={value} propKey={propKey} onChange={setInputValue}/>\n            </StyledInputContainer>\n        </StyledProp>\n    )\n}\n\nconst defaultOrder = [positionProp.key, rotationProp.key, scaleProp.key]\n\nconst sortProps = ([propA]: [string, any], [propB]: [string, any]) => {\n    let propAIndex = defaultOrder.indexOf(propA)\n    propAIndex = propAIndex === -1 ? 9999 : propAIndex\n    let propBIndex = defaultOrder.indexOf(propB)\n    propBIndex = propBIndex === -1 ? 9999 : propBIndex\n    return propAIndex - propBIndex\n}\n\nconst CustomProps: React.FC<{\n    componentId: string,\n    componentTypeId: string,\n    props: {\n        [key: string]: Prop,\n    }\n}> = ({componentId, componentTypeId, props}) => {\n    return (\n        <div>\n            {\n                Object.entries(props).sort(sortProps).map(([key, prop]) => (\n                    <PropInput componentId={componentId} componentTypeId={componentTypeId} key={key} propKey={key} value={prop.value} propType={prop.type}/>\n                ))\n            }\n        </div>\n    )\n}\n\nexport const ComponentState: React.FC<{\n    id: string,\n}> = ({id}) => {\n    const componentProps = useComponentProps(id)\n    const component = useComponent(id)\n    const componentTypeId = component?.componentId ?? ''\n    const {\n        [modulesProp.key]: modules,\n        ...remainingProps\n    } = componentProps\n    const {\n        customProps,\n        bottomProps\n    } = useMemo(() => {\n        const customProps: {\n            [key: string]: Prop,\n        } = {}\n        const bottomProps: {\n            [key: string]: Prop,\n        } = {}\n        Object.entries(remainingProps).forEach(([key, prop]) => {\n            if (prop.hidden) return\n            if (predefinedBottomProps[key]) {\n                bottomProps[key] = prop\n            } else {\n                customProps[key] = prop\n            }\n        })\n        return {\n            customProps,\n            bottomProps,\n        }\n    }, [remainingProps])\n\n    const {\n        addModule,\n    } = useMemo(() => ({\n        addModule: () => {\n            if (!componentProps[rigidBody3dModuleProp.key] || componentProps[rigidBody3dModuleProp.key].value === undefined) {\n                setComponentPropValue(id, rigidBody3dModuleProp.key, {\n                    enabled: true,\n                })\n            }\n        }\n    }), [componentProps])\n\n    return (\n        <>\n            <StyledContainer>\n                <CustomProps componentId={id} componentTypeId={componentTypeId} props={customProps}/>\n                {\n                    modules && (\n                        <ComponentModules componentId={id} componentTypeId={componentTypeId} props={bottomProps}/>\n                    )\n                }\n            </StyledContainer>\n            {\n                modules && (\n                    <StyledPaddedBox visual=\"bottom\">\n                        <StyledPlainButton shape=\"full\" onClick={addModule}>\n                            Add Module\n                        </StyledPlainButton>\n                    </StyledPaddedBox>\n                )\n            }\n        </>\n    )\n}","import React, {createContext, useContext} from \"react\"\nimport { styled } from \"./ui/sitches.config\"\nimport {StyledHeading, StyledPaddedBox} from \"./ManagerSidebar\";\nimport {ComponentState} from \"./componentEditor/ComponentState\";\nimport {useComponentName, useSoleSelectedComponent} from \"./state/main/hooks\";\nimport {useComponent} from \"./state/components/hooks\";\n\nconst StyledContainer = styled('div', {\n    height: '100%',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr auto',\n})\n\ninterface ContextState {\n    selectedComponent: string,\n}\n\nconst Context = createContext<ContextState>(null!)\n\nexport const useCurrentComponentId = () => {\n    return useContext(Context).selectedComponent\n}\n\nconst SidebarHeader: React.FC<{\n    id: string,\n}> = ({id}) => {\n    const component = useComponent(id)\n    const customName = useComponentName(id)\n    const name = customName || (component?.name ?? '')\n    return (\n        <StyledPaddedBox visual=\"top\">\n            <StyledHeading>\n                {name}\n            </StyledHeading>\n        </StyledPaddedBox>\n    )\n}\n\nexport const StateSidebar: React.FC = () => {\n    const selectedComponent = useSoleSelectedComponent()\n    if (!selectedComponent) return null\n    return (\n        <Context.Provider value={{\n            selectedComponent,\n        }}>\n            <StyledContainer>\n                <SidebarHeader id={selectedComponent}/>\n                <ComponentState id={selectedComponent} key={selectedComponent}/>\n            </StyledContainer>\n        </Context.Provider>\n    )\n}","import React from \"react\"\nimport OutsideClickHandler from 'react-outside-click-handler';\nimport { styled } from \"./ui/sitches.config\"\nimport {\n    setAddingComponent,\n    setDisplayAddingComponentParent,\n    setDisplayAddingComponent,\n    uiProxy,\n    addComponent\n} from \"./state/ui\";\nimport {useProxy} from \"valtio\";\nimport {ItemIcon, SceneItemIcon, StyledClickable, StyledIcon} from \"./SceneList\";\nimport {FaMousePointer} from \"react-icons/fa\";\nimport {useAddableStore} from \"../scene/addables\";\n\nconst StyledContainer = styled('div', {\n    position: 'absolute',\n    left: '100%',\n    top: 0,\n    bottom: 0,\n    zIndex: '$high',\n    width: '260px',\n    backgroundColor: '$darkGreyLighter',\n    borderLeft: '1px solid $darkGrey',\n    padding: '$2',\n    overflowY: 'auto',\n})\n\nconst StyledAddableComponent = styled(StyledClickable, {\n    '&:not(:first-child)': {\n        marginTop: '$0b',\n    }\n})\n\nconst StyledIconWrapper = styled('span', {\n    position: 'relative',\n    left: '1px',\n})\n\nconst closeAddingComponent = () => {\n    setDisplayAddingComponent(false)\n    setDisplayAddingComponentParent('')\n}\n\nconst AddableComponent: React.FC<{\n    label: string,\n    addableId: string,\n}> = ({label, addableId}) => {\n    return (\n        <StyledAddableComponent onClick={() => {\n            addComponent(addableId, uiProxy.displayAddingComponentParent)\n            closeAddingComponent()\n        }}>\n            <StyledIcon>\n                <ItemIcon iconType={SceneItemIcon.component}/>\n            </StyledIcon>\n            <div>\n                {label}\n            </div>\n            <StyledIcon appearance=\"clickable\" onClick={(event: any) => {\n                event.stopPropagation()\n                setAddingComponent(addableId)\n                closeAddingComponent()\n            }}>\n                <StyledIconWrapper>\n                    <FaMousePointer size={10} />\n                </StyledIconWrapper>\n            </StyledIcon>\n        </StyledAddableComponent>\n    )\n}\n\nexport const AddingComponentMenu: React.FC = () => {\n    const isAddingComponent = useProxy(uiProxy).displayAddingComponent\n    const addables = useAddableStore(state => state.addables)\n    if (!isAddingComponent) return null\n    return (\n        <OutsideClickHandler onOutsideClick={closeAddingComponent}>\n            <StyledContainer>\n                {\n                    Object.entries(addables).map(([key, addable]) => (\n                        <AddableComponent addableId={addable.id} label={addable.name} key={key}/>\n                    ))\n                }\n            </StyledContainer>\n        </OutsideClickHandler>\n    )\n}","import React, {useMemo} from \"react\"\nimport OutsideClickHandler from 'react-outside-click-handler';\nimport { styled } from \"./ui/sitches.config\"\nimport {useProxy} from \"valtio\";\nimport {uiProxy} from \"./state/ui\";\nimport {StyledButton} from \"./SceneList\";\nimport {deleteSelectedComponents, groupComponents, removeDeactivatedComponents} from \"./state/main/actions\";\nimport {useComponentsStore} from \"./state/components/store\";\n\nconst StyledContainer = styled('div', {\n    zIndex: '$max',\n    backgroundColor: '$darkGrey',\n    padding: '$1 0',\n    width: '180px',\n    border: '1px solid $lightPurple',\n    borderRadius: '$1',\n})\n\nconst StyledOption = styled(StyledButton, {\n    width: '100%',\n    padding: '$1 $2',\n    textAlign: 'left',\n    cursor: 'pointer',\n    fontSize: '$1b',\n    fontWeight: '$semi',\n    '&:hover': {\n        backgroundColor: '$purple',\n        color: '$white',\n    }\n})\n\nconst closeContextMenu = () => {\n    uiProxy.componentContextMenu = {\n        visible: false,\n    }\n}\n\nconst useSelectedComponentTypes = (componentIds: string[]) => {\n    return useMemo(() => {\n        let allRoot = true\n        let componentsSelected = false\n        let inactiveComponents = false\n        let groups = false\n        const {components, deactivatedComponents} = useComponentsStore.getState()\n        componentIds.forEach((id) => {\n            if (components[id]) {\n                componentsSelected = true\n                const component = components[id]\n                if (!component.isRoot) {\n                    allRoot = false\n                }\n            } else if (deactivatedComponents[id]) {\n                inactiveComponents = true\n            } else {\n                groups = true\n            }\n        })\n        return {\n            allRoot,\n            hasComponents: componentsSelected,\n            hasInactiveComponents: inactiveComponents,\n            hasGroups: groups,\n        }\n    }, [componentIds])\n}\n\nconst ComponentsMenu: React.FC<{\n    components: string[]\n}> = ({components}) => {\n\n    const {\n        allRoot,\n        hasComponents,\n        hasInactiveComponents,\n        hasGroups\n    } = useSelectedComponentTypes(components)\n\n    const {\n        onDelete,\n        onReactivate,\n        onGroup,\n    } = useMemo(() => ({\n        onGroup: () => {\n            groupComponents(components)\n            closeContextMenu()\n        },\n        onDelete: () => {\n            deleteSelectedComponents()\n            closeContextMenu()\n        },\n        onReactivate: () => {\n            removeDeactivatedComponents(components)\n            closeContextMenu()\n        }\n    }), [components])\n\n    const options = useMemo(() => {\n\n        const multipleComponents = components.length > 1\n\n        const allActive = !hasInactiveComponents\n\n        let options: any[] = []\n\n        const canGroup = allRoot\n\n        if (allActive) {\n            if (!hasGroups) {\n                if (canGroup) {\n                    options.push(\n                        <StyledOption onClick={onGroup} key=\"groupComponents\">\n                            Group component{multipleComponents ? 's' : ''}\n                        </StyledOption>\n                    )\n                }\n                options.push(\n                    <StyledOption onClick={onDelete} key=\"delete\">\n                        Delete component{multipleComponents ? 's' : ''}\n                    </StyledOption>\n                )\n            } else if ((hasComponents || hasGroups) && canGroup) {\n                options.push(\n                    <StyledOption onClick={onGroup} key=\"group\">\n                        Group\n                    </StyledOption>\n                )\n            }\n        }\n        if (hasInactiveComponents) {\n            options.push(\n                <StyledOption onClick={onReactivate} key=\"restore\">\n                    Restore\n                </StyledOption>\n            )\n        }\n\n        return options\n    }, [\n        components,\n        onDelete,\n        onReactivate,\n        onGroup,\n        hasComponents,\n        hasInactiveComponents,\n        hasGroups,\n        allRoot,\n    ])\n\n    return (\n        <StyledContainer>\n            {\n               options\n            }\n        </StyledContainer>\n    )\n}\n\nexport const ContextMenu: React.FC = () => {\n\n    const {componentContextMenu} = useProxy(uiProxy)\n\n    if (!componentContextMenu.visible) return null\n\n    const {position = [0, 0], components = []} = componentContextMenu\n\n    return (\n        <OutsideClickHandler onOutsideClick={closeContextMenu}>\n            <div style={{\n                position: 'fixed',\n                left: `${position[0]}px`,\n                top: `${position[1]}px`,\n            }}>\n                <ComponentsMenu components={components}/>\n            </div>\n        </OutsideClickHandler>\n    )\n}","import React, {useRef} from \"react\"\nimport {useShortcut} from \"./shortcuts\";\nimport {handlePaste} from \"./state/main/actions\";\nimport {redoState, undoState} from \"./state/history/actions\";\n\nconst delay = 100\n\nexport const GlobalHotkeysListener: React.FC = () => {\n\n    const localStateRef = useRef({\n        lastUndo: 0,\n        lastRedo: 0,\n        lastPaste: 0,\n        lastSave: 0,\n    })\n\n    useShortcut([{\n        shortcut: 'CmdOrCtrl+Z',\n        handler: () => {\n            const now = Date.now()\n            if (now > localStateRef.current.lastUndo + delay) {\n                localStateRef.current.lastUndo = now\n                undoState()\n            }\n        }\n    }, {\n        shortcut: 'CmdOrCtrl+Shift+Z',\n        handler: () => {\n            const now = Date.now()\n            if (now > localStateRef.current.lastRedo + delay) {\n                localStateRef.current.lastRedo = now\n                redoState()\n            }\n        }\n    }, {\n        shortcut: 'CmdOrCtrl+S',\n        handler: (event: any) => {\n            event.preventDefault()\n            // saveChanges()\n        }\n    }, {\n        shortcut: 'CmdOrCtrl+V',\n        handler: () => {\n            const now = Date.now()\n            if (now > localStateRef.current.lastPaste + delay) {\n                localStateRef.current.lastPaste = now\n                handlePaste()\n            }\n        }\n    }])\n\n    return null\n}","import React from \"react\"\nimport GoogleFontLoader from \"react-google-font-loader\"\nimport \"./ui/sitches.config\"\n\nconst StyledHeader = styled('header', {\n    backgroundColor: '$darkGrey',\n    display: 'grid',\n    gridTemplateColumns: 'auto 1fr auto',\n    alignItems: 'center',\n    height: '$headerHeight',\n    padding: '0 $2'\n})\nimport { styled } from \"./ui/sitches.config\"\nimport {ManagerSidebar, StyledPlainButton} from \"./ManagerSidebar\";\nimport {FaRedo, FaUndo} from \"react-icons/fa\";\nimport {StateSidebar} from \"./StateSidebar\";\nimport {useHotkeysListener} from \"./hotkeys\";\nimport {AddingComponentMenu} from \"./AddingComponentMenu\";\nimport {ContextMenu} from \"./ContextMenu\";\nimport { StyledBox } from \"./ui/generics\"\nimport {BiExpand, BiMove, BiRotateLeft} from \"react-icons/bi\";\nimport {StyledButton} from \"./SceneList\";\nimport {EditorTransformMode, setEditMode, setTransformMode, useIsEditMode, useTransformMode} from \"./state/editor\";\nimport {GlobalHotkeysListener} from \"./GlobalHotkeysListener\";\nimport {getMainStateStoreState} from \"./state/main/store\";\nimport {useComponentsStore} from \"./state/components/store\";\nimport {redoState, undoState} from \"./state/history/actions\";\n\nconst StyledHeaderSide = styled('div', {\n    width: '300px',\n    'h3': {\n        fontSize: '$2',\n        letterSpacing: '1px',\n    }\n})\n\nconst StyledHeaderMiddle = styled('div', {\n    display: 'flex',\n    justifyContent: 'center',\n})\n\nconst StyledHeaderOptions = styled(StyledHeaderSide, {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'flex-end',\n    '> *:not(:last-child)': {\n        marginRight: '$1',\n    }\n})\n\nconst Header: React.FC = () => {\n    const isEditMode = useIsEditMode()\n    return (\n        <StyledHeader>\n            <StyledHeaderSide>\n                <h3>RGG</h3>\n            </StyledHeaderSide>\n            <StyledHeaderMiddle>\n                <StyledPlainButton shape=\"thinner\" onClick={() => {\n                    setEditMode(!isEditMode)\n                }}>\n                    {\n                        isEditMode ? \"Play\" : \"Edit\"\n                    }\n                </StyledPlainButton>\n            </StyledHeaderMiddle>\n            <StyledHeaderOptions>\n                <StyledPlainButton shape=\"thinner\" appearance=\"faint\" onClick={() => {\n                    console.log(getMainStateStoreState())\n                    console.log(useComponentsStore.getState())\n                }}>\n                    Debug\n                </StyledPlainButton>\n                <StyledPlainButton shape=\"thinner\" appearance=\"faint\">\n                    Discard\n                </StyledPlainButton>\n                <StyledPlainButton shape=\"round\" appearance=\"faint\" onClick={undoState}>\n                    <FaUndo size={9}/>\n                </StyledPlainButton>\n                <StyledPlainButton shape=\"round\" appearance=\"faint\" disabled onClick={redoState}>\n                    <FaRedo size={9}/>\n                </StyledPlainButton>\n                <StyledPlainButton shape=\"thinner\">\n                    Save\n                </StyledPlainButton>\n            </StyledHeaderOptions>\n        </StyledHeader>\n    )\n}\n\nconst StyledDefaultContainer = styled('div', {\n    color: '$lightPurple',\n    fontFamily: '$main',\n    fontSize: '$2',\n})\n\nconst StyledContainer = styled(StyledDefaultContainer, {\n    backgroundColor: '$darkGrey',\n    position: 'fixed',\n    top: 0,\n    left: 0,\n    right: 0,\n    bottom: 0,\n    display: 'grid',\n    gridTemplateRows: 'auto minmax(0, 1fr)',\n})\n\nconst StyledMain = styled('div', {\n    display: 'grid',\n    gridTemplateColumns: 'auto minmax(0, 1fr) auto',\n})\n\nconst StyledSidebar = styled('div', {\n    width: '$sidebar',\n    backgroundColor: '$darkGreyLighter',\n    position: 'relative',\n    maxHeight: '100%',\n})\n\nconst StyledContent = styled('div', {\n    position: 'relative',\n})\n\nconst StyledBoxButton: any = styled(StyledButton, {\n    display: 'flex',\n    justifyContent: 'center',\n    alignItems: 'center',\n    width: '26px',\n    height: '26px',\n    cursor: 'pointer',\n    variants: {\n        appearance: {\n            active: {\n                backgroundColor: '$purple',\n                color: '$white',\n            }\n        }\n    }\n})\n\nconst OverlayControls: React.FC = () => {\n\n    const transformMode = useTransformMode()\n\n    return (\n        <StyledBox css={{\n            position: 'absolute',\n            top: '$1',\n            right: '$1',\n            zIndex: '$high',\n            display: 'grid',\n            gridTemplateColumns: 'auto auto auto',\n            backgroundColor: '$darkGrey',\n        }}>\n            <StyledBoxButton appearance={transformMode === EditorTransformMode.translate ? 'active' : ''}\n            onClick={() => {\n                setTransformMode(EditorTransformMode.translate)\n            }}>\n                <BiMove size={16}/>\n            </StyledBoxButton>\n            <StyledBoxButton appearance={transformMode === EditorTransformMode.rotate ? 'active' : ''}\n            onClick={() => {\n                setTransformMode(EditorTransformMode.rotate)\n            }}>\n                <BiRotateLeft size={16}/>\n            </StyledBoxButton>\n            <StyledBoxButton appearance={transformMode === EditorTransformMode.scale ? 'active' : ''}\n            onClick={() => {\n                setTransformMode(EditorTransformMode.scale)\n            }}>\n                <BiExpand size={15}/>\n            </StyledBoxButton>\n        </StyledBox>\n    )\n}\n\nexport const Editor: React.FC = ({children}) => {\n    useHotkeysListener()\n    return (\n        <>\n            <GoogleFontLoader\n                fonts={[\n                    {\n                        font: 'Roboto',\n                        weights: [400, 500, 600, 700],\n                    },\n                ]}\n            />\n            <GlobalHotkeysListener/>\n            <StyledContainer>\n                <Header/>\n                <StyledMain>\n                    <StyledSidebar>\n                        <ManagerSidebar/>\n                        <AddingComponentMenu/>\n                    </StyledSidebar>\n                    <StyledContent>\n                        {children}\n                        <OverlayControls/>\n                    </StyledContent>\n                    <StyledSidebar css={{\n                        width: '$sidebarPlus',\n                    }}>\n                        <StateSidebar/>\n                    </StyledSidebar>\n                </StyledMain>\n                <ContextMenu/>\n            </StyledContainer>\n        </>\n    )\n}","import React from \"react\"\nimport {useIsEditMode} from \"../editor/state/editor\";\n\nconst EditFloor: React.FC = () => {\n    const twoDimensional = false\n    const isEditMode = useIsEditMode()\n    return (\n        <>\n            <gridHelper visible={isEditMode} position={[0, 0, -0.01]} args={[1000, 1000, '#888', '#111']} rotation={[twoDimensional ? Math.PI / 2 : 0, 0, 0]} layers={[31]}/>\n        </>\n    )\n}\n\nexport default EditFloor","import React, {useEffect, useLayoutEffect, useRef} from \"react\"\nimport {PerspectiveCamera as PCamera, Vector3} from \"three\";\nimport {OrbitControls, PerspectiveCamera} from \"@react-three/drei\";\nimport {useThree} from \"react-three-fiber\";\nimport {ref, useProxy} from \"valtio\";\nimport {editorStateProxy, useIsEditMode} from \"../editor/state/editor\";\nimport {useCallbackRef, useHotkeys} from \"../custom/hooks\";\nimport {isSpacePressed} from \"../editor/hotkeys\";\n\nconst offsets = {\n    x: 0,\n    // y: 2,\n    // z: 5,\n    y: 25,\n    z: 20,\n}\n\nconst EditCamera: React.FC = () => {\n    const cameraRef = useRef<PCamera>(null!)\n    const orbitRef = useRef<OrbitControls>(null!)\n    const isEditMode = useIsEditMode()\n    const {\n        setDefaultCamera,\n    } = useThree()\n\n    useLayoutEffect(() => {\n        if (isEditMode) {\n            setDefaultCamera(cameraRef.current)\n        }\n    }, [isEditMode])\n\n    useEffect(() => {\n        editorStateProxy.orbitRef = ref(orbitRef)\n    }, [])\n\n    useEffect(() => {\n        if (!orbitRef.current) return\n        orbitRef.current.enabled = isEditMode\n    }, [isEditMode])\n\n    useLayoutEffect(() => {\n        cameraRef.current.layers.enable(31)\n        cameraRef.current.lookAt(0, 5, 0)\n    }, [])\n\n    const selectedRef = useProxy(editorStateProxy).selectedRef\n\n    const spacePressed = useCallbackRef(() => {\n        if (selectedRef) {\n            if (selectedRef) {\n                cameraRef.current.position.set(selectedRef.current.position.x + offsets.x, selectedRef.current.position.y + offsets.y, selectedRef.current.position.z + offsets.z)\n                orbitRef.current.target = new Vector3().copy(selectedRef.current.position)\n            }\n        }\n    }, [selectedRef])\n\n    useHotkeys('*', () => {\n        if (isSpacePressed()) {\n            spacePressed.current()\n        }\n    })\n\n    useEffect(() => {\n        cameraRef.current.position.set(offsets.x, offsets.y, offsets.z)\n    }, [])\n\n    return (\n        <>\n            <PerspectiveCamera ref={cameraRef}/>\n            <OrbitControls ref={orbitRef} />\n        </>\n    )\n}\n\nexport default EditCamera","import {Plane, Sphere} from \"@react-three/drei\"\nimport React, {useEffect, useMemo, useRef, useState} from \"react\"\nimport {DoubleSide, Object3D} from \"three\";\nimport {useFrame, useThree} from \"react-three-fiber\";\nimport {isShiftPressed} from \"./hotkeys\";\nimport {addStoredComponent} from \"./state/ui\";\n\nexport const AddingComponentPlane: React.FC = () => {\n    const planeRef = useRef<Object3D>(null!)\n    const floorRef = useRef<Object3D>(null!)\n    const {camera} = useThree()\n    const [horizontalMode, setHorizontalMode] = useState(true)\n    const localStateRef = useRef({\n        x: 0,\n        z: 0,\n        y: 0,\n        disabled: false,\n        pointerDown: false,\n    })\n    const localState = localStateRef.current\n\n    useEffect(() => {\n        const onMouseDown = () => {\n            localState.pointerDown = true\n        }\n        const onMouseUp = () => {\n            localState.pointerDown = false\n            localState.disabled = false\n        }\n        const onMouseMove = () => {\n            if (localState.pointerDown) {\n                localState.disabled = true\n            }\n        }\n        const onPointerDown = () => {\n            onMouseDown()\n        }\n        const onPointerUp = () => {\n            onMouseUp()\n        }\n        window.addEventListener('pointermove', onMouseMove)\n        window.addEventListener('mousemove', onMouseMove)\n        window.addEventListener('mousedown', onMouseDown)\n        window.addEventListener('mouseup', onMouseUp)\n        window.addEventListener('pointerdown', onPointerDown)\n        window.addEventListener('pointerup', onPointerUp)\n        return () => {\n            window.removeEventListener('pointermove', onMouseMove)\n            window.removeEventListener('mousemove', onMouseMove)\n            window.removeEventListener('mousedown', onMouseDown)\n            window.removeEventListener('mouseup', onMouseUp)\n            window.removeEventListener('pointerdown', onPointerDown)\n            window.removeEventListener('pointerup', onPointerUp)\n        }\n    }, [])\n\n    const {onFloorPointerMove, onVerticalPointerUp, onVerticalMove, onFloorPointerUp} = useMemo(() => (\n        {\n            onVerticalPointerUp: (event: any) => {\n                if (horizontalMode) return\n                if (localState.disabled) return\n                event.stopPropagation()\n                const {y} = event.point\n                const {x, z} = localState\n                addStoredComponent({\n                    x,\n                    y,\n                    z\n                })\n            },\n            onFloorPointerUp: (event: any) => {\n                if (!horizontalMode) return\n                if (localState.disabled) return\n                event.stopPropagation()\n                const {x, z} = event.point\n                const {y} = localState\n                addStoredComponent({\n                    x,\n                    y,\n                    z\n                })\n            },\n            onFloorPointerMove: (event: any) => {\n                if (!horizontalMode) return\n                if (localState.disabled) return\n                event.stopPropagation()\n                const {x, z} = event.point\n                localState.x = x\n                localState.z = z\n            },\n            onVerticalMove: (event: any) => {\n                if (horizontalMode) return\n                if (localState.disabled) return\n                event.stopPropagation()\n                const {y} = event.point\n                localState.y = y\n            },\n        }\n    ), [horizontalMode])\n\n    useEffect(() => {\n        planeRef.current.position.x = localState.x\n        planeRef.current.position.z = localState.z\n        planeRef.current.position.y = localState.y\n        floorRef.current.position.x = Math.round(localState.x)\n        floorRef.current.position.y = localState.y\n        floorRef.current.position.z = Math.round(localState.z)\n    }, [horizontalMode])\n\n    const groupRef = useRef<Object3D>(null!)\n\n    useFrame(() => {\n        planeRef.current.rotation.y = Math.atan2( ( camera.position.x - planeRef.current.position.x ), ( camera.position.z - planeRef.current.position.z ) );\n        groupRef.current.position.y = localState.y\n        groupRef.current.position.x = localState.x\n        groupRef.current.position.z = localState.z\n    })\n\n    useEffect(() => {\n        const callback = () => {\n            setHorizontalMode(!isShiftPressed())\n        }\n        document.addEventListener('keydown', callback)\n        document.addEventListener('keyup', callback)\n        return () => {\n            document.removeEventListener('keydown', callback)\n            document.removeEventListener('keyup', callback)\n        }\n    }, [])\n\n    return (\n        <>\n            <Plane args={[256, 256]} onPointerMove={onFloorPointerMove} onPointerUp={onFloorPointerUp} rotation={[-Math.PI / 2, 0, 0]} ref={floorRef}>\n                <meshBasicMaterial transparent opacity={0} side={DoubleSide} />\n                <gridHelper rotation={[-Math.PI /2, 0, 0]} visible={horizontalMode} position={[0, 0, 0]} args={[1000, 1000, 'rgb(28,113,255, 0.05)', 'rgb(28,113,255, 0.05)']} layers={[31]}/>\n            </Plane>\n            <Plane args={[256, 256]} onPointerMove={onVerticalMove} onPointerUp={onVerticalPointerUp} ref={planeRef}>\n                <meshBasicMaterial transparent opacity={0} side={DoubleSide} />\n                <gridHelper rotation={[-Math.PI /2, 0, 0]} visible={!horizontalMode} args={[1000, 1000, 'rgb(28,113,255, 0.05)', 'rgb(28,113,255, 0.05)']} layers={[31]}/>\n            </Plane>\n            <group ref={groupRef}>\n                <Sphere>\n                    <meshBasicMaterial color=\"green\" />\n                </Sphere>\n            </group>\n        </>\n    )\n}","import React, {useCallback, useEffect, useMemo, useRef} from \"react\"\nimport {TemporaryComponents} from \"./TemporaryComponents\";\nimport EditFloor from \"./EditFloor\";\nimport EditCamera from \"./EditCamera\";\nimport {setComponentPropValue, setSelectedComponents} from \"../editor/state/main/actions\";\nimport {useSelectedComponents} from \"../editor/state/main/hooks\";\nimport {editorStateProxy, useIsEditMode} from \"../editor/state/editor\";\nimport {ref} from \"valtio\";\nimport {useMeshHelper} from \"./InteractiveMesh\";\nimport {useDraggableMesh} from \"./useDraggableMesh\";\nimport {Object3D, Box3, Vector3} from \"three\";\nimport {useCallbackRef} from \"../custom/hooks\";\nimport {predefinedPropKeys} from \"../editor/componentEditor/config\";\nimport {AddingComponentPlane} from \"../editor/AddingComponentPlane\";\nimport {useAddingComponent} from \"../editor/state/ui\";\n\nconst useComponentsAreSelected = () => {\n    const selectedComponents = useSelectedComponents()\n    return Object.keys(selectedComponents).length > 0\n}\n\nexport const useEditCanvasProps = () => {\n\n    const componentsSelected = useComponentsAreSelected()\n    const isEditMode = useIsEditMode()\n\n    return useMemo(() => {\n        return {\n            onPointerMissed: () => {\n                if (!isEditMode) return\n                if (componentsSelected) {\n                    setSelectedComponents({})\n                }\n            }\n        }\n    }, [componentsSelected])\n}\n\nconst center = new Vector3()\n\nconst getCenterPoint = (obj: Object3D) => {\n    const boundingBox = new Box3().setFromObject(obj);\n    console.log('boundingBox', boundingBox)\n    boundingBox.getCenter(center)\n    console.log('center', center)\n    return center\n}\n\nconst MultipleSelectedGroup: React.FC = () => {\n    const groupRef = useRef<Object3D>(null!)\n    const selectedComponents = useSelectedComponents()\n    const active = Object.keys(selectedComponents).length > 1\n    useEffect(() => {\n        editorStateProxy.groupPortalRef = ref(groupRef)\n        return () => {\n            editorStateProxy.groupPortalRef = null\n        }\n    }, [])\n    useMeshHelper(groupRef as any, active)\n    const dragMeshRef = useRef(new Object3D())\n    const originRef = useRef(new Vector3())\n\n    const positionDragRef = useCallback(() => {\n        const centerPosition = getCenterPoint(groupRef.current as any)\n        originRef.current = centerPosition\n        dragMeshRef.current.position.set(centerPosition.x, centerPosition.y, centerPosition.z)\n    }, [])\n\n    useEffect(() => {\n        if (!active) return\n        groupRef.current.position.set(0, 0, 0)\n        setTimeout(positionDragRef)\n    }, [active, selectedComponents])\n    const isDraggingRef = useRef(false)\n    const startingPositionRef = useRef(new Vector3())\n\n    const updateValue = useCallbackRef(() => {\n        const xDifference = groupRef.current.position.x - startingPositionRef.current.x\n        const yDifference = groupRef.current.position.y - startingPositionRef.current.y\n        const zDifference = groupRef.current.position.z - startingPositionRef.current.z\n        Object.keys(selectedComponents).forEach((componentId) => {\n            setComponentPropValue(componentId, predefinedPropKeys.position, (value: any) => {\n                if (!value) {\n                    // todo - get proper default?\n                    value = {\n                        x: 0,\n                        y: 0,\n                        z: 0,\n                    }\n                }\n                return {\n                    x: value.x + xDifference,\n                    y: value.y + yDifference,\n                    z: value.z + zDifference,\n                }\n            })\n        })\n        groupRef.current.position.set(0, 0, 0)\n        positionDragRef()\n    }, [selectedComponents])\n\n    useDraggableMesh('', active, {\n        updateValue: (updateType) => {\n            if (updateType === predefinedPropKeys.position) {\n                updateValue.current()\n            }\n            // todo - support scale and rotate\n        },\n        onChange: () => {\n            if (!isDraggingRef.current) return\n            groupRef.current.position.x = (originRef.current.x - dragMeshRef.current.position.x) * -1\n            groupRef.current.position.y = (originRef.current.y - dragMeshRef.current.position.y) * -1\n            groupRef.current.position.z = (originRef.current.z - dragMeshRef.current.position.z) * -1\n        },\n        onDraggingChanged: (event: any) => {\n            console.log('onDraggingChanged', event)\n            startingPositionRef.current.copy(groupRef.current.position)\n            isDraggingRef.current = event.value\n        },\n        passedRef: dragMeshRef,\n    })\n    return (\n        <>\n            <group ref={groupRef}/>\n            <group ref={dragMeshRef}/>\n        </>\n    )\n}\n\nconst EditTools: React.FC = () => {\n\n    const addingComponent = useAddingComponent()\n\n    return (\n        <>\n            <EditFloor/>\n            <EditCamera/>\n            <MultipleSelectedGroup/>\n            {\n                addingComponent && (\n                    <AddingComponentPlane/>\n                )\n            }\n        </>\n    )\n}\n\nexport const EditCanvas: React.FC = ({children}) => {\n    const isEditMode = useIsEditMode()\n    return (\n        <>\n            {children}\n            {\n                isEditMode && (\n                    <EditTools/>\n                )\n            }\n            <TemporaryComponents/>\n        </>\n    )\n}\n\nconsole.warn(`TODO!!! - 'apply' function is stale, when updating component prop value`)"],"names":["createStyled","tokens","colors","$darkGrey","$darkGreyLighter","$white","$lightPurple","$faint","$purple","$faintPurple","$midPurple","$darkPurple","$pink","sizes","$sidebar","$sidebarPlus","$headerHeight","space","$0b","$1","$1b","$2","$2b","$3","fonts","$main","fontSizes","$4","fontWeights","$regular","$semi","$medium","$bold","radii","zIndices","$high","$max","css","styled","global","margin","padding","boxSizing","maxWidth","StyledContainer","StyledInput","appearance","backgroundColor","border","color","width","fontSize","TextInput","inputId","value","passedOnChange","onChange","useState","inputValue","setInputValue","useEffect","useMemo","event","newValue","target","React","id","type","parseNumber","v","_v","evaluate","isNaN","parseFloat","parens","exp","mul","div","add","sub","expr","Number","test","newExpr","replace","_match","subExpr","String","base","pow","Math","a","b","Error","NumberInput","inputComponents","text","input","number","UnknownInput","props","InputComponent","display","gridTemplateColumns","columnGap","StyledItem","alignItems","StyledLabel","MultiNumberInput","Object","entries","map","index","entryKey","entryValue","key","htmlFor","initialStoreState","componentNames","components","sharedComponents","selectedComponents","componentsTree","unsavedComponents","deactivatedComponents","groups","groupedComponents","useMainStateStore","create","persist","name","onRehydrateStorage","state","revertState","version","blacklist","setMainStateStoreState","setState","getMainStateStoreState","getState","incrementor","generateUid","Date","now","toString","getCombinedId","ids","join","EditorTransformMode","editorStateProxy","proxy","editMode","transformMode","translate","groupPortalRef","orbitRef","selectedRef","cameraCanvasRef","mainCamera","transformActive","addComponentKey","movingComponents","addComponentPosition","x","y","z","useIsEditMode","useProxy","setEditMode","useGroupPortalRef","useTransformMode","setTransformMode","mode","PendingPasteType","clipboardProxy","pendingPaste","addToClipboard","ref","clearClipboard","getSelectedComponents","useHistoryStore","pastSnapshots","futureSnapshots","storeSnapshot","concat","length","shift","undoState","newSnapshot","currentSnapshot","slice","redoState","resetComponentProp","componentId","propKey","component","overriddenState","setSharedComponentPropValue","componentTypeId","propValue","appliedState","setComponentPropValue","updatedValue","modifiedState","originalProp","undefined","updateSelectedComponents","updateFn","setSelectedComponents","selected","setComponentsTree","tree","values","items","forEach","children","isExpanded","setComponentTreeItemExpanded","addUnsavedComponent","addable","parent","initialProps","uid","isRoot","predefinedPropKeys","getGroupChildren","groupId","groupChildren","componentIdGroup","push","deleteGroup","childId","deleteComponent","updatedGroups","deleteUnsavedComponent","addDeactivatedComponent","deleteSelectedComponents","keys","updated","removeDeactivatedComponents","groupComponents","sameParent","currentParent","parentId","update","updateComponentLocation","newDestination","ROOT_ID","setComponentName","setGroupName","copySelectedComponents","COMPONENTS","data","getComponentPropValue","cloneComponentWithinState","componentIdWithParentId","console","log","rawId","newId","unsavedComponent","childrenProp","newChildren","cloneComponents","newIds","updatedState","handlePasteComponents","addedComponents","handlePaste","useSelectedComponents","useSoleSelectedComponent","useComponentState","useSharedComponent","useUnsavedComponents","useUnsavedComponent","useIsDeactivated","useComponentName","useComponentsStore","componentsThatCanHaveChildren","setComponentInitialProps","setComponentCanHaveChildren","setComponentChildren","addComponent","unsaved","rootParentId","removeComponent","removeDeactivatedComponent","useComponent","useComponentInitialProps","useComponentCanHaveChildren","KEYS","Delete","Space","useHotkeysListener","hotkeys","isCommandPressed","command","cmd","control","isShiftPressed","isSpacePressed","isPressed","PropOrigin","usePropsStore","setComponentProps","useComponentProps","getBodyType","bodyType","RigidBodyType","STATIC","BodyStatus","Static","KINEMATIC","Kinematic","Dynamic","generateRigidBodyCollider","collider","colliderType","RigidBodyColliderShape","BALL","radius","args","hx","hy","hz","generateRigidBodyColliders","colliders","defs","generateRigidBodySpec","config","position","rotation","mass","quaternion","getQuaternionFromEuler","customBody","customBodyDef","body","w","euler","Euler","Quaternion","setFromEuler","RigidBody3DModule","meshRef","useEditableId","useEditableContext","setSharedProp","useEditableProp","rX","rY","rZ","useRapier3DBody","current","api","useBodyApi","ColliderVisualiser","Sphere","layers","wireframe","CUBIOD","Box","RigidBody3DModuleVisualizer","visible","scale","RigidBody3DModuleWrapper","useEditableSharedProp","isEditMode","enabled","EditableModules","modulesProp","rigidBody3d","TransformControls","camera","domElement","warn","document","Object3D","call","_gizmo","TransformControlsGizmo","_plane","TransformControlsPlane","scope","defineProperty","changeEvent","mouseDownEvent","mouseUpEvent","objectChangeEvent","raycaster","Raycaster","intersectObjectWithRay","object","includeInvisible","allIntersections","intersectObject","i","_tempVector","Vector3","_tempVector2","_tempQuaternion","_unit","X","Y","Z","pointStart","pointEnd","offset","rotationAxis","startNorm","endNorm","rotationAngle","cameraPosition","cameraQuaternion","cameraScale","parentPosition","parentQuaternion","parentQuaternionInv","parentScale","worldPositionStart","worldQuaternionStart","worldScaleStart","worldPosition","worldQuaternion","worldQuaternionInv","worldScale","eye","positionStart","quaternionStart","scaleStart","addEventListener","onPointerDown","onPointerHover","ownerDocument","onPointerUp","dispose","removeEventListener","onPointerMove","traverse","child","geometry","material","attach","detach","axis","propName","defaultValue","get","set","dispatchEvent","updateMatrixWorld","error","matrixWorld","decompose","copy","invert","normalize","prototype","pointerHover","pointer","dragging","setFromCamera","intersect","picker","pointerDown","button","planeIntersect","snap","rotationSnap","round","point","pointerMove","applyQuaternion","indexOf","divide","translationSnap","search","setFromMatrixPosition","d","dot","multiply","scaleSnap","ROTATION_SPEED","distanceTo","angleTo","cross","setFromAxisAngle","pointerUp","getPointer","pointerLockElement","changedTouches","rect","getBoundingClientRect","clientX","left","clientY","top","height","pointerType","style","touchAction","getMode","setMode","setTranslationSnap","setRotationSnap","setScaleSnap","setSize","size","setSpace","assign","constructor","isTransformControls","gizmoMaterial","MeshBasicMaterial","depthTest","depthWrite","transparent","side","DoubleSide","fog","toneMapped","gizmoLineMaterial","LineBasicMaterial","linewidth","matInvisible","clone","opacity","matHelper","matRed","matGreen","matBlue","matWhiteTransparent","matYellowTransparent","matCyanTransparent","matMagentaTransparent","matYellow","matLineRed","matLineGreen","matLineBlue","matLineCyan","matLineMagenta","matLineYellow","matLineGray","matLineYellowTransparent","arrowGeometry","CylinderGeometry","scaleHandleGeometry","BoxGeometry","lineGeometry","BufferGeometry","setAttribute","Float32BufferAttribute","CircleGeometry","arc","vertices","cos","PI","sin","TranslateHelperGeometry","gizmoTranslate","Mesh","Line","XYZ","OctahedronGeometry","XY","PlaneGeometry","YZ","XZ","pickerTranslate","helperTranslate","START","END","DELTA","gizmoRotate","E","XYZE","helperRotate","AXIS","pickerRotate","TorusGeometry","SphereGeometry","gizmoScale","XYZX","XYZY","XYZZ","pickerScale","helperScale","setupGizmo","gizmoMap","gizmo","tag","updateMatrix","tempGeometry","applyMatrix4","matrix","renderOrder","Infinity","tempVector","tempEuler","alignVector","zeroVector","lookAtMatrix","Matrix4","tempQuaternion","tempQuaternion2","identityQuaternion","unitX","unitY","unitZ","helper","handles","handle","factor","isOrthographicCamera","bottom","zoom","min","tan","fov","multiplyScalar","abs","setFromRotationMatrix","lookAt","AXIS_HIDE_TRESHOLD","PLANE_HIDE_TRESHOLD","AXIS_FLIP_TRESHOLD","atan2","multiplyQuaternions","showX","showY","showZ","_opacity","_color","lerp","Color","split","some","isTransformControlsGizmo","dirVector","tempMatrix","isTransformControlsPlane","useHotkeys","callback","options","unbind","useCallbackRef","cb","dependencies","useCallback","callbackRef","useRef","CustomTransformControls","recursiveSetLayer","EDITOR_LAYER","useIsCanvasInteractable","useDraggableMesh","isSelected","useThree","gl","scene","localRef","passedRef","controls","setControls","isCanvasEnabled","shiftIsPressed","setShiftIsPressed","updateValue","passedOnDraggingChanged","onDraggingChanged","keyup","keydown","active","currentTranslationSnap","currentRotationSnap","startPositionRef","onMouseUp","rotate","onMouseUpRef","enable","remove","useMeshHelper","helperToUse","BoxHelper","helperRef","useHelper","InteractiveMesh","parentPath","useIsEditableSelected","isSoleSelected","useEditableIsSoleSelected","isMultipleSelected","groupRef","pointerOver","setPointerOver","setComponentHovered","skip","intersections","eventObject","eventObjectId","userData","includes","stopPropagation","onPointerOver","onPointerOut","storedRef","firstCallRef","content","getComponentId","Context","createContext","registerWithParent","sharedProps","useContext","single","useIsSelected","Editable","_config","displayName","useLayoutEffect","childEditables","setChildEditables","registerChildren","isDeactivated","_unsaved","updatedParentPath","setSharedProps","Provider","useProp","hidden","applied","appliedValue","defaultResult","appliedResult","modifiedValue","modified","initialValue","initial","editableId","sync","sharedProp","prop","UnsavedComponent","useAddable","Component","sharedType","TemporaryComponent","TemporaryComponentsList","TemporaryComponents","EditableChildren","storedChildren","EmptyObject","useAddableStore","addables","getAddable","registerAddable","preppedId","uiProxy","displayAddingComponent","displayAddingComponentParent","addingComponent","addingComponentParent","componentContextMenu","hoveredComponents","useAddingComponent","addableId","addStoredComponent","useIsComponentHovered","displayComponentContextMenu","setDisplayAddingComponentParent","setAddingComponent","setDisplayAddingComponent","adding","addingComponentClosed","shortcutsManager","Shortcuts","registerShortcut","shortcuts","manager","useShortcut","SelectedComponentListeners","shortcut","handler","useIsItemSelected","TreeItemType","SceneItemIcon","generateTree","showActive","rootChildren","groupsChildren","group","title","parentGroupId","item","treeItem","last","sortedChildren","sortBy","rootId","useSceneTree","activeComponents","setTree","ItemIcon","iconType","FaFolderOpen","groupClosed","FaFolder","FaCube","sidePadding","StyledChildrenContainer","paddingLeft","useItemData","SceneChild","SceneItem","icon","draggable","useChildren","SceneChildren","StyledDraggableContainer","StyledWrapper","StyledInputWrapper","right","StyledButton","font","StyledClickable","borderRadius","cursor","textAlign","transition","outline","boxShadow","variants","hovered","StyledRound","justifyContent","StyledIcon","clickable","borderColor","interactive","StyledTrash","StyledToggleIcon","marginLeft","StyledOptions","lastSelectedItem","setLastSelectedItem","selectItem","addChildrenToRange","range","childItem","getOrderedRange","root","selectRange","orderedRange","sorted","fromIndex","toIndex","reverse","lowest","highest","EditName","editName","setEditName","inputRef","focus","as","onSubmit","preventDefault","onClick","onBlur","passedName","iconProps","isGroup","passedOnClick","focused","setFocused","buttonRef","canHaveChildren","customName","editingName","setEditingName","isHovered","blur","updateName","updatedName","onNameClicked","onContextMenu","onAddChild","onDelete","onFocus","FaCaretUp","FaCaretDown","FaPlus","Draggable","onExpand","onCollapse","provided","cantDrag","dragHandleProps","onDragStart","onKeyDown","onMouseDown","onTouchStart","otherProps","onHandleClicked","innerRef","draggableProps","itemChildren","overflowY","SceneList","view","VIEWS","itemId","mutateTree","onDragEnd","source","destination","destinationItem","updatedTree","moveItemOnTree","Tree","renderItem","isDragEnabled","isNestingEnabled","offsetPerLevel","gridTemplateRows","StyledTextButton","textDecoration","StyledPlainButton","fontWeight","faint","shape","tiny","full","thinner","thinnerWide","StyledHeading","StyledBox","maxHeight","StyledPaddedBox","visual","borderBottom","borderTop","StyledHeader","ManagerSidebar","selectedView","setSelectedView","deactivated","SelectInput","option","label","StyledHeaderOptions","PropInputOptions","propType","applyValue","onReset","usePropContext","Module","propConfig","predefinedProps","ComponentModules","marginTop","StyledInputLabel","minWidth","StyledBody","StyledCollidersContainer","marginRight","StyledCollidersHeader","DYNAMIC","StyledColliderContainer","RigidBody3DColliderInput","updatedCollider","FaTimes","RigidBody3DInput","setIsExpanded","addCollider","newCollider","updateCollider","updatedColliders","deleteCollider","splice","checked","rigidBody3dModuleProp","positionProp","rotationProp","scaleProp","predefinedBottomProps","modules","StyledProp","marginBottom","minHeight","StyledHeaderLabel","StyledInputContainer","PropInput","defaultOrder","sortProps","propA","propB","propAIndex","propBIndex","CustomProps","sort","ComponentState","componentProps","remainingProps","customProps","bottomProps","addModule","SidebarHeader","StateSidebar","selectedComponent","zIndex","borderLeft","StyledAddableComponent","StyledIconWrapper","closeAddingComponent","AddableComponent","FaMousePointer","AddingComponentMenu","isAddingComponent","OutsideClickHandler","onOutsideClick","StyledOption","closeContextMenu","useSelectedComponentTypes","componentIds","allRoot","componentsSelected","inactiveComponents","hasComponents","hasInactiveComponents","hasGroups","ComponentsMenu","onGroup","onReactivate","multipleComponents","allActive","canGroup","ContextMenu","delay","GlobalHotkeysListener","localStateRef","lastUndo","lastRedo","lastPaste","lastSave","StyledHeaderSide","letterSpacing","StyledHeaderMiddle","Header","FaUndo","disabled","FaRedo","StyledDefaultContainer","fontFamily","StyledMain","StyledSidebar","StyledContent","StyledBoxButton","OverlayControls","BiMove","BiRotateLeft","BiExpand","Editor","GoogleFontLoader","weights","EditFloor","twoDimensional","offsets","EditCamera","cameraRef","setDefaultCamera","spacePressed","PerspectiveCamera","OrbitControls","AddingComponentPlane","planeRef","floorRef","horizontalMode","setHorizontalMode","localState","onMouseMove","window","onVerticalPointerUp","onFloorPointerUp","onFloorPointerMove","onVerticalMove","useFrame","Plane","useComponentsAreSelected","useEditCanvasProps","onPointerMissed","center","getCenterPoint","obj","boundingBox","Box3","setFromObject","getCenter","MultipleSelectedGroup","dragMeshRef","originRef","positionDragRef","centerPosition","setTimeout","isDraggingRef","startingPositionRef","xDifference","yDifference","zDifference","updateType","EditTools","EditCanvas"],"mappings":"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"}